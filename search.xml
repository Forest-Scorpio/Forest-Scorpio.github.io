<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>æ–‡æœ¬åˆ†ç±»çš„æ·±åº¦å­¦ä¹ æ–¹æ³•ã€äºŒã€‘</title>
      <link href="/2021/08/31/text_classification2/"/>
      <url>/2021/08/31/text_classification2/</url>
      
        <content type="html"><![CDATA[<h1 id="DPCNN-ğŸ˜Š"><a href="#DPCNN-ğŸ˜Š" class="headerlink" title="DPCNN ğŸ˜Š"></a>DPCNN ğŸ˜Š</h1><blockquote><p>è®ºæ–‡ï¼š<a href="https://ai.tencent.com/ailab/media/publications/ACL3-Brady.pdf">https://ai.tencent.com/ailab/media/publications/ACL3-Brady.pdf</a><br>ä»£ç ï¼š<a href="https://github.com/649453932/Chinese-Text-Classification-Pytorch">https://github.com/649453932/Chinese-Text-Classification-Pytorch</a></p></blockquote><p><code>ACL</code> 2017 å¹´ï¼Œè…¾è®¯ <code>AI-lab</code> æå‡ºäº† <code>Deep Pyramid Convolutional Neural Networks for Text Categorization(DPCNN)</code>ï¼Œç”±äº <code>TextCNN</code> ä¸èƒ½é€šè¿‡å·ç§¯è·å¾—æ–‡æœ¬çš„é•¿è·ç¦»ä¾èµ–å…³ç³»ï¼Œè€Œè®ºæ–‡ä¸­ <code>DPCNN</code> é€šè¿‡ä¸æ–­åŠ æ·±ç½‘ç»œï¼Œå¯ä»¥æŠ½å–é•¿è·ç¦»çš„æ–‡æœ¬ä¾èµ–å…³ç³»ã€‚å®éªŒè¯æ˜åœ¨ä¸å¢åŠ å¤ªå¤šè®¡ç®—æˆæœ¬çš„æƒ…å†µä¸‹ï¼Œå¢åŠ ç½‘ç»œæ·±åº¦å°±å¯ä»¥è·å¾—æœ€ä½³çš„å‡†ç¡®ç‡ã€‚â€</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5cdd94fd35d64417a0cd2cd0b0b6116f~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><h2 id="Region-embedding"><a href="#Region-embedding" class="headerlink" title="Region embedding"></a>Region embedding</h2><p><code>TextCNN</code> çš„åŒ…å«å¤šå°ºå¯¸å·ç§¯æ»¤æ³¢å™¨çš„å·ç§¯å±‚çš„å·ç§¯ç»“æœç§°ä¹‹ä¸º <code>Region embedding</code>ï¼Œæ„æ€å°±æ˜¯å¯¹ä¸€ä¸ªæ–‡æœ¬åŒºåŸŸ/ç‰‡æ®µï¼ˆæ¯”å¦‚<code>3-gram</code>ï¼‰è¿›è¡Œä¸€ç»„å·ç§¯æ“ä½œåç”Ÿæˆçš„ <code>embedding</code>ã€‚</p><h2 id="å·ç§¯å’Œå…¨è¿æ¥çš„æƒè¡¡"><a href="#å·ç§¯å’Œå…¨è¿æ¥çš„æƒè¡¡" class="headerlink" title="å·ç§¯å’Œå…¨è¿æ¥çš„æƒè¡¡"></a>å·ç§¯å’Œå…¨è¿æ¥çš„æƒè¡¡</h2><p>äº§ç”Ÿ <code>region embedding</code> åï¼ŒæŒ‰ç…§ç»å…¸çš„ <code>TextCNN</code> çš„åšæ³•çš„è¯ï¼Œå°±æ˜¯ä»æ¯ä¸ªç‰¹å¾å›¾ä¸­æŒ‘é€‰å‡ºæœ€æœ‰ä»£è¡¨æ€§çš„ç‰¹å¾ï¼Œä¹Ÿå°±æ˜¯ç›´æ¥åº”ç”¨å…¨å±€æœ€å¤§æ± åŒ–å±‚ï¼Œè¿™æ ·å°±ç”Ÿæˆäº†è¿™æ®µæ–‡æœ¬çš„ç‰¹å¾å‘é‡ï¼Œå‡å¦‚å·ç§¯æ»¤æ³¢å™¨çš„ <code>size</code> æœ‰ <code>(3ï¼Œ4ï¼Œ5)</code> è¿™ä¸‰ç§ï¼Œæ¯ç§ <code>size</code> åŒ…å« $100$ ä¸ªå·ç§¯æ ¸ï¼Œé‚£ä¹ˆå½“ç„¶å°±ä¼šäº§ç”Ÿ $3*100$ å¹…ç‰¹å¾å›¾ï¼Œç„¶åå°†<code>max-over-time-pooling</code> æ“ä½œåº”ç”¨åˆ°æ¯ä¸ªç‰¹å¾å›¾ä¸Šï¼Œäºæ˜¯æ–‡æœ¬çš„ç‰¹å¾å‘é‡å³ $3 \times 100=300$ ç»´ã€‚</p><p><code>TextCNN</code> è¿™æ ·åšçš„æ„ä¹‰æœ¬è´¨ä¸Šä¸è¯è¢‹æ¨¡å‹çš„ç»å…¸æ–‡æœ¬åˆ†ç±»æ¨¡å‹æ²¡æœ¬è´¨åŒºåˆ«ï¼Œåªä¸è¿‡ <code>one-hot</code> åˆ° <code>word embedding</code> è¡¨ç¤ºçš„è½¬å˜é¿å…äº†è¯è¢‹æ¨¡å‹é­é‡çš„æ•°æ®ç¨€ç–é—®é¢˜ã€‚<code>TextCNN</code> æœ¬è´¨ä¸Šæ”¶ç›Šäºè¯å‘é‡çš„å¼•å…¥å¸¦æ¥çš„è¿‘ä¹‰è¯æœ‰ç›¸è¿‘å‘é‡è¡¨ç¤ºçš„ <code>bonus</code>ï¼ŒåŒæ—¶ <code>TextCNN</code> å¯ä»¥è¾ƒå¥½çš„åˆ©ç”¨è¯å‘é‡ä¸­è¿‘ä¹‰å…³ç³»ã€‚</p><blockquote><p>ä½†æ˜¯æ–‡æœ¬ä¸­çš„è¿œè·ç¦»ä¿¡æ¯åœ¨ <code>TextCNN</code> ä¸­ä¾ç„¶éš¾ä»¥å­¦ä¹ ã€‚</p></blockquote><h2 id="ç­‰é•¿å·ç§¯"><a href="#ç­‰é•¿å·ç§¯" class="headerlink" title="ç­‰é•¿å·ç§¯"></a>ç­‰é•¿å·ç§¯</h2><p>å‡è®¾è¾“å…¥çš„åºåˆ—é•¿åº¦ä¸º $n$ï¼Œå·ç§¯æ ¸å¤§å°ä¸º $m$ï¼Œæ­¥é•¿ä¸º $s$ï¼Œè¾“å…¥åºåˆ—ä¸¤ç«¯å„å¡«è¡¥ $p$ ä¸ªé›¶ï¼Œé‚£ä¹ˆè¯¥å·ç§¯å±‚çš„è¾“å‡ºåºåˆ—ä¸º $\frac{(n-m+2p)}{s}+1$ã€‚</p><ul><li><p>çª„å·ç§¯ğŸŠ:æ­¥é•¿ $s=1$ ï¼Œä¸¤ç«¯ä¸è¡¥é›¶ï¼Œå³ $p=0$ï¼Œå·ç§¯åè¾“å‡ºé•¿åº¦ä¸º $n-m+1$ã€‚</p></li><li><p>å®½å·ç§¯ğŸŠ:æ­¥é•¿ $s=1$ï¼Œä¸¤ç«¯è¡¥é›¶ $p=m-1$ï¼Œå·ç§¯åè¾“å‡ºé•¿åº¦ $n+m-1$ã€‚</p></li><li><p>ç­‰é•¿å·ç§¯ğŸŠ: æ­¥é•¿ $s=1$ï¼Œä¸¤ç«¯è¡¥é›¶ $p=(m-1)/2$ï¼Œå·ç§¯åè¾“å‡ºé•¿åº¦ä¸º $n$ã€‚</p></li></ul><p>æˆ‘ä»¬å°†è¾“å…¥è¾“å‡ºåºåˆ—çš„ç¬¬ $n$ ä¸ª <code>embedding</code> ç§°ä¸ºç¬¬ $n$ ä¸ªè¯ä½ï¼Œé‚£ä¹ˆè¿™æ—¶ <code>size=n</code> çš„å·ç§¯æ ¸äº§ç”Ÿçš„ç­‰é•¿å·ç§¯çš„æ„ä¹‰å°±æ˜¯å°†è¾“å…¥åºåˆ—çš„æ¯ä¸ªè¯ä½åŠå…¶å·¦å³ $\frac{n-1}{2}$ ä¸ªè¯çš„ä¸Šä¸‹æ–‡ä¿¡æ¯å‹ç¼©ä¸ºè¯¥è¯ä½çš„ <code>embedding</code>ï¼Œäº§ç”Ÿäº†æ¯ä¸ªè¯ä½çš„è¢«ä¸Šä¸‹æ–‡ä¿¡æ¯ä¿®é¥°è¿‡çš„æ›´é«˜ <code>level</code>ã€æ›´åŠ å‡†ç¡®çš„è¯­ä¹‰ã€‚æƒ³è¦å…‹æœ <code>TextCNN</code> çš„ç¼ºç‚¹ï¼Œæ•è·é•¿è·ç¦»æ¨¡å¼ï¼Œæ˜¾ç„¶å°±è¦ç”¨åˆ°æ·±å±‚ <code>CNN</code>ã€‚</p><p>ç›´æ¥ç­‰é•¿å·ç§¯å †ç­‰é•¿å·ç§¯ä¼šè®©æ¯ä¸ªè¯ä½åŒ…å«è¿›å»è¶Šæ¥è¶Šå¤šï¼Œè¶Šæ¥è¶Šé•¿çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œè¿™ç§æ–¹å¼ä¼šè®©ç½‘ç»œå±‚æ•°å˜å¾—éå¸¸éå¸¸éå¸¸æ·±ï¼Œä½†æ˜¯è¿™ç§æ–¹å¼å¤ªç¬¨é‡ã€‚ä¸è¿‡ï¼Œæ—¢ç„¶ç­‰é•¿å·ç§¯å †ç­‰é•¿å·ç§¯ä¼šè®©æ¯ä¸ªè¯ä½çš„<code>embedding</code> æè¿°è¯­ä¹‰æè¿°çš„æ›´åŠ ä¸°å¯Œå‡†ç¡®ï¼Œå¯ä»¥é€‚å½“çš„å †ä¸¤å±‚æ¥æé«˜è¯ä½ <code>embedding</code>çš„è¡¨ç¤ºçš„ä¸°å¯Œæ€§ã€‚</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/304e0f83debe45fab2883e8a29f92712~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><h2 id="å›ºå®š-feature-map-çš„æ•°é‡"><a href="#å›ºå®š-feature-map-çš„æ•°é‡" class="headerlink" title="å›ºå®š feature map çš„æ•°é‡"></a>å›ºå®š feature map çš„æ•°é‡</h2><p>åœ¨è¡¨ç¤ºå¥½æ¯ä¸ªè¯ä½çš„è¯­ä¹‰åï¼Œå¾ˆå¤šé‚»æ¥è¯æˆ–è€…é‚»æ¥ <code>ngram</code> çš„è¯ä¹‰æ˜¯å¯ä»¥åˆå¹¶ï¼Œä¾‹å¦‚ â€œå°æ˜ äºº ä¸è¦ å¤ªå¥½â€ ä¸­çš„ â€œä¸è¦â€ å’Œ â€œå¤ªå¥½â€ è™½ç„¶è¯­ä¹‰æœ¬æ¥ç¦»å¾—å¾ˆè¿œï¼Œä½†æ˜¯ä½œä¸ºé‚»æ¥è¯â€œä¸è¦å¤ªå¥½â€å‡ºç°æ—¶å…¶è¯­ä¹‰åŸºæœ¬ç­‰ä»·ä¸ºâ€œå¾ˆå¥½â€ï¼Œå®Œå…¨å¯ä»¥æŠŠâ€œä¸è¦â€å’Œâ€œå¤ªå¥½â€çš„è¯­ä¹‰è¿›è¡Œåˆå¹¶ã€‚åŒæ—¶ï¼Œåˆå¹¶çš„è¿‡ç¨‹å®Œå…¨å¯ä»¥åœ¨åŸå§‹çš„ <code>embedding space</code> ä¸­è¿›è¡Œçš„ï¼ŒåŸæ–‡ä¸­ç›´æ¥æŠŠâ€œä¸è¦å¤ªå¥½â€åˆå¹¶ä¸ºâ€œå¾ˆå¥½â€æ˜¯å¾ˆå¯ä»¥çš„ï¼Œå®Œå…¨æ²¡æœ‰å¿…è¦åŠ¨æ•´ä¸ªè¯­ä¹‰ç©ºé—´ã€‚</p><p>å®é™…ä¸Šï¼Œç›¸æ¯”å›¾åƒä¸­è¿™ç§ä»â€œç‚¹ã€çº¿ã€å¼§â€è¿™ç§ <code>low-level</code> ç‰¹å¾åˆ°â€œçœ¼ç›ã€é¼»å­ã€å˜´â€è¿™ç§ <code>high-level</code> ç‰¹å¾çš„æ˜æ˜¾å±‚æ¬¡æ€§çš„ç‰¹å¾åŒºåˆ†ï¼Œæ–‡æœ¬ä¸­çš„ç‰¹å¾è¿›é˜¶æ˜æ˜¾è¦æ‰å¹³çš„å¤šï¼Œå³ä»å•è¯ï¼ˆ<code>1gram</code>ï¼‰åˆ°çŸ­è¯­å†åˆ° <code>3gram</code>ã€<code>4gram</code> çš„å‡çº§ï¼Œå…¶å®å¾ˆå¤§ç¨‹åº¦ä¸Šå‡æ»¡è¶³â€œè¯­ä¹‰å–ä»£â€çš„ç‰¹æ€§ã€‚è€Œå›¾åƒä¸­å°±å¾ˆéš¾å‘ç”Ÿè¿™ç§â€œè¯­ä¹‰å–ä»£â€ç°è±¡ã€‚å› æ­¤ï¼Œ<code>DPCNN</code> ä¸ <code>ResNet</code> å¾ˆå¤§ä¸€ä¸ªä¸åŒå°±æ˜¯ï¼Œ<strong>åœ¨ <code>DPCNN</code> ä¸­å›ºå®šæ­»äº† <code>feature map</code> çš„æ•°é‡</strong>ï¼Œä¹Ÿå°±æ˜¯å›ºå®šä½äº† <code>embedding space</code> çš„ç»´åº¦ï¼ˆä¸ºäº†æ–¹ä¾¿ç†è§£ï¼Œä»¥ä¸‹ç®€ç§°è¯­ä¹‰ç©ºé—´ï¼‰ï¼Œä½¿å¾—ç½‘ç»œæœ‰å¯èƒ½è®©æ•´ä¸ªé‚»æ¥è¯ï¼ˆé‚»æ¥ <code>ngram</code>ï¼‰çš„åˆå¹¶æ“ä½œåœ¨åŸå§‹ç©ºé—´æˆ–è€…ä¸åŸå§‹ç©ºé—´ç›¸ä¼¼çš„ç©ºé—´ä¸­è¿›è¡Œï¼ˆå½“ç„¶ï¼Œç½‘ç»œåœ¨å®é™…ä¸­ä¼šä¸ä¼šè¿™æ ·åšæ˜¯ä¸ä¸€å®šçš„ï¼Œåªæ˜¯æä¾›äº†è¿™ä¹ˆä¸€ç§æ¡ä»¶ï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ•´ä¸ªç½‘ç»œè™½ç„¶å½¢çŠ¶ä¸Šæ¥çœ‹æ˜¯æ·±å±‚çš„ï¼Œä½†æ˜¯ä»è¯­ä¹‰ç©ºé—´ä¸Šæ¥çœ‹å®Œå…¨å¯ä»¥æ˜¯æ‰å¹³çš„ã€‚</p><h2 id="æ± åŒ–"><a href="#æ± åŒ–" class="headerlink" title="æ± åŒ–"></a>æ± åŒ–</h2><p>æ¯ç»è¿‡ä¸€ä¸ª $size=3,stride=2$ çš„æ± åŒ–å±‚(ç®€ç§° $1/2$ æ± åŒ–å±‚)ï¼Œåºåˆ—çš„é•¿åº¦å°±è¢«å‹ç¼©æˆäº†åŸæ¥çš„ä¸€åŠã€‚è¿™æ ·åŒæ ·æ˜¯ $size=3$ çš„å·ç§¯æ ¸ï¼Œæ¯ç»è¿‡ä¸€ä¸ª $1/2$ æ± åŒ–å±‚åï¼Œå…¶èƒ½æ„ŸçŸ¥åˆ°çš„æ–‡æœ¬ç‰‡æ®µå°±æ¯”ä¹‹å‰é•¿äº†ä¸€å€ã€‚ä¾‹å¦‚ä¹‹å‰æ˜¯åªèƒ½æ„ŸçŸ¥ $3$ ä¸ªè¯ä½é•¿åº¦çš„ä¿¡æ¯ï¼Œç»è¿‡ $1/2$ æ± åŒ–å±‚åå°±èƒ½æ„ŸçŸ¥ $6$ ä¸ªè¯ä½é•¿åº¦çš„ä¿¡æ¯ï¼Œè¿™æ—¶æŠŠ $1/2$ æ± åŒ–å±‚å’Œ <code>size=3</code> çš„å·ç§¯å±‚ç»„åˆèµ·æ¥å¦‚å›¾ï¼š</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1b697f3e79d34f8382862416a0495de2~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><h2 id="æ®‹å·®è¿æ¥"><a href="#æ®‹å·®è¿æ¥" class="headerlink" title="æ®‹å·®è¿æ¥"></a>æ®‹å·®è¿æ¥</h2><p>åœ¨åˆå§‹åŒ–æ·±åº¦ <code>CNN</code> æ—¶ï¼Œå¾€å¾€å„å±‚æƒé‡éƒ½æ˜¯åˆå§‹åŒ–ä¸ºä¸€ä¸ªå¾ˆå°çš„å€¼ï¼Œè¿™å°±å¯¼è‡´æœ€å¼€å§‹çš„ç½‘ç»œä¸­ï¼Œåç»­å‡ ä¹æ¯å±‚çš„è¾“å…¥éƒ½æ˜¯æ¥è¿‘ $0$ï¼Œè¿™æ—¶ç½‘ç»œçš„è¾“å‡ºè‡ªç„¶æ˜¯æ²¡æ„ä¹‰çš„ï¼Œè€Œè¿™äº›å°æƒé‡åŒæ—¶ä¹Ÿé˜»ç¢äº†æ¢¯åº¦çš„ä¼ æ’­ï¼Œä½¿å¾—ç½‘ç»œçš„åˆå§‹è®­ç»ƒé˜¶æ®µå¾€å¾€è¦è¿­ä»£å¾ˆä¹…æ‰èƒ½å¯åŠ¨ã€‚åŒæ—¶ï¼Œå°±ç®—ç½‘ç»œå¯åŠ¨å®Œæˆï¼Œç”±äºæ·±åº¦ç½‘ç»œä¸­ä»¿å°„çŸ©é˜µè¿‘ä¼¼è¿ä¹˜ï¼Œè®­ç»ƒè¿‡ç¨‹ä¸­ç½‘ç»œä¹Ÿéå¸¸å®¹æ˜“å‘ç”Ÿæ¢¯åº¦çˆ†ç‚¸æˆ–å¼¥æ•£é—®é¢˜ï¼ˆè™½ç„¶ç”±äºéå…±äº«æƒé‡ï¼Œæ·±åº¦<code>CNN</code> ç½‘ç»œæ¯” <code>RNN</code> ç½‘ç»œè¦å¥½ç‚¹ï¼‰ã€‚é’ˆå¯¹æ·±åº¦ <code>CNN</code> ç½‘ç»œçš„æ¢¯åº¦å¼¥æ•£é—®é¢˜ <code>ResNet</code> ä¸­æå‡ºçš„<code>shortcut-connection\skip-connection\residual-connection</code>ï¼ˆæ®‹å·®è¿æ¥ï¼‰å°±æ˜¯ä¸€ç§éå¸¸ç®€å•ã€åˆç†ã€æœ‰æ•ˆçš„è§£å†³æ–¹æ¡ˆã€‚</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d6b32d4001dd4a9db3cf71cb2256ae2a~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><h2 id="æ¨¡å‹ç»“æ„å’Œä»£ç "><a href="#æ¨¡å‹ç»“æ„å’Œä»£ç " class="headerlink" title="æ¨¡å‹ç»“æ„å’Œä»£ç "></a>æ¨¡å‹ç»“æ„å’Œä»£ç </h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DPCNN</span>(<span class="params">nn.Module</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, config</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        config.vocab_sizeï¼šè¯è¡¨å¤§å°</span></span><br><span class="line"><span class="string">        config.embedding_sizeï¼šè¯å‘é‡ç»´åº¦</span></span><br><span class="line"><span class="string">        config.num_labels: ç±»åˆ«æ•°</span></span><br><span class="line"><span class="string">        config.n_filters: å·ç§¯æ ¸ä¸ªæ•°ï¼ˆå¯¹åº”2ç»´å·ç§¯çš„é€šé“æ•°ï¼‰</span></span><br><span class="line"><span class="string">        config.filter_sizes: å·ç§¯æ ¸çš„å°ºå¯¸(3,4,5)</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="built_in">super</span>(DPCNN, self).__init__()</span><br><span class="line">        self.embedding_size = config.embedding_size</span><br><span class="line">        self.embedding = nn.Embedding(config.vocab_size, config.embedding_size)</span><br><span class="line"></span><br><span class="line">        self.conv_region = nn.Conv2d(<span class="number">1</span>, config.n_filters, (<span class="number">3</span>, self.embedding_size), stride=<span class="number">1</span>)</span><br><span class="line">        self.conv = nn.Conv2d(config.n_filters, config.n_filters, (<span class="number">3</span>, <span class="number">1</span>), stride=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        self.max_pool = nn.MaxPool2d(kernel_size=(<span class="number">3</span>, <span class="number">1</span>), stride=<span class="number">2</span>)</span><br><span class="line">        self.padding1 = nn.ZeroPad2d((<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>))  <span class="comment"># top bottom</span></span><br><span class="line">        self.padding2 = nn.ZeroPad2d((<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>))  <span class="comment"># bottom</span></span><br><span class="line"></span><br><span class="line">        self.relu = nn.ReLU()</span><br><span class="line">        self.fc = nn.Linear(config.n_filters, config.num_labels)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">forward</span>(<span class="params">self, input_ids</span>):</span></span><br><span class="line">        <span class="comment"># [batch size, seq len, emb dim]</span></span><br><span class="line">        x = self.embedding(input_ids) </span><br><span class="line">        <span class="comment"># [batch size, 1, seq len, emb dim]</span></span><br><span class="line">        x = x.unsqueeze(<span class="number">1</span>).to(torch.float32) </span><br><span class="line">        <span class="comment"># [batch size, n_filters, seq len-3+1, 1]</span></span><br><span class="line">        x = self.conv_region(x)  </span><br><span class="line">        <span class="comment"># [batch size, n_filters, seq len, 1]</span></span><br><span class="line">        x = self.padding1(x)  </span><br><span class="line">        x = self.relu(x)</span><br><span class="line">        <span class="comment"># [batch size, n_filters, seq len-3+1, 1]</span></span><br><span class="line">        x = self.conv(x) </span><br><span class="line">        <span class="comment"># [batch size, n_filters, seq len, 1]</span></span><br><span class="line">        x = self.padding1(x)  </span><br><span class="line">        x = self.relu(x)</span><br><span class="line">        <span class="comment"># [batch size, n_filters, seq len-3+1, 1]</span></span><br><span class="line">        x = self.conv(x)</span><br><span class="line">        <span class="comment"># [batch size, n_filters, 1, 1]</span></span><br><span class="line">        <span class="keyword">while</span> x.size()[<span class="number">2</span>] &gt;= <span class="number">2</span>:</span><br><span class="line">            x = self._block(x)  </span><br><span class="line">        <span class="comment"># [batch size, n_filters]</span></span><br><span class="line">        x_embedding = x.squeeze()  </span><br><span class="line">        <span class="comment"># [batch_size, 1]</span></span><br><span class="line">        x = self.fc(x_embedding)  </span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_block</span>(<span class="params">self, x</span>):</span></span><br><span class="line">        x = self.padding2(x)</span><br><span class="line">        px = self.max_pool(x)</span><br><span class="line"></span><br><span class="line">        x = self.padding1(px)</span><br><span class="line">        x = F.relu(x)</span><br><span class="line">        x = self.conv(x)</span><br><span class="line"></span><br><span class="line">        x = self.padding1(x)</span><br><span class="line">        x = F.relu(x)</span><br><span class="line">        x = self.conv(x)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Short Cut</span></span><br><span class="line">        x = x + px</span><br><span class="line">        <span class="keyword">return</span> x</span><br></pre></td></tr></table></figure><h1 id="TextRCNN-ğŸ˜Š"><a href="#TextRCNN-ğŸ˜Š" class="headerlink" title="TextRCNN ğŸ˜Š"></a>TextRCNN ğŸ˜Š</h1><blockquote><p>è®ºæ–‡ï¼š<a href="https://dl.acm.org/doi/10.5555/2886521.2886636">https://dl.acm.org/doi/10.5555/2886521.2886636</a><br>ä»£ç ï¼š<a href="https://github.com/649453932/Chinese-Text-Classification-Pytorch">https://github.com/649453932/Chinese-Text-Classification-Pytorch</a></p></blockquote><p><code>RNN</code> å’Œ <code>CNN</code> ä½œä¸ºæ–‡æœ¬åˆ†ç±»é—®é¢˜çš„ä¸»è¦æ¨¡å‹æ¶æ„ï¼Œéƒ½å­˜åœ¨å„è‡ªçš„ä¼˜ç‚¹åŠå±€é™æ€§ã€‚</p><ul><li><p><code>RNN</code> æ“…é•¿å¤„ç†åºåˆ—ç»“æ„ï¼Œèƒ½å¤Ÿè€ƒè™‘åˆ°å¥å­çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œä½† <code>RNN</code> å±äº <code>biased model</code>ï¼Œä¸€ä¸ªå¥å­ä¸­è¶Šå¾€åçš„è¯é‡è¦æ€§è¶Šé«˜ï¼Œè¿™æœ‰å¯èƒ½å½±å“æœ€åçš„åˆ†ç±»ç»“æœï¼Œå› ä¸ºå¯¹å¥å­åˆ†ç±»å½±å“æœ€å¤§çš„è¯å¯èƒ½å¤„åœ¨å¥å­ä»»ä½•ä½ç½®ã€‚</p></li><li><p><code>CNN</code> å±äºæ— åæ¨¡å‹ï¼Œèƒ½å¤Ÿé€šè¿‡æœ€å¤§æ± åŒ–è·å¾—æœ€é‡è¦çš„ç‰¹å¾ï¼Œä½†æ˜¯ <code>CNN</code> çš„æ»‘åŠ¨çª—å£å¤§å°ä¸å®¹æ˜“ç¡®å®šï¼Œé€‰çš„è¿‡å°å®¹æ˜“é€ æˆé‡è¦ä¿¡æ¯ä¸¢å¤±ï¼Œé€‰çš„è¿‡å¤§ä¼šé€ æˆå·¨å¤§å‚æ•°ç©ºé—´ã€‚</p></li></ul><p>ä¸ºäº†è§£å†³äºŒè€…çš„å±€é™æ€§ï¼Œè¿™ç¯‡æ–‡ç« æå‡ºäº†ä¸€ç§æ–°çš„ç½‘ç»œæ¶æ„ï¼Œç”¨åŒå‘å¾ªç¯ç»“æ„è·å–ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œè¿™æ¯”ä¼ ç»Ÿçš„åŸºäºçª—å£çš„ç¥ç»ç½‘ç»œæ›´èƒ½å‡å°‘å™ªå£°ï¼Œè€Œä¸”åœ¨å­¦ä¹ æ–‡æœ¬è¡¨è¾¾æ—¶å¯ä»¥å¤§èŒƒå›´çš„ä¿ç•™è¯åºã€‚å…¶æ¬¡ä½¿ç”¨æœ€å¤§æ± åŒ–å±‚è·å–æ–‡æœ¬çš„é‡è¦éƒ¨åˆ†ï¼Œè‡ªåŠ¨åˆ¤æ–­å“ªä¸ªç‰¹å¾åœ¨æ–‡æœ¬åˆ†ç±»è¿‡ç¨‹ä¸­èµ·æ›´é‡è¦çš„ä½œç”¨ã€‚</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/396b3ac302114add92c8edecf7770060~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><h2 id="å•è¯è¡¨ç¤ºå­¦ä¹ "><a href="#å•è¯è¡¨ç¤ºå­¦ä¹ " class="headerlink" title="å•è¯è¡¨ç¤ºå­¦ä¹ "></a>å•è¯è¡¨ç¤ºå­¦ä¹ </h2><p>ä½œè€…æå‡ºå°†å•è¯çš„å·¦ä¸Šä¸‹æ–‡ã€å³ä¸Šä¸‹æ–‡ã€å•è¯æœ¬èº«ç»“åˆèµ·æ¥ä½œä¸ºå•è¯è¡¨ç¤ºã€‚ä½œè€…ä½¿ç”¨äº†åŒå‘ <code>RNN</code> æ¥åˆ†åˆ«æå–å¥å­çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚å…¬å¼å¦‚ä¸‹:</p><script type="math/tex; mode=display">\begin{array}{l}c_{l}\left(w_{i}\right)=f\left(W^{(l)} c_{l}\left(w_{i-1}\right)+W^{(s l)} e\left(w_{i-1}\right)\right)  \\c_{r}\left(w_{i}\right)=f\left(W^{(r)} c_{r}\left(w_{i+1}\right)+W^{(s r)} e\left(w_{i+1}\right)\right)\end{array}</script><p>å…¶ä¸­ï¼Œ$c_l(w_i)$ ä»£è¡¨å•è¯ $w_i$ çš„å·¦ä¸Šä¸‹æ–‡ï¼Œ$c_l(w_i)$ ç”±ä¸Šä¸€ä¸ªå•è¯çš„å·¦ä¸Šä¸‹æ–‡ $c_l(w_{i-1})$ å’Œ ä¸Šä¸€ä¸ªå•è¯çš„è¯åµŒå…¥å‘é‡ $e(w_{i-1})$ è®¡ç®—å¾—åˆ°ï¼Œæ‰€æœ‰å¥å­ç¬¬ä¸€ä¸ªå•è¯çš„å·¦ä¾§ä¸Šä¸‹æ–‡ä½¿ç”¨ç›¸åŒçš„å…±äº«å‚æ•° $c_l(w_1)$ã€‚</p><p>$W^{(l)},W^{(sl)}$ ç”¨äºå°†ä¸Šä¸€ä¸ªå•è¯çš„å·¦ä¸Šä¸‹æ–‡è¯­ä¹‰å’Œä¸Šä¸€ä¸ªå•è¯çš„è¯­ä¹‰ç»“åˆåˆ°å•è¯ $w_i$ çš„å·¦ä¸Šä¸‹æ–‡è¡¨ç¤ºä¸­ã€‚å³ä¸Šä¸‹æ–‡çš„å¤„ç†ä¸å·¦ä¸Šä¸‹æ–‡å®Œå…¨ç›¸åŒï¼ŒåŒæ ·æ‰€æœ‰å¥å­æœ€åä¸€ä¸ªå•è¯çš„å³ä¾§ä¸Šä¸‹æ–‡ä½¿ç”¨ç›¸åŒçš„å…±äº«å‚æ•° $c_r(w_n)$ã€‚ å¾—åˆ°å¥å­ä¸­æ¯ä¸ªå•è¯çš„å·¦ä¸Šä¸‹æ–‡è¡¨ç¤ºå’Œå³ä¸Šä¸‹æ–‡è¡¨ç¤ºåï¼Œå°±å¯ä»¥å®šä¹‰å•è¯  $w_i$ çš„è¡¨ç¤ºå¦‚ä¸‹</p><script type="math/tex; mode=display">\boldsymbol{x}_{i}=\left[\boldsymbol{c}_{l}\left(w_{i}\right) ; \boldsymbol{e}\left(w_{i}\right) ; \boldsymbol{c}_{r}\left(w_{i}\right)\right]</script><p>å®é™…å°±æ˜¯å•è¯$w_i$ï¼Œå•è¯çš„è¯åµŒå…¥è¡¨ç¤ºå‘é‡ $e(w_i)$ ä»¥åŠå•è¯çš„å³ä¸Šä¸‹æ–‡å‘é‡ $c_e(w_i)$ çš„æ‹¼æ¥åçš„ç»“æœã€‚å¾—åˆ° $w_i$ çš„è¡¨ç¤º$x_i$åï¼Œå°±å¯ä»¥è¾“å…¥æ¿€æ´»å‡½æ•°å¾—åˆ°$w_i$çš„æ½œåœ¨è¯­ä¹‰å‘é‡ $y_i^{(2)}$ ã€‚</p><script type="math/tex; mode=display">\boldsymbol{y}_{i}^{(2)}=\tanh \left(W^{(2)} \boldsymbol{x}_{i}+\boldsymbol{b}^{(2)}\right)</script><h2 id="æ–‡æœ¬è¡¨ç¤ºå­¦ä¹ "><a href="#æ–‡æœ¬è¡¨ç¤ºå­¦ä¹ " class="headerlink" title="æ–‡æœ¬è¡¨ç¤ºå­¦ä¹ "></a>æ–‡æœ¬è¡¨ç¤ºå­¦ä¹ </h2><p>ç»è¿‡å·ç§¯å±‚åï¼Œè·å¾—äº†æ‰€æœ‰è¯çš„è¡¨ç¤ºï¼Œé¦–å…ˆå¯¹å…¶è¿›è¡Œæœ€å¤§æ± åŒ–æ“ä½œï¼Œæœ€å¤§æ± åŒ–å¯ä»¥å¸®åŠ©æ‰¾åˆ°å¥å­ä¸­æœ€é‡è¦çš„æ½œåœ¨è¯­ä¹‰ä¿¡æ¯ã€‚</p><script type="math/tex; mode=display">\boldsymbol{y}^{(3)}=\max _{i=1}^{n} \boldsymbol{y}_{i}^{(2)}</script><p>ç„¶åç»è¿‡å…¨è¿æ¥å±‚å¾—åˆ°æ–‡æœ¬çš„è¡¨ç¤ºï¼Œæœ€åé€šè¿‡ <code>softmax</code> å±‚è¿›è¡Œåˆ†ç±»ã€‚</p><script type="math/tex; mode=display">\begin{aligned}&\boldsymbol{y}^{(4)}=W^{(4)} \boldsymbol{y}^{(3)}+\boldsymbol{b}^{(4)}\\&p_{i}=\frac{\exp \left(\boldsymbol{y}_{i}^{(4)}\right)}{\sum_{k=1}^{n} \exp \left(\boldsymbol{y}_{k}^{(4)}\right)}\end{aligned}</script><h2 id="æ¨¡å‹ç»“æ„å’Œä»£ç -1"><a href="#æ¨¡å‹ç»“æ„å’Œä»£ç -1" class="headerlink" title="æ¨¡å‹ç»“æ„å’Œä»£ç "></a>æ¨¡å‹ç»“æ„å’Œä»£ç </h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RCNN</span>(<span class="params">nn.Module</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, config</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        config.vocab_sizeï¼šè¯è¡¨å¤§å°</span></span><br><span class="line"><span class="string">        config.embedding_sizeï¼šè¯å‘é‡ç»´åº¦</span></span><br><span class="line"><span class="string">        config.num_labels: ç±»åˆ«æ•°</span></span><br><span class="line"><span class="string">        config.hidden_dim: rnnéšè—å±‚çš„ç»´åº¦</span></span><br><span class="line"><span class="string">        config.n_layers: rnnå±‚æ•°</span></span><br><span class="line"><span class="string">        config.rnn_type: rnnç±»å‹ï¼ŒåŒ…æ‹¬[&#x27;lstm&#x27;, &#x27;gru&#x27;, &#x27;rnn&#x27;]</span></span><br><span class="line"><span class="string">        config.bidirectional: æ˜¯å¦åŒå‘</span></span><br><span class="line"><span class="string">        config.dropout: dropoutç‡</span></span><br><span class="line"><span class="string">        config.batch_first: ç¬¬ä¸€ä¸ªç»´åº¦æ˜¯å¦æ˜¯æ‰¹é‡å¤§å°</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="built_in">super</span>(RCNN, self).__init__()</span><br><span class="line">        word_embedding = word_embedding</span><br><span class="line">        self.embedding_size = config.embedding_size</span><br><span class="line">        self.embedding = nn.Embedding(config.vocab_size, config.embedding_size)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> config.rnn_type == <span class="string">&#x27;lstm&#x27;</span>:</span><br><span class="line">            self.rnn = nn.LSTM(self.embedding_size,</span><br><span class="line">                               config.hidden_dim,</span><br><span class="line">                               num_layers=config.n_layers,</span><br><span class="line">                               bidirectional=config.bidirectional,</span><br><span class="line">                               batch_first=config.batch_first,</span><br><span class="line">                               dropout=config.dropout)</span><br><span class="line">        <span class="keyword">elif</span> config.rnn_type == <span class="string">&#x27;gru&#x27;</span>:</span><br><span class="line">            self.rnn = nn.GRU(self.embedding_size,</span><br><span class="line">                              hidden_size=config.hidden_dim,</span><br><span class="line">                              num_layers=config.n_layers,</span><br><span class="line">                              bidirectional=config.bidirectional,</span><br><span class="line">                              batch_first=config.batch_first,</span><br><span class="line">                              dropout=config.dropout)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.rnn = nn.RNN(self.embedding_size,</span><br><span class="line">                              hidden_size=config.hidden_dim,</span><br><span class="line">                              num_layers=config.n_layers,</span><br><span class="line">                              bidirectional=config.bidirectional,</span><br><span class="line">                              batch_first=config.batch_first,</span><br><span class="line">                              dropout=config.dropout)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 1 x 1 å·ç§¯ç­‰ä»·äºå…¨è¿æ¥å±‚ï¼Œæ•…æ­¤å¤„ä½¿ç”¨å…¨è¿æ¥å±‚ä»£æ›¿</span></span><br><span class="line">        self.fc_cat = nn.Linear(config.hidden_dim * <span class="number">2</span> + self.embedding_size, self.embedding_size)</span><br><span class="line">        self.fc = nn.Linear(self.embedding_size, config.num_labels)</span><br><span class="line"></span><br><span class="line">        self.dropout = nn.Dropout(config.dropout)</span><br><span class="line">        self.batch_first = config.batch_first</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">forward</span>(<span class="params">self, text, text_lengths</span>):</span></span><br><span class="line">        <span class="comment"># æŒ‰ç…§å¥å­é•¿åº¦ä»å¤§åˆ°å°æ’åº</span></span><br><span class="line">        text, sorted_seq_lengths, desorted_indices = self.prepare_pack_padded_sequence(text, text_lengths)</span><br><span class="line">        <span class="comment"># text = [batch size, sent len]</span></span><br><span class="line">        embedded = self.dropout(self.embedding(text)).<span class="built_in">float</span>()</span><br><span class="line">        <span class="comment"># embedded = [batch size, sent len, emb dim]</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># pack sequence</span></span><br><span class="line">        packed_embedded = nn.utils.rnn.pack_padded_sequence(embedded, sorted_seq_lengths, batch_first=self.batch_first)</span><br><span class="line">        self.rnn.flatten_parameters()</span><br><span class="line">        <span class="keyword">if</span> config.rnn_type <span class="keyword">in</span> [<span class="string">&#x27;rnn&#x27;</span>, <span class="string">&#x27;gru&#x27;</span>]:</span><br><span class="line">            packed_output, hidden = self.rnn(packed_embedded)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># output (batch, seq_len, num_directions * hidden_dim)</span></span><br><span class="line">            <span class="comment"># hidden (batch, num_layers * num_directions, hidden_dim)</span></span><br><span class="line">            packed_output, (hidden, cell) = self.rnn(packed_embedded)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># unpack sequence</span></span><br><span class="line">        output, output_lengths = nn.utils.rnn.pad_packed_sequence(packed_output, batch_first=self.batch_first)</span><br><span class="line">        <span class="comment"># æŠŠå¥å­åºåˆ—å†è°ƒæ•´æˆè¾“å…¥æ—¶çš„é¡ºåº</span></span><br><span class="line">        output = output[desorted_indices]</span><br><span class="line">        <span class="comment"># output = [batch_size, seq_len, hidden_dim * num_directionns ]</span></span><br><span class="line"></span><br><span class="line">        batch_size, max_seq_len, hidden_dim = output.shape</span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ‹¼æ¥å·¦å³ä¸Šä¸‹æ–‡ä¿¡æ¯</span></span><br><span class="line">        output = torch.tanh(self.fc_cat(torch.cat((output, embedded), dim=<span class="number">2</span>)))</span><br><span class="line">        <span class="comment"># output = [batch_size, seq_len, embedding_size]</span></span><br><span class="line"></span><br><span class="line">        output = torch.transpose(output, <span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">        output = F.max_pool1d(output, <span class="built_in">int</span>(max_seq_len)).squeeze().contiguous()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> self.fc(output)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">prepare_pack_padded_sequence</span>(<span class="params">self, inputs_words, seq_lengths, descending=<span class="literal">True</span></span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        for rnn model ï¼šæŒ‰ç…§å¥å­é•¿åº¦ä»å¤§åˆ°å°æ’åº</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        sorted_seq_lengths, indices = torch.sort(seq_lengths, descending=descending)</span><br><span class="line">        _, desorted_indices = torch.sort(indices, descending=<span class="literal">False</span>)</span><br><span class="line">        sorted_inputs_words = inputs_words[indices]</span><br><span class="line">        <span class="keyword">return</span> sorted_inputs_words, sorted_seq_lengths, desorted_indices</span><br></pre></td></tr></table></figure><h1 id="HAN-ğŸ˜Š"><a href="#HAN-ğŸ˜Š" class="headerlink" title="HAN ğŸ˜Š"></a>HAN ğŸ˜Š</h1><blockquote><p>è®ºæ–‡ï¼š<a href="https://www.aclweb.org/anthology/N16-1174.pdf">https://www.aclweb.org/anthology/N16-1174.pdf</a><br>ä»£ç ï¼š<a href="https://github.com/richliao/textClassifier">https://github.com/richliao/textClassifier</a></p></blockquote><p>ä¸Šæ–‡éƒ½æ˜¯å¥å­çº§åˆ«çš„åˆ†ç±»ï¼Œè™½ç„¶ç”¨åˆ°é•¿æ–‡æœ¬ã€ç¯‡ç« çº§ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä½†é€Ÿåº¦ç²¾åº¦éƒ½ä¼šä¸‹é™ï¼Œäºæ˜¯æœ‰ç ”ç©¶è€…æå‡ºäº†å±‚æ¬¡æ³¨æ„åŠ›åˆ†ç±»æ¡†æ¶ï¼Œå³<code>Hierarchical Attention</code>ã€‚</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/01f2bd3e66f440e59b9445002b141090~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><p>æ•´ä¸ªç½‘ç»œç»“æ„åŒ…æ‹¬äº”ä¸ªéƒ¨åˆ†ï¼š</p><ol><li><p>è¯åºåˆ—ç¼–ç å™¨</p></li><li><p>åŸºäºè¯çº§çš„æ³¨æ„åŠ›å±‚</p></li><li><p>å¥å­ç¼–ç å™¨</p></li><li><p>åŸºäºå¥å­çº§çš„æ³¨æ„åŠ›å±‚</p></li><li><p>åˆ†ç±»å±‚</p></li></ol><p>æ•´ä¸ªç½‘ç»œç»“æ„ç”±åŒå‘ <code>GRU</code> ç½‘ç»œå’Œæ³¨æ„åŠ›æœºåˆ¶ç»„åˆè€Œæˆã€‚</p><h2 id="è¯åºç¼–ç å™¨"><a href="#è¯åºç¼–ç å™¨" class="headerlink" title="è¯åºç¼–ç å™¨"></a>è¯åºç¼–ç å™¨</h2><p>ç»™å®šä¸€ä¸ªå¥å­ä¸­çš„å•è¯ $w_{it}$ï¼Œå…¶ä¸­ $i$ è¡¨ç¤ºç¬¬ $i$ ä¸ªå¥å­ï¼Œ$t$ è¡¨ç¤ºç¬¬ $t$ ä¸ªè¯ã€‚é€šè¿‡ä¸€ä¸ªè¯åµŒå…¥çŸ©é˜µ $W_e$ å°†å•è¯è½¬æ¢æˆå‘é‡è¡¨ç¤ºï¼Œå…·ä½“å¦‚ä¸‹æ‰€ç¤ºï¼š </p><script type="math/tex; mode=display">x_{it}=W_e w_{it}</script><p>å°†è·å–çš„è¯å‘é‡è¾“å…¥è¯ç¼–ç å™¨ï¼Œå³ä¸€ä¸ªåŒå‘ <code>GRU</code>ï¼Œå°†ä¸¤ä¸ªæ–¹å‘çš„ <code>GRU</code> è¾“å‡ºæ‹¼æ¥åœ¨ä¸€èµ·å¾—åˆ°è¯çº§åˆ«çš„éšå‘é‡ $h$ </p><h2 id="è¯çº§åˆ«çš„æ³¨æ„åŠ›"><a href="#è¯çº§åˆ«çš„æ³¨æ„åŠ›" class="headerlink" title="è¯çº§åˆ«çš„æ³¨æ„åŠ›"></a>è¯çº§åˆ«çš„æ³¨æ„åŠ›</h2><p>ä½†æ˜¯å¯¹äºä¸€å¥è¯ä¸­çš„å•è¯ï¼Œå¹¶ä¸æ˜¯æ¯ä¸€ä¸ªå•è¯å¯¹åˆ†ç±»ä»»åŠ¡éƒ½æ˜¯æœ‰ç”¨çš„ï¼Œæ¯”å¦‚åœ¨åšæ–‡æœ¬çš„æƒ…ç»ªåˆ†ç±»æ—¶ï¼Œå¯èƒ½æˆ‘ä»¬å°±ä¼šæ¯”è¾ƒå…³æ³¨ â€œå¾ˆå¥½â€ã€â€œä¼¤æ„Ÿâ€ è¿™äº›è¯ã€‚ä¸ºäº†èƒ½ä½¿å¾ªç¯ç¥ç»ç½‘ç»œä¹Ÿèƒ½è‡ªåŠ¨å°†â€œæ³¨æ„åŠ›â€æ”¾åœ¨è¿™äº›è¯æ±‡ä¸Šï¼Œä½œè€…è®¾è®¡äº†åŸºäºå•è¯çš„æ³¨æ„åŠ›å±‚çš„å…·ä½“æµç¨‹å¦‚ä¸‹ï¼š </p><script type="math/tex; mode=display">u_{i t} =\tanh \left(W_{w} h_{i t}+b_{w}\right)</script><script type="math/tex; mode=display">\alpha_{i t} =\frac{\exp \left(u_{i t}^{\top} u_{w}\right)}{\sum_{t} \exp \left(u_{i t}^{\top} u_{w}\right)}</script><script type="math/tex; mode=display">s_{i} =\sum_{t} \alpha_{i t} h_{i t}</script><p>ä¸Šé¢å¼å­ä¸­ï¼Œ$u_{it}$ æ˜¯ $h_{it}$ çš„éšå±‚è¡¨ç¤ºï¼Œ$a_{it}$ æ˜¯ç» <code>softmax</code> å‡½æ•°å¤„ç†åçš„å½’ä¸€åŒ–æƒé‡ç³»æ•°ï¼Œ$u_w$æ˜¯ä¸€ä¸ªéšæœºåˆå§‹åŒ–çš„å‘é‡ï¼Œä¹‹åä¼šä½œä¸ºæ¨¡å‹çš„å‚æ•°ä¸€èµ·è¢«è®­ç»ƒï¼Œ$s_i$ å°±æ˜¯æˆ‘ä»¬å¾—åˆ°çš„ç¬¬ $i$ ä¸ªå¥å­çš„å‘é‡è¡¨ç¤ºã€‚</p><h2 id="å¥å­ç¼–ç å™¨å’Œå¥å­çº§æ³¨æ„åŠ›"><a href="#å¥å­ç¼–ç å™¨å’Œå¥å­çº§æ³¨æ„åŠ›" class="headerlink" title="å¥å­ç¼–ç å™¨å’Œå¥å­çº§æ³¨æ„åŠ›"></a>å¥å­ç¼–ç å™¨å’Œå¥å­çº§æ³¨æ„åŠ›</h2><p>å¯¹äºå¥å­çº§åˆ«çš„å‘é‡ï¼Œæˆ‘ä»¬ç”¨ç›¸ç±»ä¼¼çš„æ–¹æ³•ï¼Œå°†å…¶é€šè¿‡åŒå‘ <code>GRU</code> å’Œæ³¨æ„åŠ›å±‚ï¼Œæœ€åå°†æ–‡æ¡£ä¸­æ‰€æœ‰å¥å­çš„éšå‘é‡è¡¨ç¤ºåŠ æƒæ±‚å’Œï¼Œå¾—åˆ°æ•´ä¸ªæ–‡æ¡£çš„æ–‡æ¡£å‘é‡ $v$ï¼Œå°†è¯¥å‘é‡é€šè¿‡ä¸€ä¸ªå…¨è¿æ¥åˆ†ç±»å™¨è¿›è¡Œåˆ†ç±»ã€‚</p><h2 id="æ¨¡å‹ç»“æ„å’Œä»£ç -2"><a href="#æ¨¡å‹ç»“æ„å’Œä»£ç -2" class="headerlink" title="æ¨¡å‹ç»“æ„å’Œä»£ç "></a>æ¨¡å‹ç»“æ„å’Œä»£ç </h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HierAttNet</span>(<span class="params">nn.Module</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, rnn_type, word_hidden_size, sent_hidden_size, num_classes,word_embedding, n_layers, bidirectional, batch_first, freeze, dropout</span>):</span></span><br><span class="line">        <span class="built_in">super</span>(HierAttNet, self).__init__()</span><br><span class="line">        self.word_embedding = word_embedding</span><br><span class="line">        self.word_hidden_size = word_hidden_size</span><br><span class="line">        self.sent_hidden_size = sent_hidden_size</span><br><span class="line">        self.word_att_net = WordAttNet(rnn_type,word_embedding, word_hidden_size,n_layers,  bidirectional,batch_first,dropout,freeze)</span><br><span class="line">        self.sent_att_net = SentAttNet(rnn_type,sent_hidden_size, word_hidden_size,n_layers,bidirectional,batch_first,dropout, num_classes)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">forward</span>(<span class="params">self, batch_doc, text_lengths</span>):</span></span><br><span class="line">        output_list = []</span><br><span class="line">        <span class="comment"># ############################ è¯çº§ #########################################</span></span><br><span class="line">        <span class="keyword">for</span> idx,doc <span class="keyword">in</span> <span class="built_in">enumerate</span>(batch_doc):</span><br><span class="line">            <span class="comment"># æŠŠä¸€ç¯‡æ–‡æ¡£æ‹†æˆå¤šä¸ªå¥å­</span></span><br><span class="line">            doc = doc[:text_lengths[idx]]</span><br><span class="line">            doc_list = doc.cpu().numpy().tolist()</span><br><span class="line">            sep_index = [i <span class="keyword">for</span> i, num <span class="keyword">in</span> <span class="built_in">enumerate</span>(doc_list) <span class="keyword">if</span> num == self.word_embedding.stoi[<span class="string">&#x27;[SEP]&#x27;</span>]]</span><br><span class="line">            sentence_list = []</span><br><span class="line">            <span class="keyword">if</span> sep_index:</span><br><span class="line">                pre = <span class="number">0</span></span><br><span class="line">                <span class="keyword">for</span> cur <span class="keyword">in</span> sep_index:</span><br><span class="line">                    sentence_list.append(doc_list[pre:cur])</span><br><span class="line">                    pre = cur</span><br><span class="line"></span><br><span class="line">                sentence_list.append(doc_list[cur:])</span><br><span class="line"></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                sentence_list.append(doc_list)</span><br><span class="line">            max_sentence_len = <span class="built_in">len</span>(<span class="built_in">max</span>(sentence_list,key=<span class="keyword">lambda</span> x:<span class="built_in">len</span>(x)))</span><br><span class="line">            seq_lens = []</span><br><span class="line">            input_token_ids = []</span><br><span class="line">            <span class="keyword">for</span> sent <span class="keyword">in</span> sentence_list:</span><br><span class="line">                cur_sent_len = <span class="built_in">len</span>(sent)</span><br><span class="line">                seq_lens.append(cur_sent_len)</span><br><span class="line">                input_token_ids.append(sent+[self.word_embedding.stoi[<span class="string">&#x27;PAD&#x27;</span>]]*(max_sentence_len-cur_sent_len))</span><br><span class="line">            input_token_ids = torch.LongTensor(np.array(input_token_ids)).to(batch_doc.device)</span><br><span class="line">            seq_lens = torch.LongTensor(np.array(seq_lens)).to(batch_doc.device)</span><br><span class="line">            word_output, hidden = self.word_att_net(input_token_ids,seq_lens)</span><br><span class="line">            <span class="comment"># word_output = [bs,hidden_size]</span></span><br><span class="line">            output_list.append(word_output)</span><br><span class="line"></span><br><span class="line">        max_doc_sent_num = <span class="built_in">len</span>(<span class="built_in">max</span>(output_list,key=<span class="keyword">lambda</span> x: <span class="built_in">len</span>(x)))</span><br><span class="line">        batch_sent_lens = []</span><br><span class="line">        batch_sent_inputs = []</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ############################ å¥å­çº§ #########################################</span></span><br><span class="line">        <span class="keyword">for</span> doc <span class="keyword">in</span> output_list:</span><br><span class="line">            cur_doc_sent_len = <span class="built_in">len</span>(doc)</span><br><span class="line">            batch_sent_lens.append(cur_doc_sent_len)</span><br><span class="line">            expand_doc = torch.cat([doc,torch.zeros(size=((max_doc_sent_num-cur_doc_sent_len),<span class="built_in">len</span>(doc[<span class="number">0</span>]))).to(doc.device)],dim=<span class="number">0</span>)</span><br><span class="line">            batch_sent_inputs.append(expand_doc.unsqueeze(dim=<span class="number">0</span>))</span><br><span class="line"></span><br><span class="line">        batch_sent_inputs = torch.cat(batch_sent_inputs, <span class="number">0</span>)</span><br><span class="line">        batch_sent_lens = torch.LongTensor(np.array(batch_sent_lens)).to(doc.device)</span><br><span class="line">        output = self.sent_att_net(batch_sent_inputs,batch_sent_lens)</span><br><span class="line">        <span class="keyword">return</span> output</span><br></pre></td></tr></table></figure><h1 id="BERT-ğŸ˜Š"><a href="#BERT-ğŸ˜Š" class="headerlink" title="BERT ğŸ˜Š"></a>BERT ğŸ˜Š</h1><div align=center><img width="600" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e4d4a04d28ef44ec84efa17066a30ebe~tplv-k3u1fbpfcp-zoom-1.image"/></div><p><code>BERTï¼ˆBidirectional Encoder Representations from Transformersï¼‰</code> çš„å‘å¸ƒæ˜¯ <code>NLP</code> é¢†åŸŸå‘å±•çš„æœ€æ–°çš„é‡Œç¨‹ç¢‘ä¹‹ä¸€ï¼Œè¿™ä¸ªäº‹ä»¶ <code>NLP</code> æ–°æ—¶ä»£çš„å¼€å§‹ã€‚<code>BERT</code> æ¨¡å‹æ‰“ç ´äº†åŸºäºè¯­è¨€å¤„ç†çš„ä»»åŠ¡çš„å‡ ä¸ªè®°å½•ã€‚</p><p>åœ¨ <code>BERT</code> çš„è®ºæ–‡å‘å¸ƒåä¸ä¹…ï¼Œè¿™ä¸ªå›¢é˜Ÿè¿˜å…¬å¼€äº†æ¨¡å‹çš„ä»£ç ï¼Œå¹¶æä¾›äº†æ¨¡å‹çš„ä¸‹è½½ç‰ˆæœ¬ï¼Œè¿™äº›æ¨¡å‹å·²ç»åœ¨å¤§è§„æ¨¡æ•°æ®é›†ä¸Šè¿›è¡Œäº†é¢„è®­ç»ƒã€‚è¿™æ˜¯ä¸€ä¸ªé‡å¤§çš„å‘å±•ï¼Œå› ä¸ºå®ƒä½¿å¾—ä»»ä½•ä¸€ä¸ªæ„å»ºæ„å»ºæœºå™¨å­¦ä¹ æ¨¡å‹æ¥å¤„ç†è¯­è¨€çš„äººï¼Œéƒ½å¯ä»¥å°†è¿™ä¸ªå¼ºå¤§çš„åŠŸèƒ½ä½œä¸ºä¸€ä¸ªç°æˆçš„ç»„ä»¶æ¥ä½¿ç”¨ï¼Œä»è€ŒèŠ‚çœäº†ä»é›¶å¼€å§‹è®­ç»ƒè¯­è¨€å¤„ç†æ¨¡å‹æ‰€éœ€è¦çš„æ—¶é—´ã€ç²¾åŠ›ã€çŸ¥è¯†å’Œèµ„æºã€‚</p><p>æ›´å¤šè¯¦ç»†å†…å®¹è§ <a href="https://zhuanlan.zhihu.com/p/266364526">ã€å›¾è§£BERTã€‘</a>ã€<a href="https://cloud.tencent.com/developer/article/1389555">ã€å›¾è§£BERTæ¨¡å‹ã€‘</a></p><h2 id="Task-1-Masked-Language-Model"><a href="#Task-1-Masked-Language-Model" class="headerlink" title="Task 1: Masked Language Model"></a>Task 1: Masked Language Model</h2><p>ç”±äº <code>BERT</code> éœ€è¦é€šè¿‡ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œæ¥é¢„æµ‹ä¸­å¿ƒè¯çš„ä¿¡æ¯ï¼ŒåŒæ—¶åˆä¸å¸Œæœ›æ¨¡å‹æå‰çœ‹è§ä¸­å¿ƒè¯çš„ä¿¡æ¯ï¼Œå› æ­¤æå‡ºäº†ä¸€ç§ <code>Masked Language Model</code> çš„é¢„è®­ç»ƒæ–¹å¼ï¼Œå³éšæœºä»è¾“å…¥é¢„æ–™ä¸Š <code>mask</code> æ‰ä¸€äº›å•è¯ï¼Œç„¶åé€šè¿‡çš„ä¸Šä¸‹æ–‡é¢„æµ‹è¯¥å•è¯ï¼Œç±»ä¼¼äºä¸€ä¸ªå®Œå½¢å¡«ç©ºä»»åŠ¡ã€‚</p><p>åœ¨é¢„è®­ç»ƒä»»åŠ¡ä¸­ï¼Œ15% çš„ <code>Word Piece</code> ä¼šè¢« <code>mask</code>ï¼Œè¿™ 15% çš„ <code>Word Piece</code> ä¸­ï¼Œ80%çš„æ—¶å€™ä¼šç›´æ¥æ›¿æ¢ä¸º <code>[Mask]</code> ï¼Œ10% çš„æ—¶å€™å°†å…¶æ›¿æ¢ä¸ºå…¶å®ƒä»»æ„å•è¯ï¼Œ10% çš„æ—¶å€™ä¼šä¿ç•™åŸå§‹ <code>Token</code></p><ul><li>æ²¡æœ‰100% <code>mask</code> çš„åŸå› <ul><li>å¦‚æœå¥å­ä¸­çš„æŸä¸ª<code>Token</code> 100% éƒ½ä¼šè¢« <code>mask</code> æ‰ï¼Œé‚£ä¹ˆåœ¨<code>fine-tuning</code> çš„æ—¶å€™æ¨¡å‹å°±ä¼šæœ‰ä¸€äº›æ²¡æœ‰è§è¿‡çš„å•è¯</li></ul></li><li>åŠ å…¥ 10% éšæœº <code>token</code> çš„åŸå› <ul><li><code>Transformer</code> è¦ä¿æŒå¯¹æ¯ä¸ªè¾“å…¥ <code>token</code> çš„åˆ†å¸ƒå¼è¡¨å¾ï¼Œå¦åˆ™æ¨¡å‹å°±ä¼šè®°ä½è¿™ä¸ª <code>[mask]</code> æ˜¯ æŸä¸ªç‰¹å®šçš„ <code>token</code></li><li>å¦å¤–ç¼–ç å™¨ä¸çŸ¥é“å“ªäº›è¯éœ€è¦é¢„æµ‹çš„ï¼Œå“ªäº›è¯æ˜¯é”™è¯¯çš„ï¼Œå› æ­¤è¢«è¿«éœ€è¦å­¦ä¹ æ¯ä¸€ä¸ª <code>token</code> çš„è¡¨ç¤ºå‘é‡</li></ul></li><li>å¦å¤–ï¼Œæ¯ä¸ª <code>batchsize</code> åªæœ‰ 15% çš„å•è¯è¢« <code>mask</code> çš„åŸå› ï¼Œæ˜¯å› ä¸ºæ€§èƒ½å¼€é”€çš„é—®é¢˜ï¼ŒåŒå‘ç¼–ç å™¨æ¯”å•é¡¹ç¼–ç å™¨è®­ç»ƒè¦æ›´æ…¢</li></ul><h2 id="Task-2-Next-Sequence-Prediction"><a href="#Task-2-Next-Sequence-Prediction" class="headerlink" title="Task 2: Next Sequence Prediction"></a>Task 2: Next Sequence Prediction</h2><div align=center><img width="600" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4f9094e61c9049d09b118dafde9d31f1~tplv-k3u1fbpfcp-zoom-1.image"/></div><p>ä»…ä»…ä¸€ä¸ª <code>MLM</code> ä»»åŠ¡æ˜¯ä¸è¶³ä»¥è®© <code>BERT</code> è§£å†³é˜…è¯»ç†è§£ç­‰å¥å­å…³ç³»åˆ¤æ–­ä»»åŠ¡çš„ï¼Œå› æ­¤æ·»åŠ äº†é¢å¤–çš„ä¸€ä¸ªé¢„è®­ç»ƒä»»åŠ¡ï¼Œå³ <code>Next Sequence Prediction</code>ã€‚</p><p>å…·ä½“ä»»åŠ¡å³ä¸ºä¸€ä¸ªå¥å­å…³ç³»åˆ¤æ–­ä»»åŠ¡ï¼Œå³åˆ¤æ–­å¥å­Bæ˜¯å¦æ˜¯å¥å­Açš„ä¸‹æ–‡ï¼Œå¦‚æœæ˜¯çš„è¯è¾“å‡º <code>IsNext</code>ï¼Œå¦åˆ™è¾“å‡º <code>NotNext</code>ã€‚</p><p>è®­ç»ƒæ•°æ®çš„ç”Ÿæˆæ–¹å¼æ˜¯ä»å¹³è¡Œè¯­æ–™ä¸­éšæœºæŠ½å–çš„è¿ç»­ä¸¤å¥è¯ï¼Œå…¶ä¸­ 50% ä¿ç•™æŠ½å–çš„ä¸¤å¥è¯ï¼Œå®ƒä»¬ç¬¦åˆ <code>IsNext</code> å…³ç³»ï¼Œå¦å¤– 50% çš„ç¬¬äºŒå¥è¯æ˜¯éšæœºä»é¢„æ–™ä¸­æå–çš„ï¼Œå®ƒä»¬çš„å…³ç³»æ˜¯ <code>NotNext</code> çš„ã€‚è¿™ä¸ªå…³ç³»ä¿å­˜åœ¨ <code>[CLS]</code> ç¬¦å·ä¸­ã€‚</p><h2 id="è¾“å…¥"><a href="#è¾“å…¥" class="headerlink" title="è¾“å…¥"></a>è¾“å…¥</h2><ul><li><p><code>Token Embeddings</code>ï¼šå³ä¼ ç»Ÿçš„è¯å‘é‡å±‚ï¼Œæ¯ä¸ªè¾“å…¥æ ·æœ¬çš„é¦–å­—ç¬¦éœ€è¦è®¾ç½®ä¸º <code>[CLS]</code>ï¼Œå¯ä»¥ç”¨äºä¹‹åçš„åˆ†ç±»ä»»åŠ¡ï¼Œè‹¥æœ‰ä¸¤ä¸ªä¸åŒçš„å¥å­ï¼Œéœ€è¦ç”¨ <code>[SEP]</code> åˆ†éš”ï¼Œä¸”æœ€åä¸€ä¸ªå­—ç¬¦éœ€è¦ç”¨ <code>[SEP]</code> è¡¨ç¤ºç»ˆæ­¢ã€‚</p></li><li><p><code>Segment Embeddings</code>ï¼šä¸º <code>[0,1]</code> åºåˆ—ï¼Œç”¨æ¥åœ¨ <code>NSP</code> ä»»åŠ¡ä¸­åŒºåˆ«ä¸¤ä¸ªå¥å­ï¼Œä¾¿äºåšå¥å­å…³ç³»åˆ¤æ–­ä»»åŠ¡ã€‚</p></li><li><p><code>Position Embeddings</code> ï¼šä¸ <code>Transformer</code> ä¸­çš„ä½ç½®å‘é‡ä¸åŒï¼Œ<code>BERT</code> ä¸­çš„ä½ç½®å‘é‡æ˜¯ç›´æ¥è®­ç»ƒå‡ºæ¥çš„ã€‚</p></li></ul><div align=center><img width="600" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5931f6c34cc64d979ff80dc3d482d74d~tplv-k3u1fbpfcp-zoom-1.image"/></div><h2 id="Fine-tuning"><a href="#Fine-tuning" class="headerlink" title="Fine-tuning"></a>Fine-tuning</h2><p>å¯¹äºä¸åŒçš„ä¸‹æ¸¸ä»»åŠ¡ï¼Œæˆ‘ä»¬ä»…éœ€è¦å¯¹ <code>BERT</code> ä¸åŒä½ç½®çš„è¾“å‡ºè¿›è¡Œå¤„ç†å³å¯ï¼Œæˆ–è€…ç›´æ¥å°†BERTä¸åŒä½ç½®çš„è¾“å‡ºç›´æ¥è¾“å…¥åˆ°ä¸‹æ¸¸æ¨¡å‹å½“ä¸­ã€‚å…·ä½“çš„å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div align=center><img width="600" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ec6c09b656bd4b3a8698b5ebe98a9c57~tplv-k3u1fbpfcp-zoom-1.image"/></div><ul><li><p>å¯¹äºæƒ…æ„Ÿåˆ†æç­‰å•å¥åˆ†ç±»ä»»åŠ¡ï¼Œå¯ä»¥ç›´æ¥è¾“å…¥å•ä¸ªå¥å­ï¼ˆä¸éœ€è¦ <code>[SEP]</code> åˆ†éš”åŒå¥ï¼‰ï¼Œå°† <code>[CLS]</code> çš„è¾“å‡ºç›´æ¥è¾“å…¥åˆ°åˆ†ç±»å™¨è¿›è¡Œåˆ†ç±»ã€‚</p></li><li><p>å¯¹äºå¥å­å¯¹ä»»åŠ¡ï¼ˆå¥å­å…³ç³»åˆ¤æ–­ä»»åŠ¡ï¼‰ï¼Œéœ€è¦ç”¨ <code>[SEP]</code> åˆ†éš”ä¸¤ä¸ªå¥å­è¾“å…¥åˆ°æ¨¡å‹ä¸­ï¼Œç„¶ååŒæ ·ä»…é¡»å°† <code>[CLS]</code> çš„è¾“å‡ºé€åˆ°åˆ†ç±»å™¨è¿›è¡Œåˆ†ç±»ã€‚</p></li><li><p>å¯¹äºé—®ç­”ä»»åŠ¡ï¼Œå°†é—®é¢˜ä¸ç­”æ¡ˆæ‹¼æ¥è¾“å…¥åˆ° <code>BERT</code> æ¨¡å‹ä¸­ï¼Œç„¶åå°†ç­”æ¡ˆä½ç½®çš„è¾“å‡ºå‘é‡è¿›è¡ŒäºŒåˆ†ç±»å¹¶åœ¨å¥å­æ–¹å‘ä¸Šè¿›è¡Œ <code>softmax</code>ï¼ˆåªéœ€é¢„æµ‹å¼€å§‹å’Œç»“æŸä½ç½®å³å¯ï¼‰ã€‚</p></li><li><p>å¯¹äºå‘½åå®ä½“è¯†åˆ«ä»»åŠ¡ï¼Œå¯¹æ¯ä¸ªä½ç½®çš„è¾“å‡ºè¿›è¡Œåˆ†ç±»å³å¯ï¼Œå¦‚æœå°†æ¯ä¸ªä½ç½®çš„è¾“å‡ºä½œä¸ºç‰¹å¾è¾“å…¥åˆ° <code>CRF</code> å°†å–å¾—æ›´å¥½çš„æ•ˆæœã€‚</p></li></ul><h2 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h2><ul><li><p><code>BERT</code> çš„é¢„è®­ç»ƒä»»åŠ¡ <code>MLM</code> ä½¿å¾—èƒ½å¤Ÿå€ŸåŠ©ä¸Šä¸‹æ–‡å¯¹åºåˆ—è¿›è¡Œç¼–ç ï¼Œä½†åŒæ—¶ä¹Ÿä½¿å¾—å…¶é¢„è®­ç»ƒè¿‡ç¨‹ä¸ä¸­çš„æ•°æ®ä¸å¾®è°ƒçš„æ•°æ®ä¸åŒ¹é…ï¼Œéš¾ä»¥é€‚åº”ç”Ÿæˆå¼ä»»åŠ¡ã€‚</p></li><li><p>å¦å¤–ï¼Œ<code>BERT</code> æ²¡æœ‰è€ƒè™‘é¢„æµ‹ <code>[MASK]</code> ä¹‹é—´çš„ç›¸å…³æ€§ï¼Œæ˜¯å¯¹è¯­è¨€æ¨¡å‹è”åˆæ¦‚ç‡çš„æœ‰åä¼°è®¡ã€‚</p></li><li><p>ç”±äºæœ€å¤§è¾“å…¥é•¿åº¦çš„é™åˆ¶ï¼Œé€‚åˆå¥å­å’Œæ®µè½çº§åˆ«çš„ä»»åŠ¡ï¼Œä¸é€‚ç”¨äºæ–‡æ¡£çº§åˆ«çš„ä»»åŠ¡ï¼ˆå¦‚é•¿æ–‡æœ¬åˆ†ç±»ï¼‰ã€‚</p></li><li><p>é€‚åˆå¤„ç†è‡ªç„¶è¯­ä¹‰ç†è§£ç±»ä»»åŠ¡(<code>NLU</code>)ï¼Œè€Œä¸é€‚åˆè‡ªç„¶è¯­è¨€ç”Ÿæˆç±»ä»»åŠ¡(<code>NLG</code>)ã€‚</p></li></ul><p><code>BERT</code> åˆ†ç±»çš„ä¼˜åŒ–å¯ä»¥å°è¯• ğŸ‘¼ï¼š</p><ul><li><p>å°è¯•ä¸åŒçš„é¢„è®­ç»ƒæ¨¡å‹ï¼Œæ¯”å¦‚ <code>RoBERT</code>ã€<code>WWM</code>ã€<code>ALBERT</code>ã€‚</p></li><li><p>é™¤äº† <code>[CLS]</code> å¤–è¿˜å¯ä»¥ç”¨ <code>avg</code>ã€<code>max</code> æ± åŒ–åšå¥è¡¨ç¤ºï¼Œç”šè‡³å¯ä»¥æŠŠä¸åŒå±‚ç»„åˆèµ·æ¥ã€‚</p></li><li><p>åœ¨é¢†åŸŸæ•°æ®ä¸Šå¢é‡é¢„è®­ç»ƒã€‚</p></li><li><p>é›†æˆè’¸é¦ï¼Œè®­å¤šä¸ªå¤§æ¨¡å‹é›†æˆèµ·æ¥åè’¸é¦åˆ°ä¸€ä¸ªä¸Šã€‚</p></li><li><p>å…ˆç”¨å¤šä»»åŠ¡è®­ï¼Œå†è¿ç§»åˆ°è‡ªå·±çš„ä»»åŠ¡ã€‚</p></li></ul><h2 id="æ¨¡å‹ç»“æ„å’Œä»£ç -3"><a href="#æ¨¡å‹ç»“æ„å’Œä»£ç -3" class="headerlink" title="æ¨¡å‹ç»“æ„å’Œä»£ç "></a>æ¨¡å‹ç»“æ„å’Œä»£ç </h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BertForSeqCLS</span>(<span class="params">nn.Module</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, config</span>):</span></span><br><span class="line">        <span class="built_in">super</span>(BertForSeqCLS, self).__init__()</span><br><span class="line">        self.bert = BertModel.from_pretrained(config)</span><br><span class="line"></span><br><span class="line">        self.dropout = nn.Dropout(config.dropout)</span><br><span class="line">        self.fc = nn.Linear(<span class="number">768</span> * <span class="number">3</span>, config.class_num)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">forward</span>(<span class="params">self, input_ids, attention_mask, labels=<span class="literal">None</span></span>):</span></span><br><span class="line">        <span class="comment"># input_ids  è¾“å…¥çš„å¥å­åºåˆ—</span></span><br><span class="line">        <span class="comment"># seq_len  å¥å­é•¿åº¦</span></span><br><span class="line">        <span class="comment"># attention_masks  å¯¹paddingéƒ¨åˆ†è¿›è¡Œmaskï¼Œå’Œå¥å­ä¸€ä¸ªsizeï¼Œpaddingéƒ¨åˆ†ç”¨0è¡¨ç¤ºï¼Œå¦‚ï¼š[1, 1, 1, 1, 0, 0]</span></span><br><span class="line">        <span class="comment"># pooled_out [batch_size, 768]</span></span><br><span class="line">        <span class="comment"># sentence [batch size, sen len,  768]</span></span><br><span class="line">        </span><br><span class="line">        outputs = self.bert(input_ids,        attention_mask=attention_mask, </span><br><span class="line">        output_hidden_states=<span class="literal">True</span>)</span><br><span class="line">        cat_out = torch.cat((outputs.pooler_output, outputs.hidden_states[-<span class="number">1</span>][:,<span class="number">0</span>], </span><br><span class="line">                             outputs.hidden_states[-<span class="number">2</span>][:, <span class="number">0</span>]), <span class="number">1</span>)</span><br><span class="line">        logits = self.fc(self.dropout(cat_out))</span><br><span class="line"></span><br><span class="line">        loss = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">if</span> labels <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            loss = F.cross_entropy(logits.view(-<span class="number">1</span>, config.class_num), labels.view(-<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&quot;loss&quot;</span>: loss, <span class="string">&quot;logits&quot;</span>: logits&#125;</span><br></pre></td></tr></table></figure><h1 id="æ–‡æœ¬åˆ†ç±»æŠ€å·§"><a href="#æ–‡æœ¬åˆ†ç±»æŠ€å·§" class="headerlink" title="æ–‡æœ¬åˆ†ç±»æŠ€å·§"></a>æ–‡æœ¬åˆ†ç±»æŠ€å·§</h1><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/62d4e2fd39be4a5db9471baf753f49cd~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><h2 id="æ•°æ®é›†æ„å»º"><a href="#æ•°æ®é›†æ„å»º" class="headerlink" title="æ•°æ®é›†æ„å»º"></a>æ•°æ®é›†æ„å»º</h2><p>é¦–å…ˆæ˜¯æ ‡ç­¾ä½“ç³»çš„æ„å»ºï¼Œæ‹¿åˆ°ä»»åŠ¡æ—¶è‡ªå·±å…ˆè¯•æ ‡ä¸€ä¸¤ç™¾æ¡ï¼Œçœ‹æœ‰å¤šå°‘æ˜¯éš¾ç¡®å®šï¼ˆæ€è€ƒ1sä»¥ä¸Šï¼‰çš„ï¼Œå¦‚æœå æ¯”å¤ªå¤šï¼Œé‚£è¿™ä¸ªä»»åŠ¡çš„å®šä¹‰å°±æœ‰é—®é¢˜ã€‚å¯èƒ½æ˜¯æ ‡ç­¾ä½“ç³»ä¸æ¸…æ™°ï¼Œæˆ–è€…æ˜¯è¦åˆ†çš„ç±»ç›®å¤ªéš¾äº†ï¼Œè¿™æ—¶å€™å°±è¦æ‰¾é¡¹ç›®ownerå»åé¦ˆè€Œä¸æ˜¯ç»§ç»­å¾€ä¸‹åšã€‚</p><p>å…¶æ¬¡æ˜¯è®­ç»ƒè¯„ä¼°é›†çš„æ„å»ºï¼Œå¯ä»¥æ„å»ºä¸¤ä¸ªè¯„ä¼°é›†ï¼Œä¸€ä¸ªæ˜¯è´´åˆçœŸå®æ•°æ®åˆ†å¸ƒçš„çº¿ä¸Šè¯„ä¼°é›†ï¼Œåæ˜ çº¿ä¸Šæ•ˆæœï¼Œå¦ä¸€ä¸ªæ˜¯ç”¨è§„åˆ™å»é‡åå‡åŒ€é‡‡æ ·çš„éšæœºè¯„ä¼°é›†ï¼Œåæ˜ æ¨¡å‹çš„çœŸå®èƒ½åŠ›ã€‚è®­ç»ƒé›†åˆ™å°½å¯èƒ½å’Œè¯„ä¼°é›†åˆ†å¸ƒä¸€è‡´ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬ä¼šå»ç›¸è¿‘çš„é¢†åŸŸæ‹¿ç°æˆçš„æœ‰æ ‡æ³¨è®­ç»ƒæ•°æ®ï¼Œè¿™æ—¶å°±è¦æ³¨æ„è°ƒæ•´åˆ†å¸ƒï¼Œæ¯”å¦‚å¥å­é•¿åº¦ã€æ ‡ç‚¹ã€å¹²å‡€ç¨‹åº¦ç­‰ï¼Œå°½å¯èƒ½åšåˆ°è‡ªå·±åˆ†ä¸å‡ºè¿™ä¸ªå¥å­æ˜¯æœ¬ä»»åŠ¡çš„è¿˜æ˜¯ä»åˆ«äººé‚£é‡Œå€Ÿæ¥çš„ã€‚</p><p>æœ€åæ˜¯æ•°æ®æ¸…æ´—ï¼š</p><ul><li><p>å»æ‰æ–‡æœ¬å¼º <code>pattern</code>ï¼šæ¯”å¦‚åšæ–°é—»ä¸»é¢˜åˆ†ç±»ï¼Œä¸€äº›çˆ¬ä¸‹æ¥çš„æ•°æ®ä¸­å¸¦æœ‰çš„XXæŠ¥é“ã€XXç¼–è¾‘é«˜é¢‘å­—æ®µå°±æ²¡æœ‰ç”¨ï¼Œå¯ä»¥å¯¹è¯­æ–™çš„ç‰‡æ®µæˆ–è¯è¿›è¡Œç»Ÿè®¡ï¼ŒæŠŠå¾ˆé«˜é¢‘çš„æ— ç”¨å…ƒç´ å»æ‰ã€‚è¿˜æœ‰ä¸€äº›ä¼šæ˜æ˜¾å½±å“æ¨¡å‹çš„åˆ¤æ–­ï¼Œæ¯”å¦‚ä¹‹å‰åˆ¤æ–­å¥å­æ˜¯å¦ä¸ºæ— æ„ä¹‰çš„é—²èŠæ—¶ï¼Œå‘ç°åŠ ä¸ªå¥å·å°±ä¼šè®©æ ·æœ¬ç”±æ­£è½¬è´Ÿï¼Œå› ä¸ºè®­ç»ƒé¢„æ–™ä¸­çš„é—²èŠå¾ˆå°‘å¸¦å¥å·ï¼ˆè·Ÿå¤§å®¶çš„æ‰“å­—ä¹ æƒ¯æœ‰å…³ï¼‰ï¼Œäºæ˜¯å»æ‰è¿™ä¸ª<code>pattern</code> å°±å¥½äº†ä¸å°‘</p></li><li><p>çº æ­£æ ‡æ³¨é”™è¯¯ï¼šç®€å•çš„è¯´å°±æ˜¯æŠŠè®­ç»ƒé›†å’Œè¯„ä¼°é›†æ‹¼èµ·æ¥ï¼Œç”¨è¯¥æ•°æ®é›†è®­ç»ƒæ¨¡å‹ä¸¤ä¸‰ä¸ª <code>epoch</code> ï¼ˆé˜²æ­¢è¿‡æ‹Ÿåˆï¼‰ï¼Œå†å»é¢„æµ‹è¿™ä¸ªæ•°æ®é›†ï¼ŒæŠŠæ¨¡å‹åˆ¤é”™çš„æ‹¿å‡ºæ¥æŒ‰ <code>abs(label-prob)</code> æ’åºï¼Œå°‘çš„è¯å°±è‡ªå·±çœ‹ï¼Œå¤šçš„è¯å°±åé¦ˆç»™æ ‡æ³¨äººå‘˜ï¼ŒæŠŠæ•°æ®è´¨é‡æä¸Šå»äº†æå‡å¥½å‡ ä¸ªç‚¹éƒ½æ˜¯å¯èƒ½çš„ã€‚</p></li></ul><h2 id="é•¿æ–‡æœ¬"><a href="#é•¿æ–‡æœ¬" class="headerlink" title="é•¿æ–‡æœ¬"></a>é•¿æ–‡æœ¬</h2><ul><li><p>ä»»åŠ¡ç®€å•çš„è¯ï¼ˆæ¯”å¦‚æ–°é—»åˆ†ç±»ï¼‰ï¼Œç›´æ¥ç”¨ <code>fasttext</code> å°±å¯ä»¥è¾¾åˆ°ä¸é”™çš„æ•ˆæœã€‚</p></li><li><p>æƒ³è¦ç”¨ <code>BERT</code> çš„è¯ï¼Œæœ€ç®€å•çš„æ–¹æ³•æ˜¯ç²—æš´æˆªæ–­ï¼Œæ¯”å¦‚åªå–å¥é¦–+å¥å°¾ã€å¥é¦– + <code>tfidf</code> ç­›å‡ ä¸ªè¯å‡ºæ¥ï¼›æˆ–è€…æ¯å¥éƒ½é¢„æµ‹ï¼Œæœ€åå¯¹ç»“æœç»¼åˆã€‚</p></li><li><p>å¦å¤–è¿˜æœ‰ä¸€äº›é­”æ”¹çš„æ¨¡å‹å¯ä»¥å°è¯•ï¼Œæ¯”å¦‚<code>BERT+HAN</code>ã€<code>XLNet</code>ã€<code>Reformer</code>ã€<code>Longformer</code>ã€‚</p></li></ul><h2 id="ç¨³å¥æ€§"><a href="#ç¨³å¥æ€§" class="headerlink" title="ç¨³å¥æ€§"></a>ç¨³å¥æ€§</h2><p>åœ¨å®é™…çš„åº”ç”¨ä¸­ï¼Œé²æ£’æ€§æ˜¯ä¸ªå¾ˆé‡è¦çš„é—®é¢˜ï¼Œå¦åˆ™åœ¨é¢å¯¹ <code>badcase</code> æ—¶ä¼šå¾ˆå°´å°¬ï¼Œæ€ä¹ˆæ˜æ˜é‚£æ ·å°±åˆ†å¯¹äº†ï¼ŒåŠ ä¸€ä¸ªå­—å°±é”™äº†å‘¢ï¼Ÿè¿™é‡Œå¯ä»¥ç›´æ¥ä½¿ç”¨ä¸€äº›ç²—æš´çš„æ•°æ®å¢å¼ºï¼ŒåŠ åœç”¨è¯åŠ æ ‡ç‚¹ã€åˆ è¯ã€åŒä¹‰è¯æ›¿æ¢ç­‰ï¼Œå¦‚æœæ•ˆæœä¸‹é™å°±æŠŠå¢å¼ºåçš„è®­ç»ƒæ•°æ®æ´—ä¸€ä¸‹ã€‚å½“ç„¶ä¹Ÿå¯ä»¥ç”¨å¯¹æŠ—å­¦ä¹ ã€å¯¹æ¯”å­¦ä¹ è¿™æ ·çš„é«˜é˜¶æŠ€å·§æ¥æå‡ï¼Œä¸€èˆ¬å¯ä»¥æ1ä¸ªç‚¹å·¦å³ï¼Œä½†ä¸ä¸€å®šèƒ½é¿å…ä¸Šé¢é‚£ç§å°´å°¬çš„æƒ…å†µã€‚</p><h1 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h1><ol><li><a href="https://arxiv.org/abs/1607.01759">https://arxiv.org/abs/1607.01759</a></li><li><a href="https://arxiv.org/abs/1408.5882">https://arxiv.org/abs/1408.5882</a></li><li><a href="https://ai.tencent.com/ailab/media/publications/ACL3-Brady.pdf">https://ai.tencent.com/ailab/media/publications/ACL3-Brady.pdf</a></li><li><a href="https://dl.acm.org/doi/10.5555/2886521.2886636">https://dl.acm.org/doi/10.5555/2886521.2886636</a></li><li><a href="https://www.aclweb.org/anthology/N16-1174.pdf">https://www.aclweb.org/anthology/N16-1174.pdf</a></li><li><a href="https://zhuanlan.zhihu.com/p/266364526">https://zhuanlan.zhihu.com/p/266364526</a></li><li><a href="https://cloud.tencent.com/developer/article/1389555">https://cloud.tencent.com/developer/article/1389555</a></li><li><a href="https://www.cnblogs.com/sandwichnlp/p/11698996.html">https://www.cnblogs.com/sandwichnlp/p/11698996.html</a></li><li><a href="https://github.com/jeffery0628/text_classification">https://github.com/jeffery0628/text_classification</a></li><li><a href="https://zhuanlan.zhihu.com/p/349086747">https://zhuanlan.zhihu.com/p/349086747</a></li><li><a href="https://zhuanlan.zhihu.com/p/35457093">https://zhuanlan.zhihu.com/p/35457093</a></li><li><a href="https://www.pianshen.com/article/4319299677/">https://www.pianshen.com/article/4319299677/</a></li><li><a href="https://www.zhihu.com/question/326770917/answer/698646465">https://www.zhihu.com/question/326770917/answer/698646465</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> è‡ªç„¶è¯­è¨€å¤„ç† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ–‡æœ¬åˆ†ç±» </tag>
            
            <tag> æ·±åº¦å­¦ä¹  </tag>
            
            <tag> æ·±å±‚æ¨¡å‹ </tag>
            
            <tag> BERT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ–‡æœ¬åˆ†ç±»çš„æ·±åº¦å­¦ä¹ æ–¹æ³•ã€ä¸€ã€‘</title>
      <link href="/2021/08/31/text_classification1/"/>
      <url>/2021/08/31/text_classification1/</url>
      
        <content type="html"><![CDATA[<h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h1><p>æ–‡æœ¬åˆ†ç±»ğŸ“–åœ¨æ–‡æœ¬å¤„ç†ä¸­æ˜¯å¾ˆé‡è¦çš„ä¸€ä¸ªæ¨¡å—ï¼Œå®ƒçš„åº”ç”¨ä¹Ÿéå¸¸å¹¿æ³›ï¼Œæ¯”å¦‚ï¼šæ–°é—»åˆ†ç±»ã€ç®€å†åˆ†ç±»ã€é‚®ä»¶åˆ†ç±»ã€åŠå…¬æ–‡æ¡£åˆ†ç±»ã€åŒºåŸŸåˆ†ç±»ç­‰è¯¸å¤šæ–¹é¢ï¼Œè¿˜èƒ½å¤Ÿå®ç°æ–‡æœ¬è¿‡æ»¤ï¼Œä»å¤§é‡æ–‡æœ¬ä¸­å¿«é€Ÿè¯†åˆ«å’Œè¿‡æ»¤å‡ºç¬¦åˆç‰¹æ®Šè¦æ±‚çš„ä¿¡æ¯ã€‚æ ¸å¿ƒæ–¹æ³•ä¸ºé¦–å…ˆæå–åˆ†ç±»æ•°æ®çš„ç‰¹å¾ï¼Œç„¶åé€‰æ‹©æœ€ä¼˜çš„åŒ¹é…ï¼Œä»è€Œåˆ†ç±»ã€‚</p><p>é€šå¸¸æ¥è®²ï¼Œæ–‡æœ¬åˆ†ç±»ä»»åŠ¡æ˜¯æŒ‡åœ¨ç»™å®šçš„åˆ†ç±»ä½“ç³»ä¸­ï¼Œå°†æ–‡æœ¬æŒ‡å®šåˆ†åˆ°æŸä¸ªæˆ–æŸå‡ ä¸ªç±»åˆ«ä¸­ï¼Œè¢«åˆ†ç±»çš„å¯¹è±¡æœ‰çŸ­æ–‡æœ¬ï¼Œä¾‹å¦‚å¥å­ã€æ ‡é¢˜ã€å•†å“è¯„è®ºç­‰ç­‰ï¼Œé•¿æ–‡æœ¬å¦‚æ–‡ç« ç­‰ã€‚åˆ†ç±»ä½“ç³»ä¸€èˆ¬äººå·¥åˆ’åˆ†ï¼Œä¾‹å¦‚ï¼š1ï¼‰æ”¿æ²»ã€ä½“è‚²ã€å†›äº‹ 2ï¼‰æ­£èƒ½é‡ã€è´Ÿèƒ½é‡ 3ï¼‰å¥½è¯„ã€ä¸­æ€§ã€å·®è¯„ã€‚æ­¤å¤–ï¼Œè¿˜æœ‰æ–‡æœ¬å¤šæ ‡ç­¾åˆ†ç±»ï¼Œæ¯”å¦‚ä¸€ç¯‡åšå®¢çš„æ ‡ç­¾å¯ä»¥åŒæ—¶æ˜¯ï¼šè‡ªç„¶è¯­è¨€å¤„ç†ï¼Œæ–‡æœ¬åˆ†ç±»ç­‰ã€‚å› æ­¤ï¼Œå¯¹åº”çš„åˆ†ç±»æ¨¡å¼å¯ä»¥åˆ†ä¸ºï¼š<strong>äºŒåˆ†ç±»</strong>ã€<strong>å¤šåˆ†ç±»</strong>ä»¥åŠ<strong>å¤šæ ‡ç­¾åˆ†ç±»</strong>ã€‚</p><p><img src="https://few-shot-text-classification.fastforwardlabs.com/figures/ff18-01.png" width="500" height="300" align="middle" /></p><h1 id="æ–‡æœ¬åˆ†ç±»çš„ä¸»è¦ä»»åŠ¡"><a href="#æ–‡æœ¬åˆ†ç±»çš„ä¸»è¦ä»»åŠ¡" class="headerlink" title="æ–‡æœ¬åˆ†ç±»çš„ä¸»è¦ä»»åŠ¡"></a>æ–‡æœ¬åˆ†ç±»çš„ä¸»è¦ä»»åŠ¡</h1><ul><li><p>æƒ…æ„Ÿåˆ†æâ­ï¸ï¼šåˆ†æäººä»¬åœ¨æ–‡æœ¬æ•°æ®ï¼ˆå¦‚äº§å“è¯„è®ºã€ç”µå½±è¯„è®ºå’Œæ¨ç‰¹ï¼‰ä¸­çš„è§‚ç‚¹ï¼Œå¹¶æå–ä»–ä»¬çš„ææ€§å’Œè§‚ç‚¹ã€‚å¯ä»¥æ˜¯äºŒåˆ†ç±»é—®é¢˜ä¹Ÿå¯ä»¥æ˜¯å¤šåˆ†ç±»é—®é¢˜ï¼ŒäºŒå…ƒæƒ…æ„Ÿåˆ†ææ˜¯å°†æ–‡æœ¬åˆ†ä¸ºæ­£ç±»å’Œè´Ÿç±»ï¼Œè€Œå¤šç±»æƒ…æ„Ÿåˆ†æåˆ™ä¾§é‡äºå°†æ•°æ®åˆ†ä¸ºç»†ç²’åº¦çš„æ ‡ç­¾æˆ–å¤šå±‚æ¬¡çš„å¼ºåº¦ã€‚</p></li><li><p>æ–°é—»åˆ†ç±»â­ï¸ï¼šæ–°é—»åˆ†ç±»ç³»ç»Ÿå¯ä»¥å¸®åŠ©ç”¨æˆ·å®æ—¶è·å–æ„Ÿå…´è¶£çš„ä¿¡æ¯ã€‚åŸºäºç”¨æˆ·å…´è¶£çš„æ–°é—»ä¸»é¢˜è¯†åˆ«å’Œç›¸å…³æ–°é—»æ¨èæ˜¯æ–°é—»åˆ†ç±»çš„ä¸¤ä¸ªä¸»è¦åº”ç”¨ã€‚</p></li><li><p>ä¸»é¢˜åˆ†æâ­ï¸ï¼šä¸»é¢˜åˆ†æè¯•å›¾é€šè¿‡è¯†åˆ«æ–‡æœ¬çš„ä¸»é¢˜ä»æ–‡æœ¬ä¸­è‡ªåŠ¨è·å¾—æ„ä¹‰ã€‚ä¸»é¢˜åˆ†ç±»çš„ç›®æ ‡æ˜¯ä¸ºæ¯ä¸ªæ–‡æ¡£åˆ†é…ä¸€ä¸ªæˆ–å¤šä¸ªä¸»é¢˜ï¼Œä»¥ä¾¿äºåˆ†æã€‚</p></li><li><p>é—®ç­”ç³»ç»Ÿâ­ï¸ï¼šæœ‰ä¸¤ç§ç±»å‹çš„é—®ç­”ç³»ç»Ÿï¼šæå–å¼å’Œç”Ÿæˆå¼ã€‚æŠ½å–å¼ <code>QA</code> å¯ä»¥çœ‹ä½œæ˜¯æ–‡æœ¬åˆ†ç±»çš„ä¸€ä¸ªç‰¹ä¾‹ã€‚ç»™å®šä¸€ä¸ªé—®é¢˜å’Œä¸€ç»„å€™é€‰ç­”æ¡ˆï¼Œæ ¹æ®é—®é¢˜éœ€è¦å°†æ¯ä¸ªå€™é€‰ç­”æ¡ˆæ­£ç¡®åˆ†ç±»ã€‚</p></li><li><p>è‡ªç„¶è¯­è¨€æ¨ç†â­ï¸ï¼š<code>NLI</code>ï¼Œä¹Ÿç§°ä¸ºæ–‡æœ¬è•´å«è¯†åˆ«ï¼ˆ<code>RTE</code>ï¼‰ï¼Œé¢„æµ‹ä¸€ä¸ªæ–‡æœ¬çš„å«ä¹‰æ˜¯å¦å¯ä»¥ä»å¦ä¸€ä¸ªæ–‡æœ¬ä¸­æ¨æ–­å‡ºæ¥ã€‚ç‰¹åˆ«æ˜¯ï¼Œä¸€ä¸ªç³»ç»Ÿéœ€è¦ç»™æ¯å¯¹æ–‡æœ¬å•å…ƒåˆ†é…ä¸€ä¸ªæ ‡ç­¾ï¼Œæ¯”å¦‚è•´æ¶µã€çŸ›ç›¾å’Œä¸­ç«‹ã€‚</p></li></ul><h1 id="æ–‡æœ¬åˆ†ç±»çš„ä¸»è¦æ–¹æ³•"><a href="#æ–‡æœ¬åˆ†ç±»çš„ä¸»è¦æ–¹æ³•" class="headerlink" title="æ–‡æœ¬åˆ†ç±»çš„ä¸»è¦æ–¹æ³•"></a>æ–‡æœ¬åˆ†ç±»çš„ä¸»è¦æ–¹æ³•</h1><ul><li><p>åŸºäºè§„åˆ™ç‰¹å¾åŒ¹é…çš„æ–¹æ³•ï¼ˆå¦‚æ ¹æ®â€œå–œæ¬¢â€ï¼Œâ€œè®¨åŒâ€ç­‰ç‰¹æ®Šè¯æ¥è¯„åˆ¤æƒ…æ„Ÿï¼Œä½†å‡†ç¡®ç‡ä½ï¼Œé€šå¸¸ä½œä¸ºä¸€ç§è¾…åŠ©åˆ¤æ–­çš„æ–¹æ³•ï¼‰ã€‚</p></li><li><p>åŸºäºä¼ ç»Ÿæœºå™¨å­¦ä¹ çš„æ–¹æ³•ï¼ˆç‰¹å¾å·¥ç¨‹ + åˆ†ç±»ç®—æ³•ï¼‰ã€‚</p></li><li><p>åŸºäºæ·±åº¦å­¦ä¹ çš„æ–¹æ³•ï¼ˆè¯å‘é‡ + ç¥ç»ç½‘ç»œï¼‰ã€‚</p></li></ul><h1 id="GLUE-ä»»åŠ¡ä¸æ•°æ®é›†"><a href="#GLUE-ä»»åŠ¡ä¸æ•°æ®é›†" class="headerlink" title="GLUE ä»»åŠ¡ä¸æ•°æ®é›†"></a>GLUE ä»»åŠ¡ä¸æ•°æ®é›†</h1><p><code>GLUE</code> æ•°æ®é›†ï¼šé€šç”¨è¯­è¨€ç†è§£è¯„ä¼° <code>General language Understanding Evaluation: GLUE</code> åŸºå‡†æ˜¯ä¸€ç»„å„ç§ <code>NLP</code> æ–‡æœ¬ä»»åŠ¡ã€‚å¤§å¤šæ•° <code>GLUE</code> æ•°æ®é›†å·²ç»å­˜åœ¨å¤šå¹´ï¼Œè€Œ <code>GLUE</code> å°†å®ƒä»¬æ”¶é›†åœ¨ä¸€èµ·çš„ç›®çš„æ˜¯ï¼š</p><ul><li><p>ä¸ºè¿™äº›æ•°æ®é›†å»ºç«‹ç»Ÿä¸€çš„è®­ç»ƒé›†ã€éªŒè¯é›†ã€æµ‹è¯•é›†æ‹†åˆ†æ ‡å‡†ã€‚</p></li><li><p><code>GLUE</code> ä¸ç»™æµ‹è¯•é›†æ‰“æ ‡ç­¾ï¼Œç”¨æˆ·å¿…é¡»å°†æµ‹è¯•ç»“æœä¸Šä¼ åˆ° <code>GLUE</code> æœåŠ¡å™¨è¿›è¡Œè¯„ä¼°ï¼ˆä½†æ˜¯æäº¤æ¬¡æ•°æœ‰é™ï¼‰ã€‚</p></li></ul><p><code>GLUE</code> åŸºå‡†åŒ…å«ä»¥ä¸‹æ•°æ®é›†ï¼š</p><ul><li><p><code>Multi-Genre Natural Language Inference: MNLI</code>â­ï¸ï¼šå¤§è§„æ¨¡çš„ã€ä¼—åŒ…çš„è•´å«åˆ†ç±»ä»»åŠ¡ã€‚ç»™å®šä¸€å¯¹å¥å­ï¼Œå…¶ç›®æ ‡æ˜¯é¢„æµ‹ç¬¬äºŒå¥ç›¸å¯¹äºç¬¬ä¸€å¥æ˜¯è•´å«å¥ <code>entailment</code>ã€çŸ›ç›¾å¥ã€è¿˜æ˜¯ä¸­æ€§å¥ã€‚</p></li><li><p><code>Quora Question Pairs: QQP</code>â­ï¸ï¼šä¸€ä¸ªäºŒå…ƒåˆ†ç±»ä»»åŠ¡ã€‚ç»™å®šä¸€å¯¹ <code>Quora</code> ä¸Šçš„ä¸¤ä¸ªé—®é¢˜ï¼Œå…¶ç›®æ ‡æ˜¯é¢„æµ‹å®ƒä»¬åœ¨è¯­ä¹‰ä¸Šæ˜¯å¦ç­‰ä»·ã€‚</p></li><li><p><code>Question Natural Language Inference: QNLI</code>â­ï¸ï¼šæ–¯å¦ç¦   <code>Question Answering</code> æ•°æ®é›†çš„ä¸€ä¸ªè½¬æ¢ä¸ºåˆ†ç±»ä»»åŠ¡çš„ç‰ˆæœ¬ã€‚æ­£ç±»æ ·æœ¬ç”±é—®é¢˜å’Œæ­£ç¡®ç­”æ¡ˆç»„æˆï¼Œè´Ÿç±»æ ·æœ¬ç”±é—®é¢˜å’Œéæ­£ç¡®ç­”æ¡ˆç»„æˆï¼Œå…¶ä¸­éæ­£ç¡®ç­”æ¡ˆæ¥è‡ªäºåŒä¸€æ®µæ–‡æœ¬ã€‚</p></li><li><p><code>Stanford Sentiment Treebank: SST-2</code>â­ï¸ï¼šä¸€ä¸ªäºŒå…ƒå•å¥åˆ†ç±»ä»»åŠ¡ã€‚å…¶æ•°æ®é›†ä»ç”µå½±è¯„è®ºä¸­æå–çš„å¥å­ç»„æˆï¼Œç”±äººç±»å¯¹å…¶è¿›è¡ŒäºŒå…ƒæƒ…æ„Ÿæ ‡æ³¨ã€‚</p></li><li><p><code>Corpus of Linguistic Acceptability: CoLA</code>â­ï¸ï¼šä¸€ä¸ªäºŒå…ƒå•å¥åˆ†ç±»ä»»åŠ¡ã€‚å…¶ç›®æ ‡æ˜¯é¢„æµ‹ä¸€ä¸ªè‹±è¯­å¥å­æ˜¯å¦åœ¨è¯­æ³•ä¸Šå¯æ¥å—çš„ã€‚</p></li><li><p><code>Semantic Textual Similarity Benchmark: STS-B</code>â­ï¸ï¼šä¸€ä¸ªå¥å­ç›¸ä¼¼åº¦å¤šå…ƒåˆ†ç±»ä»»åŠ¡ã€‚å…¶æ•°æ®é›†ä»æ–°é—»æ ‡é¢˜å’Œå…¶å®ƒæ•°æ®æºæå–çš„å¥å­å¯¹ï¼Œé€šè¿‡äººå·¥æ¥æ ‡è®°ä¸€å¯¹å¥å­åœ¨è¯­ä¹‰ä¸Šçš„ç›¸ä¼¼å¾—åˆ†ï¼ˆ1åˆ†åˆ°5åˆ†ï¼‰ã€‚</p></li><li><p><code>Microsoft Research Paraphrase Corpus: MRPC</code>â­ï¸ï¼šä¸€ä¸ªå¥å­ç›¸ä¼¼åº¦äºŒå…ƒåˆ†ç±»ä»»åŠ¡ã€‚ä»åœ¨çº¿æ–°é—»æ•°æ®æºæŠ½å–çš„å¥å­å¯¹ï¼Œç”±äººå·¥æ ‡è®°ä¸€å¯¹å¥å­æ˜¯å¦è¯­ä¹‰ä¸Šç›¸ç­‰ã€‚</p></li><li><p><code>Recognizing Textual Entailment: RTE</code>â­ï¸ï¼šç±»ä¼¼ <code>MNLI</code> çš„äºŒå…ƒè•´å«å…³ç³»ä»»åŠ¡ï¼Œä½†æ˜¯ <code>RTE</code> æ•°æ®é›†è§„æ¨¡æ›´å°ã€‚</p></li></ul><h1 id="FastText-ğŸ˜Š"><a href="#FastText-ğŸ˜Š" class="headerlink" title="FastText ğŸ˜Š"></a>FastText ğŸ˜Š</h1><blockquote><p>è®ºæ–‡ï¼š<a href="https://arxiv.org/abs/1607.01759">https://arxiv.org/abs/1607.01759</a><br>ä»£ç ï¼š<a href="https://github.com/facebookresearch/fastText">https://github.com/facebookresearch/fastText</a></p></blockquote><p><code>FastText</code>æ˜¯ <code>Facebook</code> äº2016å¹´å¼€æºçš„ä¸€ä¸ªè¯å‘é‡è®¡ç®—å’Œæ–‡æœ¬åˆ†ç±»å·¥å…·ï¼Œåœ¨æ–‡æœ¬åˆ†ç±»ä»»åŠ¡ä¸­ï¼Œ<code>FastText</code>ï¼ˆæµ…å±‚ç½‘ç»œï¼‰å¾€å¾€èƒ½å–å¾—å’Œæ·±åº¦ç½‘ç»œç›¸åª²ç¾çš„ç²¾åº¦ï¼Œå´åœ¨è®­ç»ƒæ—¶é—´ä¸Šæ¯”æ·±åº¦ç½‘ç»œå¿«è®¸å¤šæ•°é‡çº§ã€‚</p><p><code>FastText</code>æ˜¯ä¸€ä¸ªå¿«é€Ÿæ–‡æœ¬åˆ†ç±»ç®—æ³•ï¼Œå…¶å…·æœ‰ä¸¤å¤§ä¼˜ç‚¹ï¼š</p><ul><li><p><code>FastText</code>åœ¨ä¿æŒé«˜ç²¾åº¦çš„æƒ…å†µä¸‹åŠ å¿«äº†è®­ç»ƒé€Ÿåº¦å’Œæµ‹è¯•é€Ÿåº¦</p></li><li><p><code>FastText</code>ä¸éœ€è¦é¢„è®­ç»ƒå¥½çš„è¯å‘é‡ï¼Œ<code>FastText</code>ä¼šè‡ªå·±è®­ç»ƒè¯å‘é‡</p></li><li><p><code>FastText</code>ä¸¤ä¸ªé‡è¦çš„ä¼˜åŒ–ï¼š<code>Hierarchical Softmax</code>ã€<code>N-gram</code></p></li></ul><h2 id="Word2Vec"><a href="#Word2Vec" class="headerlink" title="Word2Vec"></a>Word2Vec</h2><p>ğŸˆ åœ¨æˆ‘ä»¬æ·±å…¥ç ”ç©¶ <code>FastText</code> ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å¿«é€Ÿå›é¡¾ä¸€ä¸‹ <code>Word2Vec</code>æ˜¯ä»€ä¹ˆï¼Œé€šè¿‡ <code>Word2Vec</code>ï¼Œæˆ‘ä»¬è®­ç»ƒä¸€ä¸ªå…·æœ‰å•ä¸€éšè—å±‚çš„ç¥ç»ç½‘ç»œï¼Œæ ¹æ®å…¶ä¸Šä¸‹æ–‡ï¼ˆé‚»è¿‘çš„è¯ï¼‰é¢„æµ‹ç›®æ ‡è¯ã€‚æˆ‘ä»¬çš„å‡è®¾æ˜¯ï¼Œä¸€ä¸ªè¯çš„å«ä¹‰å¯ä»¥é€šè¿‡å®ƒå‘¨å›´å‡ºç°çš„è¯æ¥æ¨æ–­ã€‚å®é™…ä¸Šï¼Œåœ¨è®­ç»ƒæ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸¤ç§ä¸åŒçš„ç½‘ç»œæ¶æ„æ¥å®ç°: <code>CBOW</code> å’Œ <code>Skip-Gram</code>ã€‚</p><ul><li><code>Continuous Bag of Words</code>: æ ¹æ®èƒŒæ™¯è¯é¢„æµ‹ä¸­å¿ƒè¯ã€‚</li></ul><p><img src="https://amitness.com/images/nlp-ssl-center-word-prediction.gif" alt="image.png"></p><ul><li><code>Skip-Gram</code>: æ ¹æ®ä¸­å¿ƒè¯é¢„æµ‹èƒŒæ™¯è¯ã€‚</li></ul><p><img src="https://amitness.com/images/nlp-ssl-neighbor-word-prediction.gif" alt="image.png"></p><p>é€šè¿‡è¿™ç§æ–¹æ³•æ‰€å­¦åˆ°çš„è¯å‘é‡è¡¨å¾å…·æœ‰ä¸€äº›æœ‰è¶£çš„ç‰¹æ€§ï¼Œä¾‹å¦‚è¿™ä¸ªæµè¡Œçš„ä¾‹å­:</p><p><img src="https://amitness.com/images/word2vec-analogy.gif" alt="image.png"></p><p>ğŸˆ <u><code>word2vec</code> ä¸­æä¾›äº†ä¸¤ç§é’ˆå¯¹å¤§è§„æ¨¡å¤šåˆ†ç±»é—®é¢˜çš„ä¼˜åŒ–æ‰‹æ®µï¼Œ <code>Negative sampling</code> å’Œ <code>Hierarchical softmax</code>ã€‚</u></p><ul><li><p><code>Negative sampling</code> é€šè¿‡åªæ›´æ–°å°‘é‡è´Ÿç±»è¯çš„è¯å‘é‡ï¼Œä»è€Œå‡è½»äº†è®¡ç®—é‡ã€‚</p></li><li><p><code>Hierarchical softmax</code> å°†è¯åº“è¡¨ç¤ºæˆå‰ç¼€æ ‘ï¼Œä»æ ‘æ ¹åˆ°å¶å­çš„è·¯å¾„å¯ä»¥è¡¨ç¤ºä¸ºä¸€ç³»åˆ—äºŒåˆ†ç±»å™¨ï¼Œä¸€æ¬¡å¤šåˆ†ç±»è®¡ç®—çš„å¤æ‚åº¦ä» $|V|$ é™ä½åˆ°äº†æ ‘çš„é«˜åº¦ $log_2 |V|$ ã€‚</p></li></ul><p>ğŸˆ <code>FastText</code> çš„æ ¸å¿ƒæ€æƒ³å°±æ˜¯ï¼šå°†æ•´ç¯‡æ–‡æ¡£çš„è¯åŠ <code>n-gram</code> å‘é‡å åŠ å¹³å‡å¾—åˆ°æ–‡æ¡£å‘é‡ï¼Œç„¶åä½¿ç”¨æ–‡æ¡£å‘é‡åš <code>softmax</code> å¤šåˆ†ç±»ï¼Œå…¶æœ¬è´¨ä¸Šå°±æ˜¯ä¼ ç»Ÿçš„è¯è¢‹æ³•ï¼Œå³å°†æ–‡æ¡£çœ‹æˆä¸€ä¸ªç”±è¯æ„æˆçš„é›†åˆã€‚</p><p><img src="https://files.mdnice.com/user/11071/9d3b06dd-0cfa-4557-af5f-177589324304.png" alt=""></p><p>ğŸˆ <u>åŸºäºè¯è¢‹çš„æ–¹æ³•ä¸€ä¸ªæ˜æ˜¾çš„ç¼ºç‚¹æ˜¯ï¼š</u></p><blockquote><p>æˆ‘ä¸å–œæ¬¢è¿™ç±»ç”µå½±ï¼Œä½†æ˜¯å–œæ¬¢è¿™ä¸€ä¸ªã€‚</p><p>æˆ‘å–œæ¬¢è¿™ç±»ç”µå½±ï¼Œä½†æ˜¯ä¸å–œæ¬¢è¿™ä¸€ä¸ªã€‚</p></blockquote><p>è¿™æ ·çš„ä¸¤ä¸ªå¥å­ç»è¿‡è¯å‘é‡å¹³å‡ä»¥åå·²ç»é€å…¥å•å±‚ç¥ç»ç½‘ç»œçš„æ—¶å€™å·²ç»å®Œå…¨ä¸€æ¨¡ä¸€æ ·äº†ï¼Œåˆ†ç±»å™¨ä¸å¯èƒ½åˆ†è¾¨å‡ºè¿™ä¸¤å¥è¯çš„åŒºåˆ«ï¼Œåªæœ‰æ·»åŠ  <code>n-gram</code> ç‰¹å¾ä»¥åæ‰å¯èƒ½æœ‰åŒºåˆ«ã€‚å› æ­¤ï¼Œåœ¨å®é™…åº”ç”¨çš„æ—¶å€™éœ€è¦å¯¹æ•°æ®æœ‰è¶³å¤Ÿçš„äº†è§£,ç„¶åå†é€‰æ‹©æ¨¡å‹ã€‚</p><p>ğŸˆ å¯¹äºæ–‡æœ¬é•¿ä¸”å¯¹é€Ÿåº¦è¦æ±‚é«˜çš„åœºæ™¯ï¼Œ<code>Fasttext</code> æ˜¯ <code>Baseline</code> é¦–é€‰ã€‚åŒæ—¶ç”¨å®ƒåœ¨æ— ç›‘ç£è¯­æ–™ä¸Šè®­ç»ƒè¯å‘é‡ï¼Œè¿›è¡Œæ–‡æœ¬è¡¨ç¤ºä¹Ÿä¸é”™ã€‚ä¸è¿‡æƒ³ç»§ç»­æå‡æ•ˆæœè¿˜éœ€è¦æ›´å¤æ‚çš„æ¨¡å‹ã€‚</p><h2 id="æ¨¡å‹ç»“æ„å’Œä»£ç "><a href="#æ¨¡å‹ç»“æ„å’Œä»£ç " class="headerlink" title="æ¨¡å‹ç»“æ„å’Œä»£ç "></a>æ¨¡å‹ç»“æ„å’Œä»£ç </h2><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a1715764f473450e8234f27072bba684~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><ol><li><p>æ¨¡å‹è¾“å…¥ï¼š <code>[batch_size, seq_len]</code></p></li><li><p><code>embedding</code>å±‚ï¼šéšæœºåˆå§‹åŒ–, è¯å‘é‡ç»´åº¦ä¸º<code>embed_size</code>: <code>[batch_size, seq_len, embed_size]</code></p></li><li><p>æ±‚æ‰€æœ‰ <code>seq_len</code> ä¸ªè¯çš„å‡å€¼: <code>[batch_size, embed_size]</code></p></li><li><p>å…¨è¿æ¥ + <code>softmax</code>å½’ä¸€åŒ–: <code>[batch_size,num_class]</code></p></li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FastText</span>(<span class="params">nn.Module</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, config</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        config.vocab_sizeï¼šè¯è¡¨å¤§å°</span></span><br><span class="line"><span class="string">        config.embedding_sizeï¼šè¯å‘é‡ç»´åº¦</span></span><br><span class="line"><span class="string">        config.num_labels: ç±»åˆ«æ•°</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="built_in">super</span>(FastText, self).__init__()</span><br><span class="line">        self.embedding_size = config.embedding_size</span><br><span class="line">        self.embedding = nn.Embedding(config.vocab_size, config.embedding_size)</span><br><span class="line">        self.fc = nn.Linear(self.embedding_size, config.num_labels)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">forward</span>(<span class="params">self, input_ids</span>):</span></span><br><span class="line">        <span class="comment"># text = [batch size, sent len]</span></span><br><span class="line">        embedded = self.embedding(input_ids).<span class="built_in">float</span>()</span><br><span class="line">        <span class="comment"># embedded = [batch size, sent len, emb dim]</span></span><br><span class="line">        pooled = F.avg_pool2d(embedded, (embedded.shape[<span class="number">1</span>], <span class="number">1</span>)).squeeze(<span class="number">1</span>)</span><br><span class="line">        <span class="comment"># pooled = [batch size, embedding_dim]</span></span><br><span class="line">        <span class="keyword">return</span> self.fc(pooled), pooled</span><br></pre></td></tr></table></figure><h1 id="TextCNN-ğŸ˜Š"><a href="#TextCNN-ğŸ˜Š" class="headerlink" title="TextCNN ğŸ˜Š"></a>TextCNN ğŸ˜Š</h1><blockquote><p>è®ºæ–‡ï¼š<a href="https://arxiv.org/abs/1408.5882">https://arxiv.org/abs/1408.5882</a><br>ä»£ç ï¼š<a href="https://github.com/yoonkim/CNN_sentence">https://github.com/yoonkim/CNN_sentence</a></p></blockquote><p><code>TextCNN</code> æ˜¯ <code>Yoon Kim</code> åœ¨ 2014 å¹´æå‡ºçš„æ¨¡å‹ï¼Œå¼€åˆ›äº†ç”¨ <code>CNN</code> ç¼–ç  <code>n-gram</code> ç‰¹å¾çš„å…ˆæ²³ã€‚</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bccf33f717d742f5a3a28e378d1f3f97~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><p>è¯¦ç»†è¿‡ç¨‹ï¼š</p><ul><li><p><code>Embedding</code>ï¼šç¬¬ä¸€å±‚æ˜¯å›¾ä¸­æœ€å·¦è¾¹çš„ $5 \times 3$ çš„å¥å­çŸ©é˜µï¼Œæ¯è¡Œæ˜¯è¯å‘é‡ï¼Œç»´åº¦ä¸º $3$ï¼Œè¿™ä¸ªå¯ä»¥ç±»æ¯”ä¸ºå›¾åƒä¸­çš„åŸå§‹åƒç´ ç‚¹ã€‚</p></li><li><p><code>Convolution</code>ï¼šç„¶åç»è¿‡ <code>filter_sizes=(2,3,4)</code>çš„ä¸€ç»´å·ç§¯å±‚ï¼Œæ¯ä¸ª<code>filter_size</code> æœ‰ $2$ ä¸ªè¾“å‡º <code>channel</code>ã€‚</p></li><li><p><code>MaxPolling</code>ï¼šç¬¬ä¸‰å±‚æ˜¯ä¸€ä¸ª <code>1-max pooling</code> å±‚(å› ä¸ºæ˜¯æ—¶é—´ç»´åº¦çš„ï¼Œä¹Ÿç§° <code>max-over-time pooling</code>)ï¼Œè¿™æ ·ä¸åŒé•¿åº¦å¥å­ç»è¿‡ <code>pooling</code> å±‚ä¹‹åéƒ½èƒ½å˜æˆå®šé•¿çš„è¡¨ç¤ºã€‚</p></li><li><p><code>Full Connection and Softmax</code>ï¼šæœ€åæ¥ä¸€å±‚å…¨è¿æ¥çš„ <code>softmax</code> å±‚ï¼Œè¾“å‡ºæ¯ä¸ªç±»åˆ«çš„æ¦‚ç‡ã€‚</p></li></ul><p><u>åœ¨ <code>TextCNN</code> çš„å®è·µä¸­ï¼Œæœ‰å¾ˆå¤šåœ°æ–¹å¯ä»¥ä¼˜åŒ–ï¼š</u></p><ul><li><p><code>filter_sizes</code>ğŸ¤—ï¼šè¿™ä¸ªå‚æ•°å†³å®šäº†æŠ½å– <code>n-gram</code> ç‰¹å¾çš„é•¿åº¦ï¼Œè¿™ä¸ªå‚æ•°ä¸»è¦è·Ÿæ•°æ®æœ‰å…³ï¼Œå¹³å‡é•¿åº¦åœ¨ $50$ ä»¥å†…çš„è¯ï¼Œç”¨ $10$ ä»¥ä¸‹å°±å¯ä»¥äº†ï¼Œå¦åˆ™å¯ä»¥é•¿ä¸€äº›ã€‚åœ¨è°ƒå‚æ—¶å¯ä»¥å…ˆç”¨ä¸€ä¸ªå°ºå¯¸ <code>grid search</code>ï¼Œæ‰¾åˆ°ä¸€ä¸ªæœ€ä¼˜å°ºå¯¸ï¼Œç„¶åå°è¯•æœ€ä¼˜å°ºå¯¸å’Œé™„è¿‘å°ºå¯¸çš„ç»„åˆã€‚</p></li><li><p><code>n_filters</code>ğŸ¤—ï¼šè¿™ä¸ªå‚æ•°ä¼šå½±å“æœ€ç»ˆç‰¹å¾çš„ç»´åº¦ï¼Œç»´åº¦å¤ªå¤§çš„è¯è®­ç»ƒé€Ÿåº¦å°±ä¼šå˜æ…¢ã€‚è¿™é‡Œåœ¨ $100-600$ ä¹‹é—´è°ƒå‚å³å¯ã€‚</p></li><li><p><code>CNN</code>çš„æ¿€æ´»å‡½æ•°ğŸ¤—ï¼šå¯ä»¥å°è¯• <code>ReLU</code>ã€<code>tanh</code>ã€‚</p></li><li><p><code>Regularization</code>ğŸ¤—ï¼šæŒ‡å¯¹ <code>CNN</code> å‚æ•°çš„æ­£åˆ™åŒ–ï¼Œå¯ä»¥ä½¿ç”¨ <code>dropout</code> æˆ– <code>L2</code>ï¼Œä½†èƒ½èµ·çš„ä½œç”¨å¾ˆå°ï¼Œå¯ä»¥è¯•ä¸‹å°æ¦‚ç‡çš„ <code>dropout</code>ã€‚</p></li><li><p><code>Pooling</code>æ–¹æ³•ğŸ¤—ï¼šæ ¹æ®æƒ…å†µé€‰æ‹© <code>mean</code>ã€<code>max</code>ã€<code>k-max pooling</code>ï¼Œå¤§éƒ¨åˆ†æ—¶å€™ <code>max</code> è¡¨ç°å°±å¾ˆå¥½ï¼Œå› ä¸ºåˆ†ç±»ä»»åŠ¡å¯¹ç»†ç²’åº¦è¯­ä¹‰çš„è¦æ±‚ä¸é«˜ï¼ŒåªæŠ“ä½æœ€å¤§ç‰¹å¾å°±å¥½äº†ã€‚</p></li><li><p><code>Embedding</code>ğŸ¤—ï¼šä¸­æ–‡å¯ä»¥é€‰æ‹© <code>char</code> æˆ– <code>word</code> çº§åˆ«çš„è¾“å…¥ï¼Œä¹Ÿå¯ä»¥ä¸¤ç§éƒ½ç”¨ï¼Œä¼šæå‡äº›æ•ˆæœã€‚å¦‚æœè®­ç»ƒæ•°æ®å……è¶³ï¼ˆ$10w+$ï¼‰ï¼Œä¹Ÿå¯ä»¥ä»å¤´è®­ç»ƒã€‚</p></li></ul><blockquote><p><code>TextCNN</code> æ˜¯å¾ˆé€‚åˆ <strong>ä¸­çŸ­æ–‡æœ¬åœºæ™¯</strong> çš„å¼º <code>Baseline</code>ï¼Œä½† <strong>ä¸å¤ªé€‚åˆé•¿æ–‡æœ¬</strong>ï¼Œå› ä¸ºå·ç§¯æ ¸å°ºå¯¸é€šå¸¸ä¸ä¼šè®¾å¾ˆå¤§ï¼Œ<strong>æ— æ³•æ•è·é•¿è·ç¦»ç‰¹å¾</strong>ã€‚åŒæ—¶ <code>max-pooling</code> ä¹Ÿå­˜åœ¨å±€é™ï¼Œä¸¢å¤±äº†æ–‡æœ¬çš„ç»“æ„ä¿¡æ¯ï¼Œå› æ­¤å¾ˆéš¾å»å‘ç°æ–‡æœ¬ä¸­çš„è½¬æŠ˜å…³ç³»ç­‰å¤æ‚æ¨¡å¼ã€‚<code>TextCNN</code> å’Œä¼ ç»Ÿçš„ <code>n-gram</code> è¯è¢‹æ¨¡å‹æœ¬è´¨æ˜¯ä¸€æ ·çš„ï¼Œå®ƒçš„å¥½æ•ˆæœå¾ˆå¤§éƒ¨åˆ†æ¥è‡ªäºè¯å‘é‡çš„å¼•å…¥ï¼Œè§£å†³äº†è¯è¢‹æ¨¡å‹çš„ç¨€ç–æ€§é—®é¢˜ã€‚</p></blockquote><h3 id="æ¨¡å‹ç»“æ„å’Œä»£ç -1"><a href="#æ¨¡å‹ç»“æ„å’Œä»£ç -1" class="headerlink" title="æ¨¡å‹ç»“æ„å’Œä»£ç "></a>æ¨¡å‹ç»“æ„å’Œä»£ç </h3><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1f132345a36444b796b32fb04c7595f0~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TextCNN</span>(<span class="params">nn.Module</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, config</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        config.vocab_sizeï¼šè¯è¡¨å¤§å°</span></span><br><span class="line"><span class="string">        config.embedding_sizeï¼šè¯å‘é‡ç»´åº¦</span></span><br><span class="line"><span class="string">        config.num_labels: ç±»åˆ«æ•°</span></span><br><span class="line"><span class="string">        config.n_filters: å·ç§¯æ ¸ä¸ªæ•°ï¼ˆå¯¹åº”2ç»´å·ç§¯çš„é€šé“æ•°ï¼‰</span></span><br><span class="line"><span class="string">        config.filter_sizes: å·ç§¯æ ¸çš„å°ºå¯¸(3,4,5)</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="built_in">super</span>(TextCNN, self).__init__()</span><br><span class="line">        self.embedding_size = config.embedding_size</span><br><span class="line">        self.embedding = nn.Embedding(config.vocab_size, config.embedding_size)</span><br><span class="line">        self.convs = nn.ModuleList(</span><br><span class="line">            [nn.Conv2d(in_channels=<span class="number">1</span>, out_channels=config.n_filters, </span><br><span class="line">                       kernel_size=(fs, self.embedding_size)) <span class="keyword">for</span> fs <span class="keyword">in</span> config.filter_sizes])</span><br><span class="line">        self.fc = nn.Linear(<span class="built_in">len</span>(config.filter_sizes) * config.n_filters, config.num_labels)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">forward</span>(<span class="params">self, input_ids</span>):</span></span><br><span class="line">        <span class="comment"># text = [batch size, sent len]</span></span><br><span class="line">        embedded = self.embedding(input_ids)</span><br><span class="line">        <span class="comment"># embedded = [batch size, sent len, emb dim]</span></span><br><span class="line">        embedded = embedded.unsqueeze(<span class="number">1</span>).<span class="built_in">float</span>()</span><br><span class="line">        <span class="comment"># embedded = [batch size, 1, sent len, emb dim]</span></span><br><span class="line">        conved = [F.relu(conv(embedded)).squeeze(<span class="number">3</span>) <span class="keyword">for</span> conv <span class="keyword">in</span> self.convs]</span><br><span class="line">        <span class="comment"># conved_n = [batch size, n_filters, sent len - filter_sizes[n] + 1]</span></span><br><span class="line">        pooled = [F.max_pool1d(conv, <span class="built_in">int</span>(conv.shape[<span class="number">2</span>])).squeeze(<span class="number">2</span>) <span class="keyword">for</span> conv <span class="keyword">in</span> conved]</span><br><span class="line">        <span class="comment"># pooled_n = [batch size, n_filters]</span></span><br><span class="line">        cat = torch.cat(pooled, dim=<span class="number">1</span>)</span><br><span class="line">        <span class="comment"># cat = [batch size, n_filters * len(filter_sizes)]</span></span><br><span class="line">        <span class="keyword">return</span> self.fc(cat)</span><br></pre></td></tr></table></figure><h1 id="TextRNN-ğŸ˜Š"><a href="#TextRNN-ğŸ˜Š" class="headerlink" title="TextRNN ğŸ˜Š"></a>TextRNN ğŸ˜Š</h1><h2 id="RNN"><a href="#RNN" class="headerlink" title="RNN"></a>RNN</h2><p>å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆ<code>Recurrent Neural Networkï¼ŒRNN</code>ï¼‰æ˜¯ä¸€ç±»å…·æœ‰çŸ­æœŸè®°å¿†èƒ½åŠ›çš„ç¥ç»ç½‘ç»œã€‚åœ¨å¾ªç¯ç¥ç»ç½‘ç»œä¸­ï¼Œç¥ç»å…ƒä¸ä½†å¯ä»¥æ¥å—å…¶å®ƒç¥ç»å…ƒçš„ä¿¡æ¯ï¼Œä¹Ÿå¯ä»¥æ¥å—è‡ªèº«çš„ä¿¡æ¯ï¼Œå½¢æˆå…·æœ‰ç¯è·¯çš„ç½‘ç»œç»“æ„ã€‚</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d1da27ed23744731a09834126f1f983a~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><script type="math/tex; mode=display">H_t = Tanh([H_{t-1}, X_t]W+b)</script><h2 id="é•¿ç¨‹ä¾èµ–é—®é¢˜"><a href="#é•¿ç¨‹ä¾èµ–é—®é¢˜" class="headerlink" title="é•¿ç¨‹ä¾èµ–é—®é¢˜"></a>é•¿ç¨‹ä¾èµ–é—®é¢˜</h2><p>è™½ç„¶ç®€å•å¾ªç¯ç½‘ç»œç†è®ºä¸Šå¯ä»¥å»ºç«‹é•¿æ—¶é—´é—´éš”çš„çŠ¶æ€ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œä½†<br>æ˜¯ç”±äºæ¢¯åº¦çˆ†ç‚¸æˆ–æ¶ˆå¤±é—®é¢˜ï¼Œå®é™…ä¸Šåªèƒ½å­¦ä¹ åˆ°çŸ­æœŸçš„ä¾èµ–å…³ç³»ã€‚è¿™æ ·ï¼Œå¦‚æœæ—¶åˆ» $t$ çš„è¾“å‡º $y_t$ ä¾èµ–äºæ—¶åˆ» $k$ çš„è¾“å…¥ $x_k$ï¼Œå½“é—´éš” $tâˆ’k$ æ¯”è¾ƒå¤§æ—¶ï¼Œç®€å•ç¥ç»ç½‘ç»œå¾ˆéš¾å»ºæ¨¡è¿™ç§é•¿è·ç¦»çš„ä¾èµ–å…³ç³»ï¼Œç§°ä¸ºé•¿ç¨‹ä¾èµ–é—®é¢˜ï¼ˆ<code>Long-Term Dependencies Problem</code>ï¼‰ã€‚</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7e36102444c34a23a873c939ad0bfd91~tplv-k3u1fbpfcp-watermark.image" alt="RNN"></p><h2 id="LSTM"><a href="#LSTM" class="headerlink" title="LSTM"></a>LSTM</h2><p>ä¸ºäº†æ”¹å–„å¾ªç¯ç¥ç»ç½‘ç»œçš„é•¿ç¨‹ä¾èµ–é—®é¢˜ï¼Œä¸€ç§éå¸¸å¥½çš„è§£å†³æ–¹æ¡ˆæ˜¯å¼•å…¥é—¨æ§æœºåˆ¶æ¥æ§åˆ¶ä¿¡æ¯çš„ç´¯ç§¯é€Ÿåº¦ï¼ŒåŒ…æ‹¬æœ‰é€‰æ‹©åœ°åŠ å…¥æ–°çš„ä¿¡æ¯ï¼Œå¹¶æœ‰é€‰æ‹©åœ°é—å¿˜ä¹‹å‰ç´¯ç§¯çš„ä¿¡æ¯ã€‚</p><p>é•¿çŸ­æœŸè®°å¿†ï¼ˆ<code>Long Short-Term Memoryï¼ŒLSTM</code>ï¼‰ç½‘ç»œ[Gers ç­‰äºº; Hochreiterç­‰äººï¼Œ2000; 1997] æ˜¯å¾ªç¯ç¥ç»ç½‘ç»œçš„ä¸€ä¸ªå˜ä½“ï¼Œå¯ä»¥æœ‰æ•ˆåœ°è§£å†³ç®€å•å¾ªç¯ç¥ç»ç½‘ç»œçš„æ¢¯åº¦çˆ†ç‚¸æˆ–æ¶ˆå¤±é—®é¢˜ã€‚</p><blockquote><p><code>LSTM</code> çš„å…³é”®åœ¨äºç»†èƒçš„çŠ¶æ€ $C_t$ å’Œç©¿è¿‡ç»†èƒçš„çº¿ï¼Œç»†èƒçŠ¶æ€ç±»ä¼¼äºä¼ é€å¸¦ï¼Œç›´æ¥åœ¨æ•´ä¸ªé“¾ä¸Šè¿è¡Œï¼Œåªæœ‰ä¸€äº›å°‘é‡çš„çº¿æ€§äº¤äº’ï¼Œä¿¡æ¯åœ¨ä¸Šé¢æµåŠ¨ä¿æŒä¸å˜ä¼šå˜å¾—å®¹æ˜“ã€‚</p></blockquote><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/aa43fb1414de4a7e9f36021b7cf44137~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><p><code>LSTM</code> ç½‘ç»œå¼•å…¥é—¨æ§æœºåˆ¶ï¼ˆ<code>Gating Mechanism</code>ï¼‰æ¥æ§åˆ¶ä¿¡æ¯ä¼ é€’çš„è·¯å¾„ã€‚<code>LSTM</code>ç½‘ç»œä¸­çš„â€œé—¨â€æ˜¯ä¸€ç§â€œè½¯â€é—¨ï¼Œå–å€¼åœ¨ $(0, 1)$ ä¹‹é—´ï¼Œè¡¨ç¤ºä»¥ä¸€å®šçš„æ¯”ä¾‹è¿è¡Œä¿¡æ¯é€šè¿‡ã€‚</p><h3 id="é—å¿˜é—¨"><a href="#é—å¿˜é—¨" class="headerlink" title="é—å¿˜é—¨"></a>é—å¿˜é—¨</h3><p>é—å¿˜é—¨ $f_{t}$ æ§åˆ¶ä¸Šä¸€ä¸ªæ—¶åˆ»çš„å†…éƒ¨çŠ¶æ€ $c_{tâˆ’1}$ éœ€è¦é—å¿˜å¤šå°‘ä¿¡æ¯ã€‚</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9666f2ff6f5c42ffb44e2ac5ed05591e~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><h3 id="è¾“å…¥é—¨"><a href="#è¾“å…¥é—¨" class="headerlink" title="è¾“å…¥é—¨"></a>è¾“å…¥é—¨</h3><p>è¾“å…¥é—¨å†³å®šè®©å¤šå°‘æ–°çš„ä¿¡æ¯åŠ å…¥åˆ°å½“å‰çš„ $C_t$ ä¸­æ¥ã€‚å®ç°è¿™ä¸ªéœ€è¦ä¸¤ä¸ªæ­¥éª¤ï¼š</p><ol><li>é¦–å…ˆè®¡ç®—å‡ºè¾“å…¥é—¨ $i-t$ å’Œå€™é€‰è®°å¿†ç»†èƒçŠ¶æ€ã€‚</li></ol><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/409cd2537d404fe59c2786500c956d30~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><ol><li>ç»“åˆé—å¿˜é—¨ $f_t$ å’Œè¾“å…¥é—¨ $i_t$ æ¥æ›´æ–°è®°å¿†å•å…ƒ $C_t$</li></ol><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3ae335e67eb24ffda32bedcd1ca43485~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><h3 id="è¾“å‡ºé—¨"><a href="#è¾“å‡ºé—¨" class="headerlink" title="è¾“å‡ºé—¨"></a>è¾“å‡ºé—¨</h3><p>æœ€ç»ˆï¼Œæˆ‘ä»¬éœ€è¦ç¡®å®šè¾“å‡ºä»€ä¹ˆå€¼ï¼Œè¿™ä¸ªè¾“å‡ºå°†ä¼šåŸºäºæˆ‘ä»¬çš„ç»†èƒçš„çŠ¶æ€ï¼Œä½†æ˜¯ä¹Ÿæ˜¯ä¸€ä¸ªè¿‡æ»¤åçš„ç‰ˆæœ¬ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ä¸ª <code>sigmoid</code> å±‚æ¥ç¡®å®šç»†èƒçŠ¶æ€çš„å“ªäº›éƒ¨åˆ†å°†è¾“å‡ºå‡ºå»ã€‚æ¥ç€ï¼Œæˆ‘ä»¬æŠŠç»†èƒçŠ¶æ€é€šè¿‡ <code>tanh</code> è¿›è¡Œå¤„ç†ï¼ˆå¾—åˆ°ä¸€ä¸ª $[-1,1]$ ä¹‹é—´çš„å€¼ï¼‰å¹¶å°†å®ƒå’Œ<code>sigmoid</code> é—¨çš„è¾“å‡ºç›¸ä¹˜ã€‚</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/49e914d3e12a4a6ba6e4ef4aafc9e6a5~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><h2 id="GRU"><a href="#GRU" class="headerlink" title="GRU"></a>GRU</h2><p>åœ¨ <code>LSTM</code> ä¸­å¼•å…¥äº†ä¸‰ä¸ªé—¨å‡½æ•°ï¼šè¾“å…¥é—¨ã€é—å¿˜é—¨å’Œè¾“å‡ºé—¨æ¥æ§åˆ¶ä¿¡æ¯çš„ä¼ é€’ï¼Œç”±äºè¾“å…¥é—¨å’Œé—å¿˜é—¨æ˜¯äº’è¡¥å…³ç³»ï¼Œå…·æœ‰ä¸€å®šçš„å†—ä½™æ€§ï¼Œ<code>GRU</code> ç½‘ç»œ<br>ç›´æ¥ä½¿ç”¨ä¸€ä¸ªé—¨æ¥æ§åˆ¶è¾“å…¥å’Œé—å¿˜ä¹‹é—´çš„å¹³è¡¡ï¼Œåœ¨ <code>GRU</code> æ¨¡å‹ä¸­åªæœ‰ä¸¤ä¸ªé—¨ï¼šåˆ†åˆ«æ˜¯æ›´æ–°é—¨å’Œé‡ç½®é—¨ã€‚</p><p>å›¾ä¸­çš„ $z_{t}$ å’Œ $r_{t}$ åˆ†åˆ«è¡¨ç¤ºæ›´æ–°é—¨å’Œé‡ç½®é—¨ã€‚æ›´æ–°é—¨ç”¨äºæ§åˆ¶å‰ä¸€æ—¶åˆ»çš„çŠ¶æ€ä¿¡æ¯è¢«å¸¦å…¥åˆ°å½“å‰çŠ¶æ€ä¸­çš„ç¨‹åº¦ï¼Œæ›´æ–°é—¨çš„å€¼è¶Šå¤§è¯´æ˜å‰ä¸€æ—¶åˆ»çš„çŠ¶æ€ä¿¡æ¯å¸¦å…¥è¶Šå¤šã€‚é‡ç½®é—¨æ§åˆ¶å‰ä¸€çŠ¶æ€æœ‰å¤šå°‘ä¿¡æ¯è¢«å†™å…¥åˆ°å½“å‰çš„å€™é€‰çŠ¶æ€ $\tilde{h}_{t}$ ä¸Šï¼Œé‡ç½®é—¨è¶Šå°ï¼Œå‰ä¸€çŠ¶æ€çš„ä¿¡æ¯è¢«å†™å…¥çš„è¶Šå°‘ã€‚</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c35dd733ddbc4a51ab9693f35a476588~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><p><code>LSTM</code> å’Œ <code>GRU</code> éƒ½æ˜¯é€šè¿‡å„ç§é—¨å‡½æ•°æ¥å°†é‡è¦ç‰¹å¾ä¿ç•™ä¸‹æ¥ï¼Œè¿™æ ·å°±ä¿è¯äº†åœ¨ <code>long-term</code> ä¼ æ’­çš„æ—¶å€™ä¹Ÿä¸ä¼šä¸¢å¤±ã€‚æ­¤å¤– <code>GRU</code> ç›¸å¯¹äº <code>LSTM</code> å°‘äº†ä¸€ä¸ªé—¨å‡½æ•°ï¼Œå› æ­¤åœ¨å‚æ•°çš„æ•°é‡ä¸Šä¹Ÿæ˜¯è¦å°‘äº<code>LSTM</code> çš„ï¼Œæ‰€ä»¥æ•´ä½“ä¸Š <code>GRU</code> çš„è®­ç»ƒé€Ÿåº¦è¦å¿«äº <code>LSTM</code> çš„ã€‚</p><h2 id="Attention"><a href="#Attention" class="headerlink" title="Attention"></a>Attention</h2><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0c0b980f90654c2baf45c882a1331543~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><p><code>Attention</code> è®¡ç®—ï¼š</p><script type="math/tex; mode=display">M=tanh(H)</script><script type="math/tex; mode=display">\alpha = softmax(u^TM)</script><script type="math/tex; mode=display">rep = H \alpha^{T}</script><p>å…¶ä¸­ $H$ ä¸ºæ¯ä¸ªæ—¶åˆ»å¾—åˆ°çš„éšè—çŠ¶æ€ï¼Œ $u$ä¸º <code>context vector</code>ï¼Œéšæœºåˆå§‹åŒ–å¹¶éšç€è®­ç»ƒæ›´æ–°ï¼Œæœ€åå¾—åˆ°å¥å­è¡¨ç¤º $rep$ï¼Œå†è¿›è¡Œåˆ†ç±»ã€‚</p><h2 id="æ¨¡å‹ç»“æ„å’Œä»£ç -2"><a href="#æ¨¡å‹ç»“æ„å’Œä»£ç -2" class="headerlink" title="æ¨¡å‹ç»“æ„å’Œä»£ç "></a>æ¨¡å‹ç»“æ„å’Œä»£ç </h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RNNAttention</span>(<span class="params">nn.Module</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, config</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        config.vocab_sizeï¼šè¯è¡¨å¤§å°</span></span><br><span class="line"><span class="string">        config.embedding_sizeï¼šè¯å‘é‡ç»´åº¦</span></span><br><span class="line"><span class="string">        config.num_labels: ç±»åˆ«æ•°</span></span><br><span class="line"><span class="string">        config.hidden_dim: rnnéšè—å±‚çš„ç»´åº¦</span></span><br><span class="line"><span class="string">        config.n_layers: rnnå±‚æ•°</span></span><br><span class="line"><span class="string">        config.rnn_type: rnnç±»å‹ï¼ŒåŒ…æ‹¬[&#x27;lstm&#x27;, &#x27;gru&#x27;, &#x27;rnn&#x27;]</span></span><br><span class="line"><span class="string">        config.bidirectional: æ˜¯å¦åŒå‘</span></span><br><span class="line"><span class="string">        config.dropout: dropoutç‡</span></span><br><span class="line"><span class="string">        config.batch_first: ç¬¬ä¸€ä¸ªç»´åº¦æ˜¯å¦æ˜¯æ‰¹é‡å¤§å°</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="built_in">super</span>(RNNAttention, self).__init__()</span><br><span class="line">        self.embedding_size = config.embedding_size</span><br><span class="line">        self.embedding = nn.Embedding(config.vocab_size, config.embedding_size)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> config.rnn_type == <span class="string">&#x27;lstm&#x27;</span>:</span><br><span class="line">            self.rnn = nn.LSTM(self.embedding_size,</span><br><span class="line">                               config.hidden_dim,</span><br><span class="line">                               num_layers=config.n_layers,</span><br><span class="line">                               bidirectional=config.bidirectional,</span><br><span class="line">                               batch_first=config.batch_first,</span><br><span class="line">                               dropout=config.dropout)</span><br><span class="line">        <span class="keyword">elif</span> config.rnn_type == <span class="string">&#x27;gru&#x27;</span>:</span><br><span class="line">            self.rnn = nn.GRU(self.embedding_size,</span><br><span class="line">                              hidden_size=config.hidden_dim,</span><br><span class="line">                              num_layers=config.n_layers,</span><br><span class="line">                              bidirectional=config.bidirectional,</span><br><span class="line">                              batch_first=config.batch_first,</span><br><span class="line">                              dropout=config.dropout)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.rnn = nn.RNN(self.embedding_size,</span><br><span class="line">                              hidden_size=config.hidden_dim,</span><br><span class="line">                              num_layers=config.n_layers,</span><br><span class="line">                              bidirectional=config.bidirectional,</span><br><span class="line">                              batch_first=config.batch_first,</span><br><span class="line">                              dropout=config.dropout)</span><br><span class="line">        <span class="comment"># queryå‘é‡   </span></span><br><span class="line">        self.u = nn.Parameter(torch.randn(config.hidden_dim * <span class="number">2</span>), requires_grad=<span class="literal">True</span>)</span><br><span class="line">        self.tanh = nn.Tanh()</span><br><span class="line">        self.fc = nn.Linear(config.hidden_dim * <span class="number">2</span>, config.num_labels)</span><br><span class="line"></span><br><span class="line">        self.dropout = nn.Dropout(config.dropout)</span><br><span class="line">        self.batch_first = config.batch_first</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">forward</span>(<span class="params">self, text, text_lengths</span>):</span></span><br><span class="line">        <span class="comment"># æŒ‰ç…§å¥å­é•¿åº¦ä»å¤§åˆ°å°æ’åº</span></span><br><span class="line">        text, sorted_seq_lengths, desorted_indices = self.prepare_pack_padded_sequence(text, text_lengths)</span><br><span class="line">        <span class="comment"># text = [batch size, sent len]</span></span><br><span class="line">        embedded = self.dropout(self.embedding(text)).<span class="built_in">float</span>()</span><br><span class="line">        <span class="comment"># embedded = [batch size, sent len, emb dim]</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># pack sequence</span></span><br><span class="line">        packed_embedded = nn.utils.rnn.pack_padded_sequence(embedded, sorted_seq_lengths, batch_first=self.batch_first)</span><br><span class="line">        self.rnn.flatten_parameters()</span><br><span class="line">        <span class="keyword">if</span> config.rnn_type <span class="keyword">in</span> [<span class="string">&#x27;rnn&#x27;</span>, <span class="string">&#x27;gru&#x27;</span>]:</span><br><span class="line">            packed_output, hidden = self.rnn(packed_embedded)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># output (batch, seq_len, num_directions * hidden_dim)</span></span><br><span class="line">            <span class="comment"># hidden (batch, num_layers * num_directions, hidden_dim)</span></span><br><span class="line">            packed_output, (hidden, cell) = self.rnn(packed_embedded)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># unpack sequence</span></span><br><span class="line">        output, output_lengths = nn.utils.rnn.pad_packed_sequence(packed_output, batch_first=self.batch_first)</span><br><span class="line">        <span class="comment"># æŠŠå¥å­åºåˆ—å†è°ƒæ•´æˆè¾“å…¥æ—¶çš„é¡ºåº</span></span><br><span class="line">        output = output[desorted_indices]</span><br><span class="line">        <span class="comment"># output = [batch_size, seq_len, hidden_dim * num_directionns ]</span></span><br><span class="line"></span><br><span class="line">        alpha = F.softmax(torch.matmul(self.tanh(output), self.u), dim=<span class="number">1</span>).unsqueeze(-<span class="number">1</span>) </span><br><span class="line">        <span class="comment"># alpha = [batch_size, seq_len, 1]</span></span><br><span class="line">        output_attention = output * alpha <span class="comment"># [batch_size, seq_len, hidden_dim * num_directionns ]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        output_attention = torch.<span class="built_in">sum</span>(output_attention, dim=<span class="number">1</span>)  <span class="comment"># [batch_size, hidden_dim]</span></span><br><span class="line"></span><br><span class="line">        fc_input = self.dropout(output_attention)</span><br><span class="line">        out = self.fc(fc_input)</span><br><span class="line">        <span class="keyword">return</span> out, fc_input</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">prepare_pack_padded_sequence</span>(<span class="params">self, inputs_words, seq_lengths, descending=<span class="literal">True</span></span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        for rnn model ï¼šæŒ‰ç…§å¥å­é•¿åº¦ä»å¤§åˆ°å°æ’åº</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        sorted_seq_lengths, indices = torch.sort(seq_lengths, descending=descending)</span><br><span class="line">        _, desorted_indices = torch.sort(indices, descending=<span class="literal">False</span>)</span><br><span class="line">        sorted_inputs_words = inputs_words[indices]</span><br><span class="line">        <span class="keyword">return</span> sorted_inputs_words, sorted_seq_lengths, desorted_indices</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h1><ol><li><a href="https://arxiv.org/abs/1607.01759">https://arxiv.org/abs/1607.01759</a></li><li><a href="https://arxiv.org/abs/1408.5882">https://arxiv.org/abs/1408.5882</a></li><li><a href="https://ai.tencent.com/ailab/media/publications/ACL3-Brady.pdf">https://ai.tencent.com/ailab/media/publications/ACL3-Brady.pdf</a></li><li><a href="https://dl.acm.org/doi/10.5555/2886521.2886636">https://dl.acm.org/doi/10.5555/2886521.2886636</a></li><li><a href="https://www.aclweb.org/anthology/N16-1174.pdf">https://www.aclweb.org/anthology/N16-1174.pdf</a></li><li><a href="https://zhuanlan.zhihu.com/p/266364526">https://zhuanlan.zhihu.com/p/266364526</a></li><li><a href="https://cloud.tencent.com/developer/article/1389555">https://cloud.tencent.com/developer/article/1389555</a></li><li><a href="https://www.cnblogs.com/sandwichnlp/p/11698996.html">https://www.cnblogs.com/sandwichnlp/p/11698996.html</a></li><li><a href="https://github.com/jeffery0628/text_classification">https://github.com/jeffery0628/text_classification</a></li><li><a href="https://zhuanlan.zhihu.com/p/349086747">https://zhuanlan.zhihu.com/p/349086747</a></li><li><a href="https://zhuanlan.zhihu.com/p/35457093">https://zhuanlan.zhihu.com/p/35457093</a></li><li><a href="https://www.pianshen.com/article/4319299677/">https://www.pianshen.com/article/4319299677/</a></li><li><a href="https://www.zhihu.com/question/326770917/answer/698646465">https://www.zhihu.com/question/326770917/answer/698646465</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> è‡ªç„¶è¯­è¨€å¤„ç† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ–‡æœ¬åˆ†ç±» </tag>
            
            <tag> æ·±åº¦å­¦ä¹  </tag>
            
            <tag> æµ…å±‚æ¨¡å‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é›†æˆå­¦ä¹ ã€äºŒã€‘</title>
      <link href="/2021/07/22/ensemble2/"/>
      <url>/2021/07/22/ensemble2/</url>
      
        <content type="html"><![CDATA[<h1 id="éšæœºæ£®æ—"><a href="#éšæœºæ£®æ—" class="headerlink" title="éšæœºæ£®æ—"></a>éšæœºæ£®æ—</h1><p><img src="https://miro.medium.com/max/1204/1*iWHiPjPv0yj3RKaw0pJ7hA.png" alt=""></p><ol><li><p>éšæœºæ£®æ—ç®—æ³•èƒŒåçš„æ€æƒ³æ˜¯ç¾¤ä½“æ™ºæ…§çš„ä½“ç°ï¼Œå®ƒé€šè¿‡éšæœºçš„ <code>è¡Œé‡‡æ ·</code> å’Œ <code>åˆ—é‡‡æ ·</code> æ„é€ ä¸åŒçš„è®­ç»ƒé›†ï¼Œå»ºç«‹ä¸€ä¸ªå†³ç­–æ ‘æ£®æ—ï¼Œåˆ©ç”¨åŠ æƒå¹³å‡æ–¹å¼æˆ–å¤šæ•°è¡¨å†³çš„æ–¹å¼å¾—åˆ°æœ€åçš„é¢„æµ‹ç»“æœï¼Œèƒ½å¤Ÿå¹¶è¡Œå­¦ä¹ ï¼Œå¯¹å™ªå£°å’Œå¼‚å¸¸æ•°æ®å…·æœ‰å¾ˆå¥½çš„è¿‡æ»¤ä½œç”¨ï¼Œå› æ­¤æœ‰å¾ˆå¹¿æ³›çš„åº”ç”¨ã€‚</p></li><li><p>éšæœºæ£®æ—çš„ <code>è¡Œé‡‡æ ·</code> å’Œ <code>åˆ—é‡‡æ ·</code> éƒ½æ˜¯ä¸ºäº†å‡å°æ¨¡å‹ä¹‹é—´çš„ç›¸å…³æ€§ä½¿åŸºå­¦ä¹ å™¨å˜å¾—ä¸åŒä»è€Œå‡å°é›†æˆæ¨¡å‹çš„æ–¹å·®ã€‚è¿™ç§éšæœºæ€§ä¼šå¯¼è‡´éšæœºæ£®æ—çš„åå·®æœ‰æ‰€å¢åŠ ï¼ˆç›¸æ¯”äºå•æ£µå†³ç­–æ ‘ï¼‰ï¼Œå› æ­¤éšæœºæ£®æ—çš„å•æ£µæ ‘éƒ½ä¼šé‡‡ç”¨å¾ˆæ·±çš„å†³ç­–æ ‘ï¼Œå¹¶ä¸è¿›è¡Œå‰ªææ“ä½œï¼Œä»¥å‡å°æ¯æ£µæ ‘çš„åå·®ï¼Œè¿™ä½¿å¾—æ¯ä¸€æ£µå†³ç­–æ ‘å°±æ˜¯ä¸€ä¸ªç²¾é€šäºæŸä¸€ä¸ªçª„é¢†åŸŸçš„ä¸“å®¶ï¼ˆå› ä¸ºæˆ‘ä»¬ä»å…¨éƒ¨ç‰¹å¾ä¸­é€‰æ‹©éƒ¨åˆ†æ¥è®©æ¯ä¸€æ£µå†³ç­–æ ‘å­¦ä¹ ï¼‰ï¼Œè¿™æ ·åœ¨éšæœºæ£®æ—ä¸­å°±æœ‰äº†å¾ˆå¤šä¸ªç²¾é€šä¸åŒé¢†åŸŸçš„ä¸“å®¶ï¼Œå¯¹ä¸€ä¸ªæ–°çš„é—®é¢˜ï¼ˆæ–°çš„è¾“å…¥æ•°æ®ï¼‰ï¼Œå¯ä»¥ç”¨ä¸åŒçš„è§’åº¦å»çœ‹å¾…å®ƒï¼Œæœ€ç»ˆå†é€šè¿‡æŠ•ç¥¨æˆ–å¹³å‡å¾—åˆ°ç»“æœã€‚è¿™ä¹Ÿæ­£æ˜¯ç¾¤ä½“æ™ºæ…§çš„ä½“ç°ã€‚</p></li><li><p>éšæœºæ£®æ—æ˜¯ <code>Bagging</code> çš„ä¸€ç§æ‰©å±•å˜ä½“ï¼Œä¸ <code>Bagging</code> ç›¸æ¯”ï¼š</p><ul><li><p><code>Bagging</code> ä¸­åŸºå­¦ä¹ å™¨çš„ <code>å¤šæ ·æ€§</code> æ¥è‡ªäºæ ·æœ¬æ‰°åŠ¨ã€‚&gt; æ ·æœ¬æ‰°åŠ¨æ¥è‡ªäºå¯¹åˆå§‹è®­ç»ƒé›†çš„éšæœºé‡‡æ ·ã€‚</p></li><li><p>éšæœºæ£®æ—ä¸­çš„åŸºå­¦ä¹ å™¨çš„å¤šæ ·æ€§ä¸ä»…æ¥è‡ªæ ·æœ¬æ‰°åŠ¨ï¼Œè¿˜æ¥è‡ªå±æ€§æ‰°åŠ¨ã€‚</p></li><li><p>ä¼ ç»Ÿå†³ç­–æ ‘åœ¨é€‰æ‹©åˆ’åˆ†å±æ€§æ—¶ï¼Œæ˜¯åœ¨å½“å‰ç»“ç‚¹çš„å±æ€§é›†åˆï¼ˆå‡å®šæœ‰ $n$ ä¸ªå±æ€§ï¼‰ä¸­é€‰æ‹©ä¸€ä¸ªæœ€ä¼˜å±æ€§ã€‚</p></li><li><p>éšæœºæ£®æ—ä¸­ï¼Œå¯¹åŸºå†³ç­–æ ‘çš„æ¯ä¸ªç»“ç‚¹ï¼Œå…ˆä»è¯¥ç»“ç‚¹çš„å±æ€§é›†åˆä¸­éšæœºé€‰æ‹©ä¸€ä¸ªåŒ…å« $k$ ä¸ªå±æ€§çš„å­é›†ï¼Œç„¶åå†ä»è¿™ä¸ªå­é›†ä¸­é€‰æ‹©ä¸€ä¸ªæœ€ä¼˜å±æ€§ç”¨äºåˆ’åˆ†ã€‚ï¼ˆé€šå¸¸å»ºè®® $k=log_2n$ï¼‰</p></li></ul></li></ol><p><strong>è¿™ä½¿å¾—æœ€ç»ˆé›†æˆçš„æ³›åŒ–æ€§èƒ½å¯ä»¥é€šè¿‡ä¸ªä½“å­¦ä¹ å™¨ä¹‹é—´å·®å¼‚åº¦çš„å¢åŠ è€Œè¿›ä¸€æ­¥æå‡ã€‚</strong></p><ol><li><code>Extra Tree</code></li></ol><p><code>Extra Tree</code>ä¸<code>Random Forest</code>çš„ååˆ†ç›¸ä¼¼ï¼Œå…¶ä¸»è¦åŒºåˆ«å¦‚ä¸‹ï¼š</p><ul><li><p><code>RF</code>ä¼šéšæœºé‡‡æ ·æ¥ä½œä¸ºå­å†³ç­–æ ‘çš„è®­ç»ƒé›†ï¼Œè€Œ<code>Extra Tree</code>æ¯ä¸ªå­å†³ç­–æ ‘é‡‡ç”¨åŸå§‹æ•°æ®é›†è®­ç»ƒã€‚</p></li><li><p><code>RF</code>åœ¨é€‰æ‹©åˆ’åˆ†ç‰¹å¾çš„é˜ˆå€¼æ—¶ä¼šå’Œä¼ ç»Ÿå†³ç­–æ ‘ä¸€æ ·ï¼ŒåŸºäºä¿¡æ¯å¢ç›Šã€ä¿¡æ¯å¢ç›Šç‡ã€åŸºå°¼ç³»æ•°ã€å‡æ–¹å·®ç­‰åŸåˆ™æ¥é€‰æ‹©æœ€ä¼˜&gt; çš„<code>threshold</code>ã€‚<code>Extra Tree</code>åˆ™æ˜¯éšæœºé€‰æ‹©<code>threshold</code>æ¥åˆ’åˆ†å†³ç­–æ ‘ã€‚</p></li></ul><blockquote><p>ç”±äº<code>Extra Tree</code>æ˜¯éšæœºé€‰æ‹©ç‰¹å¾ç‚¹è¿›è¡Œåˆ’åˆ†ï¼Œæ‰€ä»¥æœ€åå¾—åˆ°çš„å†³ç­–æ ‘è§„æ¨¡ä¼šå¤§äº<code>RF</code>ç”Ÿæˆçš„å†³ç­–æ ‘ï¼Œ<code>Extra Tree</code>å†³ç­–æ ‘çš„åå·®æ›´å¤§ï¼Œä½†æ–¹å·®ä¼šå‡å°‘ï¼Œæ³›åŒ–èƒ½åŠ›æ¯”<code>RF</code>æ›´å¼ºã€‚</p></blockquote><h1 id="AdaBoost"><a href="#AdaBoost" class="headerlink" title="AdaBoost"></a>AdaBoost</h1><ol><li><p><code>AdaBoost</code> æ˜¯åŸºäº <code>Boosting</code> çš„æ€æƒ³ï¼Œé€šè¿‡å¤šä¸ªå¼±åˆ†ç±»å™¨çš„çº¿æ€§ç»„åˆæ¥å¾—åˆ°å¼ºåˆ†ç±»å™¨ï¼Œè®­ç»ƒæ—¶é‡ç‚¹å…³æ³¨è¢«é”™åˆ†çš„æ ·æœ¬ï¼Œå‡†ç¡®ç‡é«˜çš„å¼±åˆ†ç±»å™¨æƒé‡å¤§ã€‚</p></li><li><p>åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œå®ƒä¸æ”¹å˜æ‰€ç»™çš„è®­ç»ƒæ•°æ®ï¼Œè€Œæ˜¯ä¸æ–­æ”¹å˜è®­ç»ƒæ•°æ®æƒå€¼çš„åˆ†å¸ƒï¼Œä½¿å¾—è¢«è¯¯åˆ†ç±»çš„æ•°æ®å†åä¸€è½®çš„åˆ†ç±»ä¸­å—åˆ°æ›´å¤§çš„å…³æ³¨ã€‚</p></li><li><p>é‡‡ç”¨åŠ æƒå¤šæ•°è¡¨å†³çš„æ–¹æ³•ï¼ŒåŠ å¤§åˆ†ç±»è¯¯å·®ç‡å°çš„å¼±åˆ†ç±»å™¨çš„æƒå€¼ï¼Œä½¿å…¶åœ¨æœ€åçš„è¡¨å†³ä¸­èµ·æ›´å¤§çš„ä½œç”¨ï¼Œå‡å°åˆ†ç±»è¯¯å·®ç‡å¤§çš„å¼±åˆ†ç±»å™¨çš„æƒå€¼ï¼Œä½¿å…¶åœ¨æœ€åçš„è¡¨å†³ä¸­èµ·è¾ƒå°çš„ä½œç”¨ã€‚æ‰€æœ‰å¼±åˆ†ç±»å™¨çš„æƒå€¼ä¹‹å’Œå¹¶ä¸ä¸º $1$ï¼Œæ˜¯é€šè¿‡æœ€åç»“æœçš„ç¬¦å·æ¥å†³å®šå®ä¾‹çš„ç±»åˆ«ï¼Œè¯¥ç»“æœçš„ç»å¯¹å€¼è¡¨ç¤ºåˆ†ç±»çš„ç¡®ä¿¡åº¦ã€‚</p></li></ol><center><img src="./../img/adaboost1.png"> </center><center><img src="./../img/adaboost1.png"> </center><blockquote><p><code>Adaboost</code> è¿˜æœ‰å¦å¤–ä¸€ç§ç†è§£ï¼Œå³å¯ä»¥è®¤ä¸ºå…¶æ¨¡å‹æ˜¯åŠ æ³•æ¨¡å‹ã€æŸå¤±å‡½æ•°ä¸ºæŒ‡æ•°å‡½æ•°ã€å­¦ä¹ ç®—æ³•ä¸ºå‰å‘åˆ†æ­¥ç®—æ³•çš„äºŒç±»åˆ†ç±»å­¦ä¹ æ–¹æ³•ã€‚</p><p>åŠ æ³•æ¨¡å‹ï¼šå¤šä¸ªåŸºå‡½æ•°çº¿æ€§ç»„åˆå¾—åˆ°çš„æ¨¡å‹</p><p>å‰å‘åˆ†æ­¥ç®—æ³•ï¼šå¯¹äºåŠ æ³•æ¨¡å‹ï¼Œä»å‰å¾€åï¼Œæ¯ä¸€æ­¥åªå­¦ä¹ ä¸€ä¸ªåŸºå‡½æ•°åŠå…¶ç³»æ•°ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡æ€§å­¦ä¹ æ‰€æœ‰çš„åŸºå‡½æ•°ï¼Œä»è€Œç®€åŒ–ä¼˜åŒ–çš„å¤æ‚åº¦ã€‚</p></blockquote><h2 id="ç®—æ³•æ­¥éª¤"><a href="#ç®—æ³•æ­¥éª¤" class="headerlink" title="ç®—æ³•æ­¥éª¤"></a>ç®—æ³•æ­¥éª¤</h2><p>è€ƒè™‘å¦‚ä¸‹å½¢å¼çš„äºŒåˆ†ç±»è®­ç»ƒé›†ï¼š</p><script type="math/tex; mode=display">(x^{(1)}, y^{(1)}), (x^{(2)}, y^{(2)}), \dots, (x^{(N)}, y^{(N)})</script><p>å…¶ä¸­ $x^{(i)}\in R^d$ ä¸ºç¬¬ $i$ ä¸ªæ ·æœ¬çš„ç‰¹å¾å‘é‡ï¼Œ$y^{(i)}\in -1, +1$</p><p><code>AdaBoost</code>ç®—æ³•çš„æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li>åˆå§‹åŒ–æ ·æœ¬æƒé‡:</li></ol><script type="math/tex; mode=display">D_1=(w_{1,1}, w_{1,2}, \dots, w_{1,N}), w_{1,k}=\frac{1}{N},k=1,2,\dots,N</script><ol><li><p>å¯¹ $m=1,2,\dots,M$ï¼Œé‡å¤ä»¥ä¸‹æ“ä½œï¼Œå¾—åˆ° $M$ ä¸ªå­¦ä¹ å™¨ï¼š</p><p> ï¼ˆ1ï¼‰ æŒ‰ç…§æ ·æœ¬æƒé‡åˆ†å¸ƒ $D_m$ åœ¨è®­ç»ƒé›†ä¸Šå¾—åˆ°ç¬¬ $m$ ä¸ªåŸºå­¦ä¹ å™¨ $G_m(x)$</p><script type="math/tex; mode=display">G_m(x):map(R^d) ~ to ~ {-1, +1}</script><p> ï¼ˆ2ï¼‰ è®¡ç®— $G_m(x)$ åœ¨è®­ç»ƒé›†ä¸Šçš„åŠ æƒåˆ†ç±»è¯¯å·®ç‡ï¼š</p><script type="math/tex; mode=display">e_m=\sum_{i=1}^{N}w_{m,i}I(G_m(x^{(i)}) \not= y^{(i)}) \tag{1}</script><p> ï¼ˆ3ï¼‰ è®¡ç®— $G_m(x)$ çš„ç³»æ•°ï¼š</p><script type="math/tex; mode=display">\alpha_m=\frac{1}{2}log(\frac{1-e_m}{e_m}) \tag{2}</script><p> ï¼ˆ4ï¼‰æ›´æ–°æ ·æœ¬æƒé‡ $D_{m+1}$:</p><script type="math/tex; mode=display">D_{m+1}=(w_{m+1,1}, w_{m+1,2}, \dots, w_{m+1,N})</script><script type="math/tex; mode=display">w_{m+1,i}=\frac{w_{m,i}exp(-\alpha_my^{(i)}G_m(x^{(i)})}{Z_m} \tag{3}</script><p> å…¶ä¸­ $Z_m$ ä¸ºå½’ä¸€åŒ–å› å­ï¼š$Z_m=\sum_{i=1}^{N}w_{m,i}exp(-\alpha_my^{(i)}G_m(x^{(i)})$</p></li><li><p>æ„å»ºæœ€ç»ˆçš„åˆ†ç±»å™¨çš„çº¿æ€§ç»„åˆï¼š</p></li></ol><script type="math/tex; mode=display">f(x)=\sum_{m=1}^{M}\alpha_mG_m(x)\tag{4}</script><ol><li>æœ€ç»ˆç”¨äºå†³ç­–çš„åˆ†ç±»å™¨ä¸ºï¼š</li></ol><script type="math/tex; mode=display">G(x)=sign(f(x))=sign(\sum_{m=1}^{M}\alpha_mG_m(x)) \tag{5}</script><h2 id="AdaBoostç®—æ³•çš„è§£é‡Š"><a href="#AdaBoostç®—æ³•çš„è§£é‡Š" class="headerlink" title="AdaBoostç®—æ³•çš„è§£é‡Š"></a><code>AdaBoost</code>ç®—æ³•çš„è§£é‡Š</h2><p>ä»ç†è®ºä¸Šè§£é‡Š <code>AdaBoost</code> ç®—æ³•è®¾ç½®æ ·æœ¬æƒé‡ $w_{m,i}$ å’Œåˆ†ç±»å™¨æƒé‡ $\alpha_m$ çš„åŸå› ã€‚</p><h3 id="å‰å‘åˆ†æ­¥ç®—æ³•"><a href="#å‰å‘åˆ†æ­¥ç®—æ³•" class="headerlink" title="å‰å‘åˆ†æ­¥ç®—æ³•"></a>å‰å‘åˆ†æ­¥ç®—æ³•</h3><p><code>AdaBoost</code> ç®—æ³•çš„æœ€ç»ˆæ¨¡å‹çš„è¡¨è¾¾å¼ä¸ºï¼š</p><script type="math/tex; mode=display">f(x)=\sum_{m=1}^{M}\alpha_mG_m(x)</script><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™æ˜¯ä¸€ä¸ªâ€œåŠ æ€§æ¨¡å‹â€ï¼Œæˆ‘ä»¬å¸Œæœ›è¿™ä¸ªæ¨¡å‹åœ¨è®­ç»ƒé›†ä¸Šçš„ç»éªŒè¯¯å·®æœ€å°ï¼Œå³ï¼š</p><script type="math/tex; mode=display">min\sum_{i=1}^{N}\ell(y^{(i)},f(x^{(i)})) \tag{6}</script><p>é€šå¸¸è¿™æ˜¯ä¸€ä¸ªå¤æ‚çš„ä¼˜åŒ–é—®é¢˜ã€‚å‰å‘åˆ†æ­¥ç®—æ³•æ±‚è§£è¿™ä¸€ä¼˜åŒ–é—®é¢˜çš„åŸºæœ¬æ€è·¯ä¸ºï¼šå¦‚æœä»å‰å¾€åï¼Œæ¯ä¸€æ­¥åªå­¦ä¹ ä¸€ä¸ªåŸºå­¦ä¹ å™¨<br>$G_m(x)$ åŠå…¶æƒé‡$\alpha_m$ï¼Œä¸æ–­è¿­ä»£å¾—åˆ°æœ€ç»ˆçš„æ¨¡å‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç®€åŒ–é—®é¢˜çš„å¤æ‚åº¦ã€‚</p><p>å…·ä½“çš„ï¼Œå½“æˆ‘ä»¬ç»è¿‡ $m-1$ è½®è¿­ä»£å¾—åˆ°æœ€ä¼˜æ¨¡å‹ $f_{m-1}(x)$ æ—¶ï¼Œå› ä¸ºï¼š</p><script type="math/tex; mode=display">f_m(x)=f_{m-1}(x)+\alpha_mG_m(x)\tag{7}</script><p>æ­¤æ—¶ï¼Œä¼˜åŒ–ç›®æ ‡ä¸ºï¼š</p><script type="math/tex; mode=display">min\sum_{i=1}^{N}\ell(y^{(i)},f_{m-1}(x^{(i)})+\alpha_mG_m(x^{(i)}))\tag{8}</script><h3 id="ç®—æ³•è¯æ˜"><a href="#ç®—æ³•è¯æ˜" class="headerlink" title="ç®—æ³•è¯æ˜"></a>ç®—æ³•è¯æ˜</h3><p>ä¸‹é¢è¯æ˜å½“æŸå¤±å‡½æ•°ä¸ºæŒ‡æ•°æŸå¤±å‡½æ•°æ—¶ï¼Œä¸Šè¿°åŠ æ€§æ¨¡å‹çš„å­¦ä¹ æ­¥éª¤å¦‚ä¸Šæ‰€ç¤ºã€‚</p><p>æŒ‡æ•°æŸå¤±å‡½æ•°ï¼š</p><script type="math/tex; mode=display">\ell(y,f(x))=exp(-yf(x)) \tag{9}</script><blockquote><p>å¯ä»¥è¯æ˜ï¼ŒæŒ‡æ•°æŸå¤±æ—¶åˆ†ç±»ä»»åŠ¡0/1æŸå¤±å‡½æ•°çš„ä¸€è‡´æ›¿ä»£æŸå¤±å‡½æ•°ã€‚ç”±äºæŒ‡æ•°æŸå¤±å‡½æ•°æœ‰æ›´å¥½çš„æ•°å­¦æ€§è´¨ï¼Œä¾‹å¦‚å¤„å¤„å¯å¾®ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨å®ƒæ›¿ä»£0/1æŸå¤±ä½œä¸ºä¼˜åŒ–ç›®æ ‡ã€‚</p></blockquote><p>å°†æŸå¤±å‡½æ•°ä»£å…¥ $(8)$ å¼ï¼Œåˆ™ä¼˜åŒ–ç›®æ ‡ä¸ºï¼š</p><script type="math/tex; mode=display">\underset{\alpha_m,~G_m(x)}{argmin}\sum_{i=1}^{N}exp[-y^{(i)}(f_{m-1}(x^{(i)})+\alpha_mG_m(x^{(i)}))] \tag{10}</script><p>ç”±äº $y^{(i)}f_{m-1}(x^{(i)})$ ä¸ä¼˜åŒ–çš„å˜é‡æ— å…³ï¼Œå¦‚æœä»¤ï¼š</p><script type="math/tex; mode=display">w_{m,i}=exp(-y^{(i)}f_{m-1}(x^{(i)})) \tag{11}</script><p>åˆ™ $(10)$ ç­‰ä»·äºï¼š</p><script type="math/tex; mode=display">\underset{\alpha_m,~G_m(x)}{argmin}\sum_{i=1}^{N}w_{m,i}exp(-y^{(i)}\alpha_mG_m(x^{(i)})) \tag{12}</script><blockquote><p>è¿™é‡Œçš„ $w_{m,i}$ å…¶å®ä¸ç®—æ³•æ˜¯ä¸€è‡´çš„ã€‚</p></blockquote><p>æˆ‘ä»¬åˆ†ä¸¤æ­¥æ¥æ±‚è§£ $(12)$ æ‰€ç¤ºçš„ä¼˜åŒ–é—®é¢˜çš„æœ€ä¼˜è§£ $\alpha_m$ å’Œ $G_m(x)$ï¼š</p><ol><li>$\forall \alpha_m \gt 0$ æ±‚ $\hat{G_m(x)}$:</li></ol><script type="math/tex; mode=display">\hat{G_m(x)}=\underset{G_m(x)}{argmin}\sum_{i=1}^{N}w_{m,i}I(G_m(x^{(i)})\not =y^{(i)}) \tag{13}</script><ol><li>æ±‚è§£ $\hat{\alpha_m}$ï¼š</li></ol><script type="math/tex; mode=display">\begin{aligned}\sum_{i=1}^{N}w_{m,i}exp(-y^{(i)}\alpha_mG_m(x^{(i)}))&=exp(-\alpha_m)\sum_{i=1}^{N}w_{m,i}I(G_m(x^{(i)})=y^{(i)}) \\&+ exp(\alpha_m)\sum_{i=1}^{N}w_{m,i}I(G_m(x^{(i)})\not =y^{(i)}) \\&=[exp(\alpha_m)-exp(-\alpha_m)]\sum_{i=1}^{N}w_{m,i}I(G_m(x^{(i)})\not =y^{(i)}) \\&+ exp(-\alpha_m)\sum_{i=1}^{N}w_{m,i}\end{aligned}</script><p>å¯¹ä¸Šå¼å…³äº $\alpha_m$ æ±‚å¯¼å¹¶ä»¤å…¶ä¸º $0$:</p><script type="math/tex; mode=display">[exp(\alpha_m)+exp(-\alpha_m)]\sum_{i=1}^{N}w_{m,i}I(G_m(x^{(i)})\not =y^{(i)})-exp(-\alpha_m)\sum_{i=1}^{N}w_{m,i}=0 \tag{15}</script><p>è§£å¾—ï¼š</p><script type="math/tex; mode=display">\hat{\alpha_m}=\frac{1}{2}log(\frac{1-e_m}{e_m}) \tag{16}</script><p>å…¶ä¸­ $e_m$ ä¸ºåŠ æƒè¯¯å·®ç‡ï¼š</p><script type="math/tex; mode=display">e_m=\frac{\sum_{i=1}^{N}w_{m,i}I(G_m(x^{(i)}) \not= y^{(i)})}{\sum_{i=1}^{N}w_{m,i}} \tag{17}</script><p>å¯è§ï¼Œåªéœ€å°†æƒé‡è¿›è¡Œå½’ä¸€åŒ–ï¼Œä¾¿å¾—åˆ° <code>AdaBoost</code> ç®—æ³•ä¸­çš„åŠ æƒè¯¯å·®ç‡</p><ol><li>æœ€åæ¥çœ‹çœ‹æ¯ä¸€è½®æ ·æœ¬æƒå€¼çš„æ›´æ–°ï¼š</li></ol><script type="math/tex; mode=display">\begin{aligned}w_{m+1,i}=exp(-y^{(i)}f_m(x^{(i)}))&=exp(-y^{(i)}[f_{m-1}(x^{(i)})+\alpha_mG_m(x^{(i)})]) \\&=w_{m,i}exp(-y^{(i)}\alpha_mG_m(x^{(i)})) \end{aligned}</script><blockquote><p>å°†æƒé‡è¿›è¡Œå½’ä¸€åŒ–ï¼Œä¾¿å¾—åˆ° <code>AdaBoost</code> ç®—æ³•ä¸­çš„æƒé‡æ›´æ–°å…¬å¼</p></blockquote><ol><li>ä¸ºé˜²æ­¢è¿‡æ‹Ÿåˆï¼Œ<code>AdaBoost</code> é€šå¸¸ä¼šåŠ å…¥æ­£åˆ™åŒ–é¡¹ã€‚è¯¥æ­£åˆ™åŒ–é¡¹ç§°ä½œæ­¥é•¿æˆ–è€…å­¦ä¹ ç‡ï¼Œå®šä¹‰ä¸º $\eta$ï¼Œæ­¤æ—¶æ¨¡å‹çš„æ›´æ–°ä¸º:</li></ol><script type="math/tex; mode=display">f_m(x)=f_{m-1}(x)+\eta\alpha_mG_m(x) \tag{19}</script><h1 id="GBDT"><a href="#GBDT" class="headerlink" title="GBDT"></a>GBDT</h1><p><code>GBDT</code> æ˜¯åŸºäº <code>Boosting</code> çš„æ€æƒ³ï¼Œä¸²è¡Œåœ°æ„é€ å¤šæ£µå†³ç­–æ ‘æ¥è¿›è¡Œæ•°æ®çš„é¢„æµ‹ï¼Œå®ƒæ˜¯<strong>åœ¨æŸå¤±å‡½æ•°æ‰€åœ¨çš„å‡½æ•°ç©ºé—´ä¸­åšæ¢¯åº¦ä¸‹é™ï¼Œå³æŠŠå¾…æ±‚çš„å†³ç­–æ ‘æ¨¡å‹å½“ä½œå‚æ•°ï¼Œæ¯è½®è¿­ä»£éƒ½å»æ‹ŸåˆæŸå¤±å‡½æ•°åœ¨å½“å‰æ¨¡å‹ä¸‹çš„è´Ÿæ¢¯åº¦</strong>ï¼Œä»è€Œä½¿å¾—å‚æ•°æœç€æœ€å°åŒ–æŸå¤±å‡½æ•°çš„æ–¹å‘æ›´æ–°ã€‚</p><blockquote><p><code>GBDT</code> å¯ä»¥çœ‹ä½œæ˜¯ <code>AdaBoost</code> çš„ä¸€ä¸ªæ¨å¹¿ï¼Œ<code>AdaBoost</code> æ˜¯é€šè¿‡é”™åˆ†æ•°æ®ç‚¹æ¥è¯†åˆ«é—®é¢˜ï¼Œé€šè¿‡è°ƒæ•´é”™åˆ†æ•°æ®ç‚¹çš„æƒé‡æ¥æ”¹è¿›æ¨¡å‹ï¼Œ<code>GBDT</code> æ˜¯é€šè¿‡è´Ÿæ¢¯åº¦æ¥è¯†åˆ«é—®é¢˜ï¼Œé€šè¿‡è®¡ç®—è´Ÿæ¢¯åº¦æ¥æ”¹è¿›æ¨¡å‹ï¼Œå®é™…ä¸Šï¼Œè´Ÿæ¢¯åº¦ç»å¯¹å€¼å¤§çš„æ ·ä¾‹åŒæ ·ä¼šåœ¨ä¹‹åçš„è®­ç»ƒä¸­å—åˆ°æ›´å¤§çš„å…³æ³¨ï¼Œå› ä¸ºå®ƒé€ æˆçš„æŸå¤±æ›´å®¹æ˜“åœ¨æœ€åçš„æŸå¤±å‡½æ•°ä¸­å å¾ˆå¤§çš„æ¯”é‡ï¼Œå› æ­¤ï¼Œéœ€è¦æ›´å¤šåœ°åå‘äºå®ƒå»å‡å°æŸå¤±ã€‚è¿™ä¹Ÿæ˜¯ <code>GBDT</code> å’Œ <code>AdaBoost</code> ç›¸ä¼¼çš„ä¸€ä¸ªç‚¹ï¼Œè€Œç›¸æ¯” <code>AdaBoost</code>, <code>Gradient Boosting</code> å¯ä»¥ä½¿ç”¨æ›´å¤šç±»å‹çš„æŸå¤±å‡½æ•°ï¼Œå› æ­¤å¯ä»¥è§£å†³æ›´å¤šçš„é—®é¢˜ã€‚</p></blockquote><h1 id="XGBoost"><a href="#XGBoost" class="headerlink" title="XGBoost"></a>XGBoost</h1><p><code>XGBoost</code>æ˜¯æ¢¯åº¦æå‡æ ‘çš„ä¸€ç§é«˜æ•ˆç³»ç»Ÿå®ç°ï¼Œæ˜¯å¯¹ <code>GBDT</code> è¿›ä¸€æ­¥çš„æ”¹è¿›ï¼ŒåŒ…æ‹¬å¯¹ä»£ä»·å‡½æ•°è¿›è¡Œäº†äºŒé˜¶æ³°å‹’å±•å¼€ï¼Œåœ¨ä»£ä»·å‡½æ•°é‡ŒåŠ å…¥äº†æ­£åˆ™é¡¹ï¼Œå€Ÿé‰´äº†éšæœºæ£®æ—çš„åˆ—é‡‡æ ·æ–¹æ³•ï¼Œæ”¯æŒå¹¶è¡Œè®¡ç®—ç­‰ã€‚</p><ul><li><p>ä¼ ç»Ÿ <code>GBDT</code> åœ¨ä¼˜åŒ–æ—¶åªç”¨åˆ°ä¸€é˜¶å¯¼æ•°ä¿¡æ¯ï¼Œ<code>XGBoost</code> åˆ™å¯¹ä»£ä»·å‡½æ•°è¿›è¡Œäº†äºŒé˜¶æ³°å‹’å±•å¼€ï¼ŒåŒæ—¶ç”¨åˆ°äº†ä¸€é˜¶å’ŒäºŒé˜¶å¯¼æ•°ã€‚æ­¤å¤–ï¼Œ<code>XGBoost</code> å·¥å…·æ”¯æŒè‡ªå®šä¹‰ä»£ä»·å‡½æ•°ï¼Œåªè¦å‡½æ•°å¯ä¸€é˜¶å’ŒäºŒé˜¶æ±‚å¯¼ã€‚</p></li><li><p><code>XGBoost</code>åœ¨ä»£ä»·å‡½æ•°é‡ŒåŠ å…¥äº†æ­£åˆ™é¡¹ï¼Œç”¨äºæ§åˆ¶æ¨¡å‹çš„å¤æ‚åº¦ã€‚æ­£åˆ™é¡¹é‡ŒåŒ…å«äº†æ ‘çš„å¶å­èŠ‚ç‚¹ä¸ªæ•°ã€æ¯ä¸ªå¶å­èŠ‚ç‚¹æƒé‡çš„ $L2$ èŒƒæ•°ã€‚ä» <code>Bias-variance tradeoff</code> è§’åº¦æ¥è®²ï¼Œæ­£åˆ™é¡¹é™ä½äº†æ¨¡å‹çš„ <code>variance</code>ï¼Œä½¿å­¦ä¹ å‡ºæ¥çš„æ¨¡å‹æ›´åŠ ç®€å•ï¼Œé˜²æ­¢è¿‡æ‹Ÿåˆï¼Œè¿™ä¹Ÿæ˜¯ <code>XGBoost</code> ä¼˜äºä¼ ç»Ÿ <code>GBDT</code> çš„ä¸€ä¸ªç‰¹æ€§ã€‚</p></li><li><p><code>Shrinkage</code>ï¼ˆç¼©å‡ï¼‰ï¼Œç›¸å½“äºå­¦ä¹ é€Ÿç‡ï¼ˆ<code>XGBoost</code> ä¸­çš„<code>eta</code>ï¼‰ã€‚<code>XGBoost</code> åœ¨è¿›è¡Œå®Œä¸€æ¬¡è¿­ä»£åï¼Œä¼šå°†å¶å­èŠ‚ç‚¹çš„æƒé‡ä¹˜ä¸Šè¯¥ç³»æ•°ï¼Œä¸»è¦æ˜¯ä¸ºäº†å‰Šå¼±æ¯æ£µæ ‘çš„å½±å“ï¼Œè®©åé¢æœ‰æ›´å¤§çš„å­¦ä¹ ç©ºé—´ã€‚å®é™…åº”ç”¨ä¸­ï¼Œä¸€èˆ¬æŠŠ <code>eta</code> è®¾ç½®å¾—å°ä¸€ç‚¹ï¼Œç„¶åè¿­ä»£æ¬¡æ•°è®¾ç½®å¾—å¤§ä¸€ç‚¹ã€‚</p></li><li><p>åˆ—æŠ½æ ·ï¼Œ<code>XGBoost</code> å€Ÿé‰´äº†éšæœºæ£®æ—çš„åšæ³•ï¼Œæ”¯æŒåˆ—æŠ½æ ·ï¼Œä¸ä»…èƒ½é™ä½è¿‡æ‹Ÿåˆï¼Œè¿˜èƒ½å‡å°‘è®¡ç®—ã€‚</p></li><li><p>å¯¹ç¼ºå¤±å€¼çš„å¤„ç†ã€‚å¯¹äºç‰¹å¾çš„å€¼æœ‰ç¼ºå¤±çš„æ ·æœ¬ï¼Œ<code>XGBoost</code> å¯ä»¥è‡ªåŠ¨å­¦ä¹ å‡ºå®ƒçš„åˆ†è£‚æ–¹å‘ã€‚</p></li><li><p>æ”¯æŒå¹¶è¡Œã€‚<code>XGBoost</code> çš„å¹¶è¡Œä¸æ˜¯æ ‘ç²’åº¦çš„å¹¶è¡Œï¼Œ<code>XGBoost</code> ä¹Ÿæ˜¯ä¸€æ¬¡è¿­ä»£å®Œæ‰èƒ½è¿›è¡Œä¸‹ä¸€æ¬¡è¿­ä»£çš„ã€‚<code>XGBoost</code> çš„å¹¶è¡Œæ˜¯åœ¨ç‰¹å¾ç²’åº¦ä¸Šçš„ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œå†³ç­–æ ‘çš„å­¦ä¹ æœ€è€—æ—¶çš„ä¸€ä¸ªæ­¥éª¤å°±æ˜¯å¯¹ç‰¹å¾çš„å€¼è¿›è¡Œæ’åºï¼ˆå› ä¸ºè¦ç¡®å®šæœ€ä½³åˆ†å‰²ç‚¹ï¼‰ï¼Œ<code>XGBoost</code> åœ¨è®­ç»ƒä¹‹å‰ï¼Œé¢„å…ˆå¯¹æ•°æ®è¿›è¡Œäº†æ’åºï¼Œç„¶åä¿å­˜ä¸º <code>Block</code> ç»“æ„ï¼Œåé¢çš„è¿­ä»£ä¸­é‡å¤åœ°ä½¿ç”¨è¿™ä¸ªç»“æ„ï¼Œå¤§å¤§å‡å°è®¡ç®—é‡ã€‚è¿™ä¸ª <code>Block</code> ç»“æ„ä¹Ÿä½¿å¾—å¹¶è¡Œæˆä¸ºäº†å¯èƒ½ï¼Œåœ¨è¿›è¡ŒèŠ‚ç‚¹çš„åˆ†è£‚æ—¶ï¼Œéœ€è¦è®¡ç®—æ¯ä¸ªç‰¹å¾çš„å¢ç›Šï¼Œæœ€ç»ˆé€‰å¢ç›Šæœ€å¤§çš„é‚£ä¸ªç‰¹å¾å»åšåˆ†è£‚ï¼Œé‚£ä¹ˆå„ä¸ªç‰¹å¾çš„å¢ç›Šè®¡ç®—å°±å¯ä»¥å¼€å¤šçº¿ç¨‹è¿›è¡Œã€‚</p></li><li><p>å¯å¹¶è¡Œçš„è¿‘ä¼¼ç›´æ–¹å›¾ç®—æ³•ã€‚æ ‘èŠ‚ç‚¹åœ¨è¿›è¡Œåˆ†è£‚æ—¶ï¼Œæˆ‘ä»¬éœ€è¦è®¡ç®—æ¯ä¸ªç‰¹å¾çš„æ¯ä¸ªåˆ†å‰²ç‚¹å¯¹åº”çš„å¢ç›Šï¼Œå³ç”¨è´ªå¿ƒæ³•æšä¸¾æ‰€æœ‰å¯èƒ½çš„åˆ†å‰²ç‚¹ã€‚å½“æ•°æ®æ— æ³•ä¸€æ¬¡è½½å…¥å†…å­˜æˆ–è€…åœ¨åˆ†å¸ƒå¼æƒ…å†µä¸‹ï¼Œè´ªå¿ƒç®—æ³•æ•ˆç‡å°±ä¼šå˜å¾—å¾ˆä½ï¼Œæ‰€ä»¥ <code>XGBoost</code> è¿˜æå‡ºäº†ä¸€ç§å¯å¹¶è¡Œçš„è¿‘ä¼¼ç›´æ–¹å›¾ç®—æ³•ï¼Œç”¨äºé«˜æ•ˆåœ°ç”Ÿæˆå€™é€‰çš„åˆ†å‰²ç‚¹ã€‚</p></li></ul><h1 id="LightGBM"><a href="#LightGBM" class="headerlink" title="LightGBM"></a>LightGBM</h1><p><code>LightGBM</code> æ˜¯ä¸€ä¸ªå®ç° <code>GBDT</code> ç®—æ³•çš„åˆ†å¸ƒå¼é«˜æ•ˆæ¡†æ¶ã€‚å®ƒé€šè¿‡ <code>leaf-wise</code> åˆ†è£‚æ–¹æ³•è¿›è¡Œå†³ç­–æ ‘çš„ç”Ÿæˆï¼Œé€šè¿‡åŸºäºç›´æ–¹å›¾çš„ç®—æ³•å¯»æ‰¾ç‰¹å¾åˆ†å‰²ç‚¹ï¼Œå¹¶æ”¯æŒå¹¶è¡Œå­¦ä¹ ï¼Œèƒ½å¤Ÿæ›´é«˜æ•ˆçš„å¤„ç†å¤§æ•°æ®ã€‚</p><p>è¦å‡å°‘è®­ç»ƒçš„å¤æ‚åº¦ï¼Œå¯ä»¥é€šè¿‡å‡å°‘ç‰¹å¾é‡å’Œæ•°æ®é‡æ¥å®ç°ï¼Œå³ä»è¡Œå’Œåˆ—ä¸¤ä¸ªè§’åº¦æ¥å‡å°‘æ•°æ®ï¼ŒåŒæ—¶è¦å°½å¯èƒ½å°‘çš„å½±å“æœ€åçš„ç²¾åº¦ã€‚åœ¨ <code>LightGBM</code> ä¸­ï¼Œå°±æ˜¯è¿™æ ·åšçš„ï¼Œå¯¹åº”ç€ <code>GOSS</code> å’Œ <code>EFB</code>ã€‚</p><ul><li><p><code>Gradient-based One-Side Sampling (GOSS)</code>ï¼š<code>GBDT</code> è™½ç„¶æ²¡æœ‰æ•°æ®æƒé‡ï¼Œä½†æ¯ä¸ªæ•°æ®å®ä¾‹æœ‰ä¸åŒçš„æ¢¯åº¦ï¼Œæ ¹æ®è®¡ç®—ä¿¡æ¯å¢ç›Šçš„å®šä¹‰ï¼Œæ¢¯åº¦å¤§çš„å®ä¾‹å¯¹ä¿¡æ¯å¢ç›Šæœ‰æ›´å¤§çš„å½±å“ï¼Œå› æ­¤åœ¨ä¸‹é‡‡æ ·æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥å°½é‡ä¿ç•™æ¢¯åº¦å¤§çš„æ ·æœ¬ï¼ˆé¢„å…ˆè®¾å®šé˜ˆå€¼ï¼Œæˆ–è€…æœ€é«˜ç™¾åˆ†ä½é—´ï¼‰ï¼Œéšæœºå»æ‰æ¢¯åº¦å°çš„æ ·æœ¬ã€‚æ­¤æªæ–½åœ¨ç›¸åŒçš„é‡‡æ ·ç‡ä¸‹æ¯”éšæœºé‡‡æ ·è·å¾—æ›´å‡†ç¡®çš„ç»“æœï¼Œå°¤å…¶æ˜¯åœ¨ä¿¡æ¯å¢ç›ŠèŒƒå›´è¾ƒå¤§æ—¶ã€‚</p></li><li><p><code>Exclusive Feature Bundling (EFB)</code>ï¼šé€šå¸¸åœ¨çœŸå®åº”ç”¨ä¸­ï¼Œè™½ç„¶ç‰¹å¾é‡æ¯”è¾ƒå¤šï¼Œä½†æ˜¯ç”±äºç‰¹å¾ç©ºé—´ååˆ†ç¨€ç–ï¼Œè®¸å¤šç‰¹å¾å‡ ä¹æ˜¯äº’æ–¥çš„ï¼Œ<code>EFB</code> é€šè¿‡æ†ç»‘äº’æ–¥çš„ç‰¹å¾ï¼Œå¹¶å°†æ†ç»‘é—®é¢˜å½’çº¦åˆ°å›¾ç€è‰²é—®é¢˜ï¼Œé€šè¿‡è´ªå¿ƒç®—æ³•æ±‚å¾—è¿‘ä¼¼è§£ï¼Œä»¥å‡å°‘ç‰¹å¾æ•°é‡ã€‚</p></li><li><p>å¯¹äºæ ‘çš„åˆ†è£‚æ–¹æ³•ï¼Œå®ƒé€šè¿‡ <code>leaf-wise</code> åˆ†è£‚äº§ç”Ÿæ¯” <code>level-wise</code> åˆ†è£‚æ›´å¤æ‚çš„æ ‘ï¼Œèƒ½å¤Ÿå®ç°æ›´é«˜çš„å‡†ç¡®ç‡ã€‚è™½ç„¶è¿™æ ·æœ‰æ—¶å€™ä¼šå¯¼è‡´è¿‡æ‹Ÿåˆï¼Œä½†å¯ä»¥é€šè¿‡è®¾ç½® <code>max-depth</code> å‚æ•°æ¥é˜²æ­¢è¿‡æ‹Ÿåˆçš„å‘ç”Ÿã€‚ï¼ˆæ¯ä¸€æ¬¡çš„ç”Ÿé•¿éƒ½æ˜¯é€‰å–åˆ†è£‚å¢ç›Šæœ€é«˜çš„èŠ‚ç‚¹ï¼Œè€Œä¸æ˜¯å¯¹ä¸€å±‚ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹éƒ½è¿›è¡Œåˆ†è£‚ï¼‰ã€‚</p></li><li><p>å…¶æ¬¡ï¼Œå®ƒä½¿ç”¨åŸºäºç›´æ–¹å›¾çš„ç®—æ³•ï¼Œå°†è¿ç»­çš„ç‰¹å¾å€¼åˆ†æ¡¶è£…è¿›ç¦»æ•£çš„ç®±å­(<code>Bins</code>)ï¼Œå¹¶é€šè¿‡ç›´æ–¹å›¾åšå·®åŠ é€Ÿè®¡ç®—å…„å¼ŸèŠ‚ç‚¹çš„ç›´æ–¹å›¾ï¼Œèƒ½å¤ŸåŠ é€Ÿè®­ç»ƒè¿‡ç¨‹ï¼Œå¹¶å®ç°æ›´å°‘çš„å†…å­˜å ç”¨ã€‚</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> æœºå™¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> éšæœºæ£®æ— </tag>
            
            <tag> GBDT </tag>
            
            <tag> XGBoost </tag>
            
            <tag> LightGBM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é›†æˆå­¦ä¹ ã€ä¸€ã€‘</title>
      <link href="/2021/07/20/ensemble1/"/>
      <url>/2021/07/20/ensemble1/</url>
      
        <content type="html"><![CDATA[<h1 id="é›†æˆå­¦ä¹ "><a href="#é›†æˆå­¦ä¹ " class="headerlink" title="é›†æˆå­¦ä¹ "></a>é›†æˆå­¦ä¹ </h1><ul><li><p>é›†æˆå­¦ä¹  <code>(ensemble learning)</code> æ˜¯é€šè¿‡æ„å»ºåŠç»“åˆå¤šä¸ªå­¦ä¹ å™¨æ¥å®Œæˆå­¦ä¹ ä»»åŠ¡çš„ï¼Œå…¶ä¸€èˆ¬ç»“æ„ä¸ºï¼š</p><ul><li><p>å…ˆäº§ç”Ÿä¸€ç»„ä¸ªä½“å­¦ä¹ å™¨ <code>(individual learner)</code>ã€‚ä¸ªä½“å­¦ä¹ å™¨é€šå¸¸ç”±ä¸€ç§æˆ–å¤šç§ç°æœ‰çš„å­¦ä¹ ç®—æ³•ä»è®­ç»ƒæ•°æ®ä¸­äº§ç”Ÿ</p></li><li><p>ç„¶åä½¿ç”¨æŸç§ <code>strategy</code> å°†ä¸ªä½“å­¦ä¹ å™¨ç»“åˆèµ·æ¥ã€‚é€šå¸¸å¯ä»¥è·å¾—æ¯”å•ä¸€å­¦ä¹ å™¨æ˜¾è‘—ä¼˜è¶Šçš„æ³›åŒ–æ€§èƒ½</p></li></ul></li><li><p>é€‰å–åŸºå­¦ä¹ å™¨çš„å‡†åˆ™ï¼šå¥½è€Œä¸åŒ</p><ul><li><p>ä¸ªä½“å­¦ä¹ å™¨è¦å…·å¤‡ä¸€å®šçš„å‡†ç¡®æ€§ï¼Œé¢„æµ‹èƒ½åŠ›ä¸èƒ½å¤ªå·®</p></li><li><p>ä¸ªä½“å­¦ä¹ å™¨ä¹‹é—´è¦æœ‰å·®å¼‚</p></li></ul></li><li><p>ä¸€ä¸ªç®€å•çš„ç†è®ºåˆ†æï¼š</p><p>è€ƒè™‘ä¸€ä¸ªäºŒåˆ†ç±»é—®é¢˜ $y\in -1, +1$ï¼ŒçœŸå®å‡½æ•° $f(x)$ åŠå¥‡æ•° $M$ ä¸ªç›¸äº’ç‹¬ç«‹çš„çŠ¯é”™æ¦‚ç‡ä¸º $\epsilon$ çš„ä¸ªä½“å­¦ä¹ å™¨ $h_i(x)$ï¼Œæˆ‘ä»¬ä½¿ç”¨ç®€å•çš„æŠ•ç¥¨ <code>(voting)</code> è§„åˆ™è¿›è¡Œå†³ç­–ï¼š</p><script type="math/tex; mode=display">H(x)=sign(\sum_{i=1}^{M}h_i(x))</script><p>ç”± $Hoeffding$ ä¸ç­‰å¼å¯çŸ¥ï¼Œé›†æˆå­¦ä¹ çš„çŠ¯é”™æ¦‚ç‡æ»¡è¶³ï¼š</p><script type="math/tex; mode=display">P(H(x) \not = f(x))= \sum_{k=1}^{(M+1)/2}C_{M}^{k}(1-\epsilon)^k\epsilon^{M-k} \le exp{(-\frac{1}{2}M(1-2\epsilon)^2)}</script><p>å½“åŸºå­¦ä¹ å™¨çš„ä¸ªæ•° $M$ å¾ˆå¤§çš„æ—¶å€™ï¼Œé›†æˆå­¦ä¹ çš„çŠ¯é”™æ¦‚ç‡å°†æ¥è¿‘äº $0$ã€‚è¿™ä¹Ÿå¾ˆç¬¦åˆäººä»¬çš„ç›´è§‰ï¼šå¤§å¤šæ•°äººåŒæ—¶çŠ¯é”™çš„æ¦‚ç‡å°†å¾ˆä½ã€‚</p></li><li><p>æ ¹æ®åŸºå­¦ä¹ å™¨çš„ç”Ÿæˆæ–¹å¼ï¼Œç›®å‰çš„é›†æˆå­¦ä¹ æ–¹æ³•å¤§æ¦‚åˆ†æˆä¸¤ç±»ï¼š</p><ul><li>ä¸ªä½“å­¦ä¹ å™¨ä¹‹é—´å­˜åœ¨å¼ºä¾èµ–å…³ç³»ï¼Œå¿…é¡»ä¸²è¡Œç”Ÿæˆçš„åºåˆ—åŒ–æ–¹æ³•ï¼Œæ¯ä¸€è½®è¿­ä»£ç”Ÿæˆä¸€ä¸ªä¸ªä½“å­¦ä¹ å™¨ï¼Œå…¶ä¸­ä»¥ <code>Boosting</code> ä¸ºä»£è¡¨</li><li>ä¸ªä½“å­¦ä¹ å™¨ä¹‹é—´ä¸å­˜åœ¨å¼ºä¾èµ–å…³ç³»ï¼Œ å¯ä»¥åŒæ—¶ç”Ÿæˆçš„å¹¶è¡ŒåŒ–æ–¹æ³•ï¼Œå…¶ä¸­ä»¥ <code>Bagging</code> å’Œ <code>Random Forest</code> ä¸ºä»£è¡¨</li></ul></li></ul><p><img src="https://easy-ai.oss-cn-shanghai.aliyuncs.com/2020-02-13-weizhi.png" alt=""></p><blockquote><p>é›†æˆå­¦ä¹ å½’å±äºæœºå™¨å­¦ä¹ ï¼Œä»–æ˜¯ä¸€ç§ <strong>è®­ç»ƒæ€è·¯</strong>ï¼Œå¹¶ä¸æ˜¯æŸç§å…·ä½“çš„æ–¹æ³•æˆ–è€…ç®—æ³•ã€‚</p></blockquote><h1 id="Boosting"><a href="#Boosting" class="headerlink" title="Boosting"></a>Boosting</h1><p><code>Boosting</code> çš„ä¸»è¦æ€æƒ³æ˜¯å°†å¼±çš„åŸºå­¦ä¹ å™¨æå‡ä¸ºå¼ºå­¦ä¹ å™¨ï¼Œåœ¨åˆ†ç±»é—®é¢˜ä¸­ï¼Œå®ƒé€šè¿‡æ”¹å˜è®­ç»ƒæ ·æœ¬çš„æƒé‡å­¦ä¹ å¤šä¸ªåˆ†ç±»å™¨ï¼Œå¹¶å°†è¿™äº›åˆ†ç±»å™¨ä»¬è¿›è¡Œçº¿æ€§ç»„åˆæ¥æé«˜åˆ†ç±»çš„èƒ½åŠ›ã€‚å…¶ä¸»è¦æ­¥éª¤ä¸ºï¼š</p><ul><li><p>å…ˆç”¨æ ·æœ¬æƒé‡ç›¸ç­‰çš„è®­ç»ƒé›†å­¦ä¹ ä¸€ä¸ªåˆå§‹çš„åŸºå­¦ä¹ å™¨</p></li><li><p>æ ¹æ®ä¸Šä¸€è½®å¾—åˆ°çš„å­¦ä¹ å™¨åœ¨è®­ç»ƒé›†ä¸Šçš„è¡¨ç°æƒ…å†µè°ƒæ•´æ ·æœ¬æƒé‡ï¼ˆ<strong>æé«˜è¢«ä¸Šä¸€è½®å­¦ä¹ å™¨åˆ†ç±»é”™è¯¯çš„æ ·æœ¬çš„æƒé‡ï¼Œä½¿ä¹‹å†ä¸‹ä¸€è½®è®­ç»ƒä¸­å¾—åˆ°æ›´å¤šå…³æ³¨</strong>ï¼‰ï¼Œç„¶åæ®æ­¤å­¦ä¹ ä¸€ä¸ªæ–°çš„åŸºå­¦ä¹ å™¨</p></li><li><p>é‡å¤ç¬¬äºŒæ­¥ç›´åˆ°å¾—åˆ°$M$ä¸ªå­¦ä¹ å™¨ï¼Œæœ€åçš„é›†æˆå­¦ä¹ å™¨ä¸º$M$ä¸ªå­¦ä¹ å™¨çš„ç»„åˆ</p></li></ul><p><img src="https://easy-ai.oss-cn-shanghai.aliyuncs.com/2019-10-17-boosting.png" alt=""></p><h1 id="Bagging"><a href="#Bagging" class="headerlink" title="Bagging"></a>Bagging</h1><p><code>Bagging</code> ç›´æ¥åŸºäºè‡ªä¸»é‡‡æ · <code>Boostrap Sampling</code>ã€‚è‡ªä¸»é‡‡æ ·çš„ä¸€èˆ¬æ­¥éª¤ä¸ºï¼š</p><ul><li><p>å…ˆéšæœºå–å‡ºä¸€ä¸ªæ ·æœ¬æ”¾å…¥é‡‡æ ·é›†ä¸­ï¼Œå†æŠŠè¯¥æ ·æœ¬æ”¾å›åŸå§‹æ•°æ®é›†ã€‚</p></li><li><p>è¿™æ ·ç»è¿‡$N$æ¬¡éšæœºé‡‡æ ·æ“ä½œï¼Œå¾—åˆ°åŒ…å«$N$ä¸ªæ ·æœ¬çš„é‡‡æ ·é›†ã€‚</p></li></ul><blockquote><p>åˆå§‹è®­ç»ƒé›†ä¸­æœ‰çš„æ ·æœ¬åœ¨é‡‡æ ·é›†ä¸­å¤šæ¬¡å‡ºç°ï¼Œæœ‰çš„åˆ™ä»æœªå‡ºç°ã€‚åˆå§‹è®­ç»ƒé›†ä¸­çº¦æœ‰ $63.2\%$ çš„æ ·æœ¬å‡ºç°åœ¨äº†é‡‡æ ·é›†ä¸­ã€‚å› æ­¤å‰©ä¸‹çš„çº¦ $36.8\%$ çš„æ ·æœ¬å¯ç”¨ä½œéªŒè¯é›†æ¥å¯¹æ³›åŒ–æ€§èƒ½è¿›è¡ŒåŒ…å¤–ä¼°è®¡ã€‚</p></blockquote><p><code>Bagging</code>æ–¹æ³•çš„ä¸»è¦æ­¥éª¤ä¸ºï¼š</p><ul><li><p>ç»è¿‡ $M$ è½®è‡ªåŠ©é‡‡æ ·ï¼Œå¯ä»¥å¾—åˆ° $M$ ä¸ªåŒ…å« $N$ ä¸ªè®­ç»ƒæ ·æœ¬çš„é‡‡æ ·é›†ã€‚</p></li><li><p>ç„¶ååŸºäºæ¯ä¸ªé‡‡æ ·é›†è®­ç»ƒå‡ºä¸€ä¸ªåŸºå­¦ä¹ å™¨ã€‚</p></li><li><p>æœ€åå°†è¿™$M$ä¸ªåŸºå­¦ä¹ å™¨è¿›è¡Œç»„åˆï¼Œå¾—åˆ°é›†æˆæ¨¡å‹ã€‚</p></li></ul><p><img src="https://easy-ai.oss-cn-shanghai.aliyuncs.com/2019-10-17-bagging.png" alt=""></p><h1 id="åå·®-æ–¹å·®åˆ†è§£"><a href="#åå·®-æ–¹å·®åˆ†è§£" class="headerlink" title="åå·®-æ–¹å·®åˆ†è§£"></a>åå·®-æ–¹å·®åˆ†è§£</h1><blockquote><script type="math/tex; mode=display">Error = bias + var_f + var_{\epsilon}</script><p>å³æ³›åŒ–è¯¯å·®å¯ä»¥åˆ†è§£ä¸ºåå·®ã€æ–¹å·®å’Œå™ªå£°ä¹‹å’Œï¼š</p><p><strong>åå·®</strong>ï¼šåº¦é‡äº†å­¦ä¹ ç®—æ³•çš„æœŸæœ›é¢„æµ‹ä¸çœŸå®ç»“æœä¹‹é—´çš„åç¦»ç¨‹åº¦ï¼Œåˆ»ç”»äº†<strong>å­¦ä¹ ç®—æ³•æœ¬èº«çš„æ‹Ÿåˆèƒ½åŠ›</strong>ã€‚</p><p><strong>æ–¹å·®</strong>ï¼šåº¦é‡äº†è®­ç»ƒé›†çš„å˜åŠ¨æ‰€å¯¼è‡´çš„å­¦ä¹ æ€§èƒ½çš„å˜åŒ–ï¼Œåˆ»ç”»äº†<strong>æ•°æ®æ‰°åŠ¨é€ æˆçš„å½±å“</strong>ã€‚</p><p><strong>å™ªå£°</strong>ï¼šåº¦é‡äº†åœ¨å½“å‰ä»»åŠ¡ä¸Šä»»ä½•å­¦ä¹ ç®—æ³•æ‰€èƒ½è¾¾åˆ°çš„æœŸæœ›æ³›åŒ–è¯¯å·®çš„ä¸‹ç•Œï¼Œåˆ»ç”»äº†<strong>å­¦ä¹ é—®é¢˜æœ¬èº«çš„éš¾åº¦</strong>ã€‚</p><p><strong>åå·®-æ–¹å·®åˆ†è§£è¡¨æ˜ï¼šæ³›åŒ–æ€§èƒ½æ˜¯ç”±å­¦ä¹ ç®—æ³•çš„èƒ½åŠ›ã€æ•°æ®çš„å……åˆ†æ€§ä»¥åŠå­¦ä¹ ä»»åŠ¡æœ¬èº«çš„éš¾åº¦å…±åŒå†³å®šçš„ã€‚</strong></p></blockquote><p>åœ¨ <code>Bagging</code> å’Œ <code>Boosting</code> æ¡†æ¶ä¸­ï¼Œé€šè¿‡è®¡ç®—åŸºæ¨¡å‹çš„æœŸæœ›å’Œæ–¹å·®æˆ‘ä»¬å¯ä»¥å¾—åˆ°æ¨¡å‹æ•´ä½“çš„æœŸæœ›å’Œæ–¹å·®ã€‚ä¸ºäº†ç®€åŒ–æ¨¡å‹ï¼Œæˆ‘ä»¬å‡è®¾åŸºæ¨¡å‹çš„æœŸæœ›ä¸º $\mu$ ï¼Œæ–¹å·® $\sigma^2$ ï¼Œæ¨¡å‹çš„æƒé‡ä¸º $r$ï¼Œä¸¤ä¸¤æ¨¡å‹é—´çš„ç›¸å…³ç³»æ•° $\rho$ ç›¸ç­‰ã€‚ç”±äº <code>Bagging</code> å’Œ <code>Boosting</code> çš„åŸºæ¨¡å‹éƒ½æ˜¯çº¿æ€§ç»„æˆçš„ï¼Œé‚£ä¹ˆæœ‰ï¼š</p><script type="math/tex; mode=display">F=\sum_{i}^m r_if_i</script><script type="math/tex; mode=display">E(F) = \sum_{i}^m r_iE(f_i)</script><script type="math/tex; mode=display">var(F) = var(\sum_{i}^m r_if_i)</script><blockquote><p>å¯¹äº <code>Bagging</code> æ¥è¯´ï¼Œæ¯ä¸ªåŸºæ¨¡å‹çš„æƒé‡ç­‰äº $1/m$ ä¸”æœŸæœ›è¿‘ä¼¼ç›¸ç­‰ã€‚</p><ul><li><p>æ•´ä½“æ¨¡å‹çš„æœŸæœ›ç­‰äºåŸºæ¨¡å‹çš„æœŸæœ›ï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€æ•´ä½“æ¨¡å‹çš„åå·®å’ŒåŸºæ¨¡å‹çš„åå·®è¿‘ä¼¼ã€‚</p></li><li><p>æ•´ä½“æ¨¡å‹çš„æ–¹å·®å°äºç­‰äºåŸºæ¨¡å‹çš„æ–¹å·®ï¼Œéšç€åŸºæ¨¡å‹æ•°é‡å¢å¤šï¼Œæ•´ä½“æ¨¡å‹çš„æ–¹å·®å‡å°‘ï¼Œä»è€Œé˜²æ­¢è¿‡æ‹Ÿåˆçš„èƒ½åŠ›å¢å¼ºï¼Œæ¨¡å‹çš„å‡†ç¡®åº¦å¾—åˆ°æé«˜ã€‚</p></li><li><p>å› æ­¤ <code>Bagging</code> ä¸­çš„åŸºæ¨¡å‹ä¸€å®šè¦ä¸ºå¼ºæ¨¡å‹ã€‚</p></li></ul><p>å¯¹äº <code>Boosting</code> æ¥è¯´ï¼Œç”±äºåŸºæ¨¡å‹å…±ç”¨åŒä¸€å¥—è®­ç»ƒé›†ï¼Œæ‰€ä»¥åŸºæ¨¡å‹é—´å…·æœ‰å¼ºç›¸å…³æ€§ï¼Œå› æ­¤æ•´ä½“æ¨¡å‹çš„æ–¹å·®è¿‘ä¼¼ç­‰äºåŸºæ¨¡å‹çš„æ–¹å·®ã€‚</p></blockquote><ul><li><p><code>Bagging</code> ä¸»è¦å…³æ³¨é™ä½æ–¹å·®ï¼Œå®ƒèƒ½å¹³æ»‘å¼ºå­¦ä¹ å™¨çš„æ–¹å·®ã€‚å› æ­¤å®ƒåœ¨éå‰ªæå†³ç­–æ ‘ã€ç¥ç»ç½‘ç»œç­‰å®¹æ˜“å—åˆ°æ ·æœ¬æ‰°åŠ¨çš„å­¦ä¹ å™¨ä¸Šæ•ˆæœæ›´ä¸ºæ˜æ˜¾ã€‚</p></li><li><p><code>Boosting</code> ä¸»è¦å…³æ³¨é™ä½åå·®ï¼Œå®ƒèƒ½å°†ä¸€äº›å¼±å­¦ä¹ å™¨æå‡ä¸ºå¼ºå­¦ä¹ å™¨ã€‚å› æ­¤å®ƒåœ¨ <code>SVM</code>ã€<code>KNN</code> ç­‰ä¸å®¹æ˜“å—åˆ°æ ·æœ¬æ‰°åŠ¨çš„å­¦ä¹ å™¨ä¸Šæ•ˆæœæ›´ä¸ºæ˜æ˜¾ã€‚</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> æœºå™¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é›†æˆå­¦ä¹  </tag>
            
            <tag> bagging </tag>
            
            <tag> boosting </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
